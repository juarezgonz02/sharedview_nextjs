exports.id=117,exports.ids=[117],exports.modules={41231:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"}},77715:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M682 455V311l-76 76v68c-.1 50.7-42 92.1-94 92a95.8 95.8 0 01-52-15l-54 55c29.1 22.4 65.9 36 106 36 93.8 0 170-75.1 170-168z"}},{tag:"path",attrs:{d:"M833 446h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254-63 0-120.7-23-165-61l-54 54a334.01 334.01 0 00179 81v102H326c-13.9 0-24.9 14.3-25 32v36c.1 4.4 2.9 8 6 8h408c3.2 0 6-3.6 6-8v-36c0-17.7-11-32-25-32H547V782c165.3-17.9 294-157.9 294-328 0-4.4-3.6-8-8-8zm13.1-377.7l-43.5-41.9a8 8 0 00-11.2.1l-129 129C634.3 101.2 577 64 511 64c-93.9 0-170 75.3-170 168v224c0 6.7.4 13.3 1.2 19.8l-68 68A252.33 252.33 0 01258 454c-.2-4.4-3.8-8-8-8h-60c-4.4 0-8 3.6-8 8 0 53 12.5 103 34.6 147.4l-137 137a8.03 8.03 0 000 11.3l42.7 42.7c3.1 3.1 8.2 3.1 11.3 0L846.2 79.8l.1-.1c3.1-3.2 3-8.3-.2-11.4zM417 401V232c0-50.6 41.9-92 94-92 46 0 84.1 32.3 92.3 74.7L417 401z"}}]},name:"audio-muted",theme:"outlined"}},45697:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1zM512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168zm-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92V232z"}}]},name:"audio",theme:"outlined"}},37973:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"}},637:(t,r,n)=>{"use strict";Object.defineProperty(r,"Z",{enumerable:!0,get:function(){return l}});var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(9885)),a=_interop_require_default(n(41231)),c=_interop_require_default(n(35155));function _interop_require_default(t){return t&&t.__esModule?t:{default:t}}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}var l=o.forwardRef(function(t,r){var n,l;return o.createElement(c.default,(n=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(r){var o;o=n[r],r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o})}return t}({},t),l=l={ref:r,icon:a.default},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):(function(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n.push.apply(n,o)}return n})(Object(l)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(l,t))}),n))})},87087:(t,r,n)=>{"use strict";Object.defineProperty(r,"Z",{enumerable:!0,get:function(){return l}});var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(9885)),a=_interop_require_default(n(77715)),c=_interop_require_default(n(35155));function _interop_require_default(t){return t&&t.__esModule?t:{default:t}}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}var l=o.forwardRef(function(t,r){var n,l;return o.createElement(c.default,(n=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(r){var o;o=n[r],r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o})}return t}({},t),l=l={ref:r,icon:a.default},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):(function(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n.push.apply(n,o)}return n})(Object(l)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(l,t))}),n))})},95333:(t,r,n)=>{"use strict";Object.defineProperty(r,"Z",{enumerable:!0,get:function(){return l}});var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(9885)),a=_interop_require_default(n(45697)),c=_interop_require_default(n(35155));function _interop_require_default(t){return t&&t.__esModule?t:{default:t}}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}var l=o.forwardRef(function(t,r){var n,l;return o.createElement(c.default,(n=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(r){var o;o=n[r],r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o})}return t}({},t),l=l={ref:r,icon:a.default},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):(function(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n.push.apply(n,o)}return n})(Object(l)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(l,t))}),n))})},77238:(t,r,n)=>{"use strict";Object.defineProperty(r,"Z",{enumerable:!0,get:function(){return l}});var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(9885)),a=_interop_require_default(n(37973)),c=_interop_require_default(n(35155));function _interop_require_default(t){return t&&t.__esModule?t:{default:t}}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}var l=o.forwardRef(function(t,r){var n,l;return o.createElement(c.default,(n=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(r){var o;o=n[r],r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o})}return t}({},t),l=l={ref:r,icon:a.default},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):(function(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n.push.apply(n,o)}return n})(Object(l)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(l,t))}),n))})},19853:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CachedKeyDecoder=void 0;let o=n(60196);r.CachedKeyDecoder=class{constructor(t=16,r=16){this.maxKeyLength=t,this.maxLengthPerKey=r,this.hit=0,this.miss=0,this.caches=[];for(let t=0;t<this.maxKeyLength;t++)this.caches.push([])}canBeCached(t){return t>0&&t<=this.maxKeyLength}find(t,r,n){let o=this.caches[n-1];e:for(let a of o){let o=a.bytes;for(let a=0;a<n;a++)if(o[a]!==t[r+a])continue e;return a.str}return null}store(t,r){let n=this.caches[t.length-1],o={bytes:t,str:r};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=o:n.push(o)}decode(t,r,n){let a=this.find(t,r,n);if(null!=a)return this.hit++,a;this.miss++;let c=(0,o.utf8DecodeJs)(t,r,n),l=Uint8Array.prototype.slice.call(t,r,r+n);return this.store(l,c),c}}},95851:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DecodeError=void 0;let DecodeError=class DecodeError extends Error{constructor(t){super(t);let r=Object.create(DecodeError.prototype);Object.setPrototypeOf(this,r),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:DecodeError.name})}};r.DecodeError=DecodeError},90842:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Decoder=r.DataViewIndexOutOfBoundsError=void 0;let o=n(39095),a=n(63670),c=n(40381),l=n(60196),d=n(81316),f=n(19853),m=n(95851),isValidMapKeyType=t=>{let r=typeof t;return"string"===r||"number"===r},_=new DataView(new ArrayBuffer(0)),g=new Uint8Array(_.buffer);r.DataViewIndexOutOfBoundsError=(()=>{try{_.getInt8(0)}catch(t){return t.constructor}throw Error("never reached")})();let y=new r.DataViewIndexOutOfBoundsError("Insufficient data"),b=new f.CachedKeyDecoder;r.Decoder=class{constructor(t=a.ExtensionCodec.defaultCodec,r,n=c.UINT32_MAX,o=c.UINT32_MAX,l=c.UINT32_MAX,d=c.UINT32_MAX,f=c.UINT32_MAX,m=b){this.extensionCodec=t,this.context=r,this.maxStrLength=n,this.maxBinLength=o,this.maxArrayLength=l,this.maxMapLength=d,this.maxExtLength=f,this.keyDecoder=m,this.totalPos=0,this.pos=0,this.view=_,this.bytes=g,this.headByte=-1,this.stack=[]}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.length=0}setBuffer(t){this.bytes=(0,d.ensureUint8Array)(t),this.view=(0,d.createDataView)(this.bytes),this.pos=0}appendBuffer(t){if(-1!==this.headByte||this.hasRemaining(1)){let r=this.bytes.subarray(this.pos),n=(0,d.ensureUint8Array)(t),o=new Uint8Array(r.length+n.length);o.set(r),o.set(n,r.length),this.setBuffer(o)}else this.setBuffer(t)}hasRemaining(t){return this.view.byteLength-this.pos>=t}createExtraByteError(t){let{view:r,pos:n}=this;return RangeError(`Extra ${r.byteLength-n} of ${r.byteLength} byte(s) found at buffer[${t}]`)}decode(t){this.reinitializeState(),this.setBuffer(t);let r=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return r}*decodeMulti(t){for(this.reinitializeState(),this.setBuffer(t);this.hasRemaining(1);)yield this.doDecodeSync()}async decodeAsync(t){let n,a=!1;for await(let o of t){if(a)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o);try{n=this.doDecodeSync(),a=!0}catch(t){if(!(t instanceof r.DataViewIndexOutOfBoundsError))throw t}this.totalPos+=this.pos}if(a){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return n}let{headByte:c,pos:l,totalPos:d}=this;throw RangeError(`Insufficient data in parsing ${(0,o.prettyByte)(c)} at ${d} (${l} in the current buffer)`)}decodeArrayStream(t){return this.decodeMultiAsync(t,!0)}decodeStream(t){return this.decodeMultiAsync(t,!1)}async *decodeMultiAsync(t,n){let o=n,a=-1;for await(let c of t){if(n&&0===a)throw this.createExtraByteError(this.totalPos);this.appendBuffer(c),o&&(a=this.readArraySize(),o=!1,this.complete());try{for(;yield this.doDecodeSync(),0!=--a;);}catch(t){if(!(t instanceof r.DataViewIndexOutOfBoundsError))throw t}this.totalPos+=this.pos}}doDecodeSync(){t:for(;;){let t;let r=this.readHeadByte();if(r>=224)t=r-256;else if(r<192){if(r<128)t=r;else if(r<144){let n=r-128;if(0!==n){this.pushMapState(n),this.complete();continue}t={}}else if(r<160){let n=r-144;if(0!==n){this.pushArrayState(n),this.complete();continue}t=[]}else{let n=r-160;t=this.decodeUtf8String(n,0)}}else if(192===r)t=null;else if(194===r)t=!1;else if(195===r)t=!0;else if(202===r)t=this.readF32();else if(203===r)t=this.readF64();else if(204===r)t=this.readU8();else if(205===r)t=this.readU16();else if(206===r)t=this.readU32();else if(207===r)t=this.readU64();else if(208===r)t=this.readI8();else if(209===r)t=this.readI16();else if(210===r)t=this.readI32();else if(211===r)t=this.readI64();else if(217===r){let r=this.lookU8();t=this.decodeUtf8String(r,1)}else if(218===r){let r=this.lookU16();t=this.decodeUtf8String(r,2)}else if(219===r){let r=this.lookU32();t=this.decodeUtf8String(r,4)}else if(220===r){let r=this.readU16();if(0!==r){this.pushArrayState(r),this.complete();continue}t=[]}else if(221===r){let r=this.readU32();if(0!==r){this.pushArrayState(r),this.complete();continue}t=[]}else if(222===r){let r=this.readU16();if(0!==r){this.pushMapState(r),this.complete();continue}t={}}else if(223===r){let r=this.readU32();if(0!==r){this.pushMapState(r),this.complete();continue}t={}}else if(196===r){let r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===r){let r=this.lookU16();t=this.decodeBinary(r,2)}else if(198===r){let r=this.lookU32();t=this.decodeBinary(r,4)}else if(212===r)t=this.decodeExtension(1,0);else if(213===r)t=this.decodeExtension(2,0);else if(214===r)t=this.decodeExtension(4,0);else if(215===r)t=this.decodeExtension(8,0);else if(216===r)t=this.decodeExtension(16,0);else if(199===r){let r=this.lookU8();t=this.decodeExtension(r,1)}else if(200===r){let r=this.lookU16();t=this.decodeExtension(r,2)}else if(201===r){let r=this.lookU32();t=this.decodeExtension(r,4)}else throw new m.DecodeError(`Unrecognized type byte: ${(0,o.prettyByte)(r)}`);this.complete();let n=this.stack;for(;n.length>0;){let r=n[n.length-1];if(0===r.type){if(r.array[r.position]=t,r.position++,r.position===r.size)n.pop(),t=r.array;else continue t}else if(1===r.type){if(!isValidMapKeyType(t))throw new m.DecodeError("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new m.DecodeError("The key __proto__ is not allowed");r.key=t,r.type=2;continue t}else if(r.map[r.key]=t,r.readCount++,r.readCount===r.size)n.pop(),t=r.map;else{r.key=null,r.type=1;continue t}}return t}}readHeadByte(){return -1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){let t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:if(t<160)return t-144;throw new m.DecodeError(`Unrecognized array type byte: ${(0,o.prettyByte)(t)}`)}}pushMapState(t){if(t>this.maxMapLength)throw new m.DecodeError(`Max length exceeded: map length (${t}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.push({type:1,size:t,key:null,readCount:0,map:{}})}pushArrayState(t){if(t>this.maxArrayLength)throw new m.DecodeError(`Max length exceeded: array length (${t}) > maxArrayLength (${this.maxArrayLength})`);this.stack.push({type:0,size:t,array:Array(t),position:0})}decodeUtf8String(t,r){var n;let o;if(t>this.maxStrLength)throw new m.DecodeError(`Max length exceeded: UTF-8 byte length (${t}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+r+t)throw y;let a=this.pos+r;return o=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(t))?this.keyDecoder.decode(this.bytes,a,t):t>l.TEXT_DECODER_THRESHOLD?(0,l.utf8DecodeTD)(this.bytes,a,t):(0,l.utf8DecodeJs)(this.bytes,a,t),this.pos+=r+t,o}stateIsMapKey(){if(this.stack.length>0){let t=this.stack[this.stack.length-1];return 1===t.type}return!1}decodeBinary(t,r){if(t>this.maxBinLength)throw new m.DecodeError(`Max length exceeded: bin length (${t}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(t+r))throw y;let n=this.pos+r,o=this.bytes.subarray(n,n+t);return this.pos+=r+t,o}decodeExtension(t,r){if(t>this.maxExtLength)throw new m.DecodeError(`Max length exceeded: ext length (${t}) > maxExtLength (${this.maxExtLength})`);let n=this.view.getInt8(this.pos+r),o=this.decodeBinary(t,r+1);return this.extensionCodec.decode(o,n,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let t=this.view.getUint8(this.pos);return this.pos++,t}readI8(){let t=this.view.getInt8(this.pos);return this.pos++,t}readU16(){let t=this.view.getUint16(this.pos);return this.pos+=2,t}readI16(){let t=this.view.getInt16(this.pos);return this.pos+=2,t}readU32(){let t=this.view.getUint32(this.pos);return this.pos+=4,t}readI32(){let t=this.view.getInt32(this.pos);return this.pos+=4,t}readU64(){let t=(0,c.getUint64)(this.view,this.pos);return this.pos+=8,t}readI64(){let t=(0,c.getInt64)(this.view,this.pos);return this.pos+=8,t}readF32(){let t=this.view.getFloat32(this.pos);return this.pos+=4,t}readF64(){let t=this.view.getFloat64(this.pos);return this.pos+=8,t}}},70837:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Encoder=r.DEFAULT_INITIAL_BUFFER_SIZE=r.DEFAULT_MAX_DEPTH=void 0;let o=n(60196),a=n(63670),c=n(40381),l=n(81316);r.DEFAULT_MAX_DEPTH=100,r.DEFAULT_INITIAL_BUFFER_SIZE=2048,r.Encoder=class{constructor(t=a.ExtensionCodec.defaultCodec,n,o=r.DEFAULT_MAX_DEPTH,c=r.DEFAULT_INITIAL_BUFFER_SIZE,l=!1,d=!1,f=!1,m=!1){this.extensionCodec=t,this.context=n,this.maxDepth=o,this.initialBufferSize=c,this.sortKeys=l,this.forceFloat32=d,this.ignoreUndefined=f,this.forceIntegerToFloat=m,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}reinitializeState(){this.pos=0}encodeSharedRef(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)}encode(t){return this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)}doEncode(t,r){if(r>this.maxDepth)throw Error(`Too deep objects in depth ${r}`);null==t?this.encodeNil():"boolean"==typeof t?this.encodeBoolean(t):"number"==typeof t?this.encodeNumber(t):"string"==typeof t?this.encodeString(t):this.encodeObject(t,r)}ensureBufferSizeToWrite(t){let r=this.pos+t;this.view.byteLength<r&&this.resizeBuffer(2*r)}resizeBuffer(t){let r=new ArrayBuffer(t),n=new Uint8Array(r),o=new DataView(r);n.set(this.bytes),this.view=o,this.bytes=n}encodeNil(){this.writeU8(192)}encodeBoolean(t){!1===t?this.writeU8(194):this.writeU8(195)}encodeNumber(t){Number.isSafeInteger(t)&&!this.forceIntegerToFloat?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):(this.writeU8(211),this.writeI64(t)):this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))}writeStringHeader(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else if(t<4294967296)this.writeU8(219),this.writeU32(t);else throw Error(`Too long string: ${t} bytes in UTF-8`)}encodeString(t){let r=t.length;if(r>o.TEXT_ENCODER_THRESHOLD){let r=(0,o.utf8Count)(t);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),(0,o.utf8EncodeTE)(t,this.bytes,this.pos),this.pos+=r}else{let r=(0,o.utf8Count)(t);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),(0,o.utf8EncodeJs)(t,this.bytes,this.pos),this.pos+=r}}encodeObject(t,r){let n=this.extensionCodec.tryToEncode(t,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(t))this.encodeArray(t,r);else if(ArrayBuffer.isView(t))this.encodeBinary(t);else if("object"==typeof t)this.encodeMap(t,r);else throw Error(`Unrecognized object: ${Object.prototype.toString.apply(t)}`)}encodeBinary(t){let r=t.byteLength;if(r<256)this.writeU8(196),this.writeU8(r);else if(r<65536)this.writeU8(197),this.writeU16(r);else if(r<4294967296)this.writeU8(198),this.writeU32(r);else throw Error(`Too large binary: ${r}`);let n=(0,l.ensureUint8Array)(t);this.writeU8a(n)}encodeArray(t,r){let n=t.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else if(n<4294967296)this.writeU8(221),this.writeU32(n);else throw Error(`Too large array: ${n}`);for(let n of t)this.doEncode(n,r+1)}countWithoutUndefined(t,r){let n=0;for(let o of r)void 0!==t[o]&&n++;return n}encodeMap(t,r){let n=Object.keys(t);this.sortKeys&&n.sort();let o=this.ignoreUndefined?this.countWithoutUndefined(t,n):n.length;if(o<16)this.writeU8(128+o);else if(o<65536)this.writeU8(222),this.writeU16(o);else if(o<4294967296)this.writeU8(223),this.writeU32(o);else throw Error(`Too large map object: ${o}`);for(let o of n){let n=t[o];this.ignoreUndefined&&void 0===n||(this.encodeString(o),this.doEncode(n,r+1))}}encodeExtension(t){let r=t.data.length;if(1===r)this.writeU8(212);else if(2===r)this.writeU8(213);else if(4===r)this.writeU8(214);else if(8===r)this.writeU8(215);else if(16===r)this.writeU8(216);else if(r<256)this.writeU8(199),this.writeU8(r);else if(r<65536)this.writeU8(200),this.writeU16(r);else if(r<4294967296)this.writeU8(201),this.writeU32(r);else throw Error(`Too large extension object: ${r}`);this.writeI8(t.type),this.writeU8a(t.data)}writeU8(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++}writeU8a(t){let r=t.length;this.ensureBufferSizeToWrite(r),this.bytes.set(t,this.pos),this.pos+=r}writeI8(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++}writeU16(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2}writeI16(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2}writeU32(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4}writeI32(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4}writeF32(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4}writeF64(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8}writeU64(t){this.ensureBufferSizeToWrite(8),(0,c.setUint64)(this.view,this.pos,t),this.pos+=8}writeI64(t){this.ensureBufferSizeToWrite(8),(0,c.setInt64)(this.view,this.pos,t),this.pos+=8}}},76021:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExtData=void 0,r.ExtData=class{constructor(t,r){this.type=t,this.data=r}}},63670:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ExtensionCodec=void 0;let o=n(76021),a=n(67017);let ExtensionCodec=class ExtensionCodec{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(a.timestampExtension)}register({type:t,encode:r,decode:n}){if(t>=0)this.encoders[t]=r,this.decoders[t]=n;else{let o=1+t;this.builtInEncoders[o]=r,this.builtInDecoders[o]=n}}tryToEncode(t,r){for(let n=0;n<this.builtInEncoders.length;n++){let a=this.builtInEncoders[n];if(null!=a){let c=a(t,r);if(null!=c){let t=-1-n;return new o.ExtData(t,c)}}}for(let n=0;n<this.encoders.length;n++){let a=this.encoders[n];if(null!=a){let c=a(t,r);if(null!=c){let t=n;return new o.ExtData(t,c)}}}return t instanceof o.ExtData?t:null}decode(t,r,n){let a=r<0?this.builtInDecoders[-1-r]:this.decoders[r];return a?a(t,r,n):new o.ExtData(r,t)}};r.ExtensionCodec=ExtensionCodec,ExtensionCodec.defaultCodec=new ExtensionCodec},87062:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeMulti=r.decode=r.defaultDecodeOptions=void 0;let o=n(90842);r.defaultDecodeOptions={},r.decode=function(t,n=r.defaultDecodeOptions){let a=new o.Decoder(n.extensionCodec,n.context,n.maxStrLength,n.maxBinLength,n.maxArrayLength,n.maxMapLength,n.maxExtLength);return a.decode(t)},r.decodeMulti=function(t,n=r.defaultDecodeOptions){let a=new o.Decoder(n.extensionCodec,n.context,n.maxStrLength,n.maxBinLength,n.maxArrayLength,n.maxMapLength,n.maxExtLength);return a.decodeMulti(t)}},67991:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeStream=r.decodeMultiStream=r.decodeArrayStream=r.decodeAsync=void 0;let o=n(90842),a=n(43103),c=n(87062);async function decodeAsync(t,r=c.defaultDecodeOptions){let n=(0,a.ensureAsyncIterable)(t),l=new o.Decoder(r.extensionCodec,r.context,r.maxStrLength,r.maxBinLength,r.maxArrayLength,r.maxMapLength,r.maxExtLength);return l.decodeAsync(n)}function decodeMultiStream(t,r=c.defaultDecodeOptions){let n=(0,a.ensureAsyncIterable)(t),l=new o.Decoder(r.extensionCodec,r.context,r.maxStrLength,r.maxBinLength,r.maxArrayLength,r.maxMapLength,r.maxExtLength);return l.decodeStream(n)}r.decodeAsync=decodeAsync,r.decodeArrayStream=function(t,r=c.defaultDecodeOptions){let n=(0,a.ensureAsyncIterable)(t),l=new o.Decoder(r.extensionCodec,r.context,r.maxStrLength,r.maxBinLength,r.maxArrayLength,r.maxMapLength,r.maxExtLength);return l.decodeArrayStream(n)},r.decodeMultiStream=decodeMultiStream,r.decodeStream=function(t,r=c.defaultDecodeOptions){return decodeMultiStream(t,r)}},14558:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.encode=void 0;let o=n(70837),a={};r.encode=function(t,r=a){let n=new o.Encoder(r.extensionCodec,r.context,r.maxDepth,r.initialBufferSize,r.sortKeys,r.forceFloat32,r.ignoreUndefined,r.forceIntegerToFloat);return n.encodeSharedRef(t)}},2493:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTimestampExtension=r.encodeTimestampExtension=r.decodeTimestampToTimeSpec=r.encodeTimeSpecToTimestamp=r.encodeDateToTimeSpec=r.EXT_TIMESTAMP=r.ExtData=r.ExtensionCodec=r.Encoder=r.DataViewIndexOutOfBoundsError=r.DecodeError=r.Decoder=r.decodeStream=r.decodeMultiStream=r.decodeArrayStream=r.decodeAsync=r.decodeMulti=r.decode=r.encode=void 0;let o=n(14558);Object.defineProperty(r,"encode",{enumerable:!0,get:function(){return o.encode}});let a=n(87062);Object.defineProperty(r,"decode",{enumerable:!0,get:function(){return a.decode}}),Object.defineProperty(r,"decodeMulti",{enumerable:!0,get:function(){return a.decodeMulti}});let c=n(67991);Object.defineProperty(r,"decodeAsync",{enumerable:!0,get:function(){return c.decodeAsync}}),Object.defineProperty(r,"decodeArrayStream",{enumerable:!0,get:function(){return c.decodeArrayStream}}),Object.defineProperty(r,"decodeMultiStream",{enumerable:!0,get:function(){return c.decodeMultiStream}}),Object.defineProperty(r,"decodeStream",{enumerable:!0,get:function(){return c.decodeStream}});let l=n(90842);Object.defineProperty(r,"Decoder",{enumerable:!0,get:function(){return l.Decoder}}),Object.defineProperty(r,"DataViewIndexOutOfBoundsError",{enumerable:!0,get:function(){return l.DataViewIndexOutOfBoundsError}});let d=n(95851);Object.defineProperty(r,"DecodeError",{enumerable:!0,get:function(){return d.DecodeError}});let f=n(70837);Object.defineProperty(r,"Encoder",{enumerable:!0,get:function(){return f.Encoder}});let m=n(63670);Object.defineProperty(r,"ExtensionCodec",{enumerable:!0,get:function(){return m.ExtensionCodec}});let _=n(76021);Object.defineProperty(r,"ExtData",{enumerable:!0,get:function(){return _.ExtData}});let g=n(67017);Object.defineProperty(r,"EXT_TIMESTAMP",{enumerable:!0,get:function(){return g.EXT_TIMESTAMP}}),Object.defineProperty(r,"encodeDateToTimeSpec",{enumerable:!0,get:function(){return g.encodeDateToTimeSpec}}),Object.defineProperty(r,"encodeTimeSpecToTimestamp",{enumerable:!0,get:function(){return g.encodeTimeSpecToTimestamp}}),Object.defineProperty(r,"decodeTimestampToTimeSpec",{enumerable:!0,get:function(){return g.decodeTimestampToTimeSpec}}),Object.defineProperty(r,"encodeTimestampExtension",{enumerable:!0,get:function(){return g.encodeTimestampExtension}}),Object.defineProperty(r,"decodeTimestampExtension",{enumerable:!0,get:function(){return g.decodeTimestampExtension}})},67017:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.timestampExtension=r.decodeTimestampExtension=r.decodeTimestampToTimeSpec=r.encodeTimestampExtension=r.encodeDateToTimeSpec=r.encodeTimeSpecToTimestamp=r.EXT_TIMESTAMP=void 0;let o=n(95851),a=n(40381);function encodeTimeSpecToTimestamp({sec:t,nsec:r}){if(t>=0&&r>=0&&t<=17179869183){if(0===r&&t<=4294967295){let r=new Uint8Array(4),n=new DataView(r.buffer);return n.setUint32(0,t),r}{let n=t/4294967296,o=4294967295&t,a=new Uint8Array(8),c=new DataView(a.buffer);return c.setUint32(0,r<<2|3&n),c.setUint32(4,o),a}}{let n=new Uint8Array(12),o=new DataView(n.buffer);return o.setUint32(0,r),(0,a.setInt64)(o,4,t),n}}function encodeDateToTimeSpec(t){let r=t.getTime(),n=Math.floor(r/1e3),o=(r-1e3*n)*1e6,a=Math.floor(o/1e9);return{sec:n+a,nsec:o-1e9*a}}function encodeTimestampExtension(t){if(!(t instanceof Date))return null;{let r=encodeDateToTimeSpec(t);return encodeTimeSpecToTimestamp(r)}}function decodeTimestampToTimeSpec(t){let r=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:{let t=r.getUint32(0);return{sec:t,nsec:0}}case 8:{let t=r.getUint32(0),n=r.getUint32(4);return{sec:(3&t)*4294967296+n,nsec:t>>>2}}case 12:{let t=(0,a.getInt64)(r,4),n=r.getUint32(0);return{sec:t,nsec:n}}default:throw new o.DecodeError(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function decodeTimestampExtension(t){let r=decodeTimestampToTimeSpec(t);return new Date(1e3*r.sec+r.nsec/1e6)}r.EXT_TIMESTAMP=-1,r.encodeTimeSpecToTimestamp=encodeTimeSpecToTimestamp,r.encodeDateToTimeSpec=encodeDateToTimeSpec,r.encodeTimestampExtension=encodeTimestampExtension,r.decodeTimestampToTimeSpec=decodeTimestampToTimeSpec,r.decodeTimestampExtension=decodeTimestampExtension,r.timestampExtension={type:r.EXT_TIMESTAMP,encode:encodeTimestampExtension,decode:decodeTimestampExtension}},40381:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getUint64=r.getInt64=r.setInt64=r.setUint64=r.UINT32_MAX=void 0,r.UINT32_MAX=4294967295,r.setUint64=function(t,r,n){let o=n/4294967296;t.setUint32(r,o),t.setUint32(r+4,n)},r.setInt64=function(t,r,n){let o=Math.floor(n/4294967296);t.setUint32(r,o),t.setUint32(r+4,n)},r.getInt64=function(t,r){let n=t.getInt32(r),o=t.getUint32(r+4);return 4294967296*n+o},r.getUint64=function(t,r){let n=t.getUint32(r),o=t.getUint32(r+4);return 4294967296*n+o}},39095:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.prettyByte=void 0,r.prettyByte=function(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}},43103:(t,r)=>{"use strict";function isAsyncIterable(t){return null!=t[Symbol.asyncIterator]}async function*asyncIterableFromStream(t){let r=t.getReader();try{for(;;){let{done:t,value:n}=await r.read();if(t)return;(function(t){if(null==t)throw Error("Assertion Failure: value must not be null nor undefined")})(n),yield n}}finally{r.releaseLock()}}Object.defineProperty(r,"__esModule",{value:!0}),r.ensureAsyncIterable=r.asyncIterableFromStream=r.isAsyncIterable=void 0,r.isAsyncIterable=isAsyncIterable,r.asyncIterableFromStream=asyncIterableFromStream,r.ensureAsyncIterable=function(t){return isAsyncIterable(t)?t:asyncIterableFromStream(t)}},81316:(t,r)=>{"use strict";function ensureUint8Array(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Uint8Array.from(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.createDataView=r.ensureUint8Array=void 0,r.ensureUint8Array=ensureUint8Array,r.createDataView=function(t){if(t instanceof ArrayBuffer)return new DataView(t);let r=ensureUint8Array(t);return new DataView(r.buffer,r.byteOffset,r.byteLength)}},60196:(t,r,n)=>{"use strict";var o,a,c;Object.defineProperty(r,"__esModule",{value:!0}),r.utf8DecodeTD=r.TEXT_DECODER_THRESHOLD=r.utf8DecodeJs=r.utf8EncodeTE=r.TEXT_ENCODER_THRESHOLD=r.utf8EncodeJs=r.utf8Count=void 0;let l=n(40381),d=("undefined"==typeof process||(null===(o=null==process?void 0:process.env)||void 0===o?void 0:o.TEXT_ENCODING)!=="never")&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;r.utf8Count=function(t){let r=t.length,n=0,o=0;for(;o<r;){let a=t.charCodeAt(o++);if((4294967168&a)==0){n++;continue}if((4294965248&a)==0)n+=2;else{if(a>=55296&&a<=56319&&o<r){let r=t.charCodeAt(o);(64512&r)==56320&&(++o,a=((1023&a)<<10)+(1023&r)+65536)}(4294901760&a)==0?n+=3:n+=4}}return n},r.utf8EncodeJs=function(t,r,n){let o=t.length,a=n,c=0;for(;c<o;){let n=t.charCodeAt(c++);if((4294967168&n)==0){r[a++]=n;continue}if((4294965248&n)==0)r[a++]=n>>6&31|192;else{if(n>=55296&&n<=56319&&c<o){let r=t.charCodeAt(c);(64512&r)==56320&&(++c,n=((1023&n)<<10)+(1023&r)+65536)}(4294901760&n)==0?r[a++]=n>>12&15|224:(r[a++]=n>>18&7|240,r[a++]=n>>12&63|128),r[a++]=n>>6&63|128}r[a++]=63&n|128}};let f=d?new TextEncoder:void 0;r.TEXT_ENCODER_THRESHOLD=d?"undefined"!=typeof process&&(null===(a=null==process?void 0:process.env)||void 0===a?void 0:a.TEXT_ENCODING)!=="force"?200:0:l.UINT32_MAX,r.utf8EncodeTE=(null==f?void 0:f.encodeInto)?function(t,r,n){f.encodeInto(t,r.subarray(n))}:function(t,r,n){r.set(f.encode(t),n)},r.utf8DecodeJs=function(t,r,n){let o=r,a=o+n,c=[],l="";for(;o<a;){let r=t[o++];if((128&r)==0)c.push(r);else if((224&r)==192){let n=63&t[o++];c.push((31&r)<<6|n)}else if((240&r)==224){let n=63&t[o++],a=63&t[o++];c.push((31&r)<<12|n<<6|a)}else if((248&r)==240){let n=63&t[o++],a=63&t[o++],l=63&t[o++],d=(7&r)<<18|n<<12|a<<6|l;d>65535&&(d-=65536,c.push(d>>>10&1023|55296),d=56320|1023&d),c.push(d)}else c.push(r);c.length>=4096&&(l+=String.fromCharCode(...c),c.length=0)}return c.length>0&&(l+=String.fromCharCode(...c)),l};let m=d?new TextDecoder:null;r.TEXT_DECODER_THRESHOLD=d?"undefined"!=typeof process&&(null===(c=null==process?void 0:process.env)||void 0===c?void 0:c.TEXT_DECODER)!=="force"?200:0:l.UINT32_MAX,r.utf8DecodeTD=function(t,r,n){let o=t.subarray(r,r+n);return m.decode(o)}},36735:(t,r)=>{function Emitter(t){if(t)return function(t){for(var r in Emitter.prototype)t[r]=Emitter.prototype[r];return t}(t)}r.Q=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(t,r){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(r),this},Emitter.prototype.once=function(t,r){function on(){this.off(t,on),r.apply(this,arguments)}return on.fn=r,this.on(t,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(t,r){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,o=this._callbacks["$"+t];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var a=0;a<o.length;a++)if((n=o[a])===r||n.fn===r){o.splice(a,1);break}return 0===o.length&&delete this._callbacks["$"+t],this},Emitter.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var r=Array(arguments.length-1),n=this._callbacks["$"+t],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(n){n=n.slice(0);for(var o=0,a=n.length;o<a;++o)n[o].apply(this,r)}return this},Emitter.prototype.emitReserved=Emitter.prototype.emit,Emitter.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},Emitter.prototype.hasListeners=function(t){return!!this.listeners(t).length}},53327:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){if("string"!=typeof t)return t;let r=t.charAt(0).toUpperCase()+t.slice(1);return r}},98935:(t,r,n)=>{"use strict";var o=n(92439).default,a=n(35876).default;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=a(n(9885)),l=o(n(89367)),d=n(34791),f=o(n(5963)),__rest=function(t,r){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&0>r.indexOf(o)&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,o=Object.getOwnPropertySymbols(t);a<o.length;a++)0>r.indexOf(o[a])&&Object.prototype.propertyIsEnumerable.call(t,o[a])&&(n[o[a]]=t[o[a]]);return n};let m=c.forwardRef((t,r)=>{let{prefixCls:n,style:o,className:a,checked:m,onChange:_,onClick:g}=t,y=__rest(t,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:b,tag:S}=c.useContext(d.ConfigContext),E=b("tag",n),[w,T]=(0,f.default)(E),O=(0,l.default)(E,`${E}-checkable`,{[`${E}-checkable-checked`]:m},null==S?void 0:S.className,a,T);return w(c.createElement("span",Object.assign({},y,{ref:r,style:Object.assign(Object.assign({},o),null==S?void 0:S.style),className:O,onClick:t=>{null==_||_(!m),null==g||g(t)}})))});r.default=m},18180:(t,r,n)=>{"use strict";var o=n(92439).default,a=n(35876).default;r.Z=void 0;var c=a(n(9885)),l=o(n(42773)),d=o(n(89367)),f=n(70592),m=o(n(43775));n(4474);var _=o(n(3094)),g=n(34791),y=o(n(98935)),b=o(n(5963)),S=o(n(84694)),E=o(n(17668)),__rest=function(t,r){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&0>r.indexOf(o)&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,o=Object.getOwnPropertySymbols(t);a<o.length;a++)0>r.indexOf(o[a])&&Object.prototype.propertyIsEnumerable.call(t,o[a])&&(n[o[a]]=t[o[a]]);return n};let w=c.forwardRef((t,r)=>{let{prefixCls:n,className:o,rootClassName:a,style:y,children:w,icon:T,color:O,onClose:R,closeIcon:x,closable:P,bordered:A=!0}=t,M=__rest(t,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:D,direction:I,tag:j}=c.useContext(g.ConfigContext),[B,U]=c.useState(!0);c.useEffect(()=>{"visible"in M&&U(M.visible)},[M.visible]);let N=(0,f.isPresetColor)(O),F=(0,f.isPresetStatusColor)(O),$=N||F,V=Object.assign(Object.assign({backgroundColor:O&&!$?O:void 0},null==j?void 0:j.style),y),W=D("tag",n),[z,G]=(0,b.default)(W),q=(0,d.default)(W,null==j?void 0:j.className,{[`${W}-${O}`]:$,[`${W}-has-color`]:O&&!$,[`${W}-hidden`]:!B,[`${W}-rtl`]:"rtl"===I,[`${W}-borderless`]:!A},o,a,G),handleCloseClick=t=>{t.stopPropagation(),null==R||R(t),t.defaultPrevented||U(!1)},[,H]=(0,m.default)(P,x,t=>null===t?c.createElement(l.default,{className:`${W}-close-icon`,onClick:handleCloseClick}):c.createElement("span",{className:`${W}-close-icon`,onClick:handleCloseClick},t),null,!1),K="function"==typeof M.onClick||w&&"a"===w.type,J=T||null,X=J?c.createElement(c.Fragment,null,J,w&&c.createElement("span",null,w)):w,Y=c.createElement("span",Object.assign({},M,{ref:r,className:q,style:V}),X,H,N&&c.createElement(S.default,{key:"preset",prefixCls:W}),F&&c.createElement(E.default,{key:"status",prefixCls:W}));return z(K?c.createElement(_.default,{component:"Tag"},Y):Y)});w.CheckableTag=y.default,r.Z=w},5963:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.prepareToken=r.prepareCommonToken=r.default=void 0;var o=n(82760),a=n(37952);let genBaseStyle=t=>{let{paddingXXS:r,lineWidth:n,tagPaddingHorizontal:a,componentCls:c}=t,l=a-n;return{[c]:Object.assign(Object.assign({},(0,o.resetComponent)(t)),{display:"inline-block",height:"auto",marginInlineEnd:t.marginXS,paddingInline:l,fontSize:t.tagFontSize,lineHeight:t.tagLineHeight,whiteSpace:"nowrap",background:t.defaultBg,border:`${t.lineWidth}px ${t.lineType} ${t.colorBorder}`,borderRadius:t.borderRadiusSM,opacity:1,transition:`all ${t.motionDurationMid}`,textAlign:"start",position:"relative",[`&${c}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:t.defaultColor},[`${c}-close-icon`]:{marginInlineStart:r-n,color:t.colorTextDescription,fontSize:t.tagIconSize,cursor:"pointer",transition:`all ${t.motionDurationMid}`,"&:hover":{color:t.colorTextHeading}},[`&${c}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${t.iconCls}-close, ${t.iconCls}-close:hover`]:{color:t.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${c}-checkable-checked):hover`]:{color:t.colorPrimary,backgroundColor:t.colorFillSecondary},"&:active, &-checked":{color:t.colorTextLightSolid},"&-checked":{backgroundColor:t.colorPrimary,"&:hover":{backgroundColor:t.colorPrimaryHover}},"&:active":{backgroundColor:t.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${t.iconCls} + span, > span + ${t.iconCls}`]:{marginInlineStart:l}}),[`${c}-borderless`]:{borderColor:"transparent",background:t.tagBorderlessBg}}},prepareToken=t=>{let{lineWidth:r,fontSizeIcon:n}=t,o=t.fontSizeSM,c=`${t.lineHeightSM*o}px`,l=(0,a.mergeToken)(t,{tagFontSize:o,tagLineHeight:c,tagIconSize:n-2*r,tagPaddingHorizontal:8,tagBorderlessBg:t.colorFillTertiary});return l};r.prepareToken=prepareToken;let prepareCommonToken=t=>({defaultBg:t.colorFillQuaternary,defaultColor:t.colorText});r.prepareCommonToken=prepareCommonToken,r.default=(0,a.genComponentStyleHook)("Tag",t=>{let r=prepareToken(t);return genBaseStyle(r)},prepareCommonToken)},84694:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=n(5963),a=n(37952);let genPresetStyle=t=>(0,a.genPresetColor)(t,(r,n)=>{let{textColor:o,lightBorderColor:a,lightColor:c,darkColor:l}=n;return{[`${t.componentCls}-${r}`]:{color:o,background:c,borderColor:a,"&-inverse":{color:t.colorTextLightSolid,background:l,borderColor:l},[`&${t.componentCls}-borderless`]:{borderColor:"transparent"}}}});r.default=(0,a.genSubStyleComponent)(["Tag","preset"],t=>{let r=(0,o.prepareToken)(t);return genPresetStyle(r)},o.prepareCommonToken)},17668:(t,r,n)=>{"use strict";var o=n(92439).default;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(5963),c=o(n(53327)),l=n(37952);let genTagStatusStyle=(t,r,n)=>{let o=(0,c.default)(n);return{[`${t.componentCls}-${r}`]:{color:t[`color${n}`],background:t[`color${o}Bg`],borderColor:t[`color${o}Border`],[`&${t.componentCls}-borderless`]:{borderColor:"transparent"}}}};r.default=(0,l.genSubStyleComponent)(["Tag","status"],t=>{let r=(0,a.prepareToken)(t);return[genTagStatusStyle(r,"success","Success"),genTagStatusStyle(r,"processing","Info"),genTagStatusStyle(r,"error","Error"),genTagStatusStyle(r,"warning","Warning")]},a.prepareCommonToken)},29108:(t,r,n)=>{t.exports=n(9929)(__dirname)},52327:(t,r,n)=>{r.formatArgs=function(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let n="color: "+this.color;r.splice(1,0,n,"color: inherit");let o=0,a=0;r[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(o++,"%c"===t&&(a=o))}),r.splice(a,0,n)},r.save=function(t){try{t?r.storage.setItem("debug",t):r.storage.removeItem("debug")}catch(t){}},r.load=function(){let t;try{t=r.storage.getItem("debug")}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t},r.useColors=function(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch(t){}}(),r.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),t.exports=n(60392)(r);let{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},60392:(t,r,n)=>{t.exports=function(t){function createDebug(t){let r,n,o;let a=null;function debug(...t){if(!debug.enabled)return;let n=Number(new Date),o=n-(r||n);debug.diff=o,debug.prev=r,debug.curr=n,r=n,t[0]=createDebug.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";a++;let o=createDebug.formatters[n];if("function"==typeof o){let n=t[a];r=o.call(debug,n),t.splice(a,1),a--}return r}),createDebug.formatArgs.call(debug,t);let c=debug.log||createDebug.log;c.apply(debug,t)}return debug.namespace=t,debug.useColors=createDebug.useColors(),debug.color=createDebug.selectColor(t),debug.extend=extend,debug.destroy=createDebug.destroy,Object.defineProperty(debug,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(n!==createDebug.namespaces&&(n=createDebug.namespaces,o=createDebug.enabled(t)),o),set:t=>{a=t}}),"function"==typeof createDebug.init&&createDebug.init(debug),debug}function extend(t,r){let n=createDebug(this.namespace+(void 0===r?":":r)+t);return n.log=this.log,n}function toNamespace(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return createDebug.debug=createDebug,createDebug.default=createDebug,createDebug.coerce=function(t){return t instanceof Error?t.stack||t.message:t},createDebug.disable=function(){let t=[...createDebug.names.map(toNamespace),...createDebug.skips.map(toNamespace).map(t=>"-"+t)].join(",");return createDebug.enable(""),t},createDebug.enable=function(t){let r;createDebug.save(t),createDebug.namespaces=t,createDebug.names=[],createDebug.skips=[];let n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?createDebug.skips.push(RegExp("^"+t.slice(1)+"$")):createDebug.names.push(RegExp("^"+t+"$")))},createDebug.enabled=function(t){let r,n;if("*"===t[t.length-1])return!0;for(r=0,n=createDebug.skips.length;r<n;r++)if(createDebug.skips[r].test(t))return!1;for(r=0,n=createDebug.names.length;r<n;r++)if(createDebug.names[r].test(t))return!0;return!1},createDebug.humanize=n(69842),createDebug.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{createDebug[r]=t[r]}),createDebug.names=[],createDebug.skips=[],createDebug.formatters={},createDebug.selectColor=function(t){let r=0;for(let n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return createDebug.colors[Math.abs(r)%createDebug.colors.length]},createDebug.enable(createDebug.load()),createDebug}},17783:(t,r,n)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?t.exports=n(52327):t.exports=n(49035)},49035:(t,r,n)=>{let o=n(76224),a=n(73837);r.init=function(t){t.inspectOpts={};let n=Object.keys(r.inspectOpts);for(let o=0;o<n.length;o++)t.inspectOpts[n[o]]=r.inspectOpts[n[o]]},r.log=function(...t){return process.stderr.write(a.format(...t)+"\n")},r.formatArgs=function(n){let{namespace:o,useColors:a}=this;if(a){let r=this.color,a="\x1b[3"+(r<8?r:"8;5;"+r),c=`  ${a};1m${o} \u001B[0m`;n[0]=c+n[0].split("\n").join("\n"+c),n.push(a+"m+"+t.exports.humanize(this.diff)+"\x1b[0m")}else n[0]=(r.inspectOpts.hideDate?"":new Date().toISOString()+" ")+o+" "+n[0]},r.save=function(t){t?process.env.DEBUG=t:delete process.env.DEBUG},r.load=function(){return process.env.DEBUG},r.useColors=function(){return"colors"in r.inspectOpts?!!r.inspectOpts.colors:o.isatty(process.stderr.fd)},r.destroy=a.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),r.colors=[6,2,3,4,5,1];try{let t=n(35048);t&&(t.stderr||t).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(t){}r.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,r)=>{let n=r.substring(6).toLowerCase().replace(/_([a-z])/g,(t,r)=>r.toUpperCase()),o=process.env[r];return o=!!/^(yes|on|true|enabled)$/i.test(o)||!/^(no|off|false|disabled)$/i.test(o)&&("null"===o?null:Number(o)),t[n]=o,t},{}),t.exports=n(60392)(r);let{formatters:c}=t.exports;c.o=function(t){return this.inspectOpts.colors=this.useColors,a.inspect(t,this.inspectOpts).split("\n").map(t=>t.trim()).join(" ")},c.O=function(t){return this.inspectOpts.colors=this.useColors,a.inspect(t,this.inspectOpts)}},84326:(t,r,n)=>{"use strict";let{EMPTY_BUFFER:o}=n(58578);function _mask(t,r,n,o,a){for(let c=0;c<a;c++)n[o+c]=t[c]^r[3&c]}function _unmask(t,r){for(let n=0;n<t.length;n++)t[n]^=r[3&n]}function toBuffer(t){let r;return(toBuffer.readOnly=!0,Buffer.isBuffer(t))?t:(t instanceof ArrayBuffer?r=Buffer.from(t):ArrayBuffer.isView(t)?r=Buffer.from(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),toBuffer.readOnly=!1),r)}if(t.exports={concat:function(t,r){if(0===t.length)return o;if(1===t.length)return t[0];let n=Buffer.allocUnsafe(r),a=0;for(let r=0;r<t.length;r++){let o=t[r];n.set(o,a),a+=o.length}return a<r?n.slice(0,a):n},mask:_mask,toArrayBuffer:function(t){return t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)},toBuffer,unmask:_unmask},!process.env.WS_NO_BUFFER_UTIL)try{let r=n(Object(function(){var t=Error("Cannot find module 'bufferutil'");throw t.code="MODULE_NOT_FOUND",t}()));t.exports.mask=function(t,n,o,a,c){c<48?_mask(t,n,o,a,c):r.mask(t,n,o,a,c)},t.exports.unmask=function(t,n){t.length<32?_unmask(t,n):r.unmask(t,n)}}catch(t){}},58578:t=>{"use strict";t.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},67033:(t,r,n)=>{"use strict";let{kForOnEventAttribute:o,kListener:a}=n(58578),c=Symbol("kCode"),l=Symbol("kData"),d=Symbol("kError"),f=Symbol("kMessage"),m=Symbol("kReason"),_=Symbol("kTarget"),g=Symbol("kType"),y=Symbol("kWasClean");let Event=class Event{constructor(t){this[_]=null,this[g]=t}get target(){return this[_]}get type(){return this[g]}};Object.defineProperty(Event.prototype,"target",{enumerable:!0}),Object.defineProperty(Event.prototype,"type",{enumerable:!0});let CloseEvent=class CloseEvent extends Event{constructor(t,r={}){super(t),this[c]=void 0===r.code?0:r.code,this[m]=void 0===r.reason?"":r.reason,this[y]=void 0!==r.wasClean&&r.wasClean}get code(){return this[c]}get reason(){return this[m]}get wasClean(){return this[y]}};Object.defineProperty(CloseEvent.prototype,"code",{enumerable:!0}),Object.defineProperty(CloseEvent.prototype,"reason",{enumerable:!0}),Object.defineProperty(CloseEvent.prototype,"wasClean",{enumerable:!0});let ErrorEvent=class ErrorEvent extends Event{constructor(t,r={}){super(t),this[d]=void 0===r.error?null:r.error,this[f]=void 0===r.message?"":r.message}get error(){return this[d]}get message(){return this[f]}};Object.defineProperty(ErrorEvent.prototype,"error",{enumerable:!0}),Object.defineProperty(ErrorEvent.prototype,"message",{enumerable:!0});let MessageEvent=class MessageEvent extends Event{constructor(t,r={}){super(t),this[l]=void 0===r.data?null:r.data}get data(){return this[l]}};function callListener(t,r,n){"object"==typeof t&&t.handleEvent?t.handleEvent.call(t,n):t.call(r,n)}Object.defineProperty(MessageEvent.prototype,"data",{enumerable:!0}),t.exports={CloseEvent,ErrorEvent,Event,EventTarget:{addEventListener(t,r,n={}){let c;for(let c of this.listeners(t))if(!n[o]&&c[a]===r&&!c[o])return;if("message"===t)c=function(t,n){let o=new MessageEvent("message",{data:n?t:t.toString()});o[_]=this,callListener(r,this,o)};else if("close"===t)c=function(t,n){let o=new CloseEvent("close",{code:t,reason:n.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});o[_]=this,callListener(r,this,o)};else if("error"===t)c=function(t){let n=new ErrorEvent("error",{error:t,message:t.message});n[_]=this,callListener(r,this,n)};else{if("open"!==t)return;c=function(){let t=new Event("open");t[_]=this,callListener(r,this,t)}}c[o]=!!n[o],c[a]=r,n.once?this.once(t,c):this.on(t,c)},removeEventListener(t,r){for(let n of this.listeners(t))if(n[a]===r&&!n[o]){this.removeListener(t,n);break}}},MessageEvent}},53399:(t,r,n)=>{"use strict";let{tokenChars:o}=n(23402);function push(t,r,n){void 0===t[r]?t[r]=[n]:t[r].push(n)}t.exports={format:function(t){return Object.keys(t).map(r=>{let n=t[r];return Array.isArray(n)||(n=[n]),n.map(t=>[r].concat(Object.keys(t).map(r=>{let n=t[r];return Array.isArray(n)||(n=[n]),n.map(t=>!0===t?r:`${r}=${t}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(t){let r,n;let a=Object.create(null),c=Object.create(null),l=!1,d=!1,f=!1,m=-1,_=-1,g=-1,y=0;for(;y<t.length;y++)if(_=t.charCodeAt(y),void 0===r){if(-1===g&&1===o[_])-1===m&&(m=y);else if(0!==y&&(32===_||9===_))-1===g&&-1!==m&&(g=y);else if(59===_||44===_){if(-1===m)throw SyntaxError(`Unexpected character at index ${y}`);-1===g&&(g=y);let n=t.slice(m,g);44===_?(push(a,n,c),c=Object.create(null)):r=n,m=g=-1}else throw SyntaxError(`Unexpected character at index ${y}`)}else if(void 0===n){if(-1===g&&1===o[_])-1===m&&(m=y);else if(32===_||9===_)-1===g&&-1!==m&&(g=y);else if(59===_||44===_){if(-1===m)throw SyntaxError(`Unexpected character at index ${y}`);-1===g&&(g=y),push(c,t.slice(m,g),!0),44===_&&(push(a,r,c),c=Object.create(null),r=void 0),m=g=-1}else if(61===_&&-1!==m&&-1===g)n=t.slice(m,y),m=g=-1;else throw SyntaxError(`Unexpected character at index ${y}`)}else if(d){if(1!==o[_])throw SyntaxError(`Unexpected character at index ${y}`);-1===m?m=y:l||(l=!0),d=!1}else if(f){if(1===o[_])-1===m&&(m=y);else if(34===_&&-1!==m)f=!1,g=y;else if(92===_)d=!0;else throw SyntaxError(`Unexpected character at index ${y}`)}else if(34===_&&61===t.charCodeAt(y-1))f=!0;else if(-1===g&&1===o[_])-1===m&&(m=y);else if(-1!==m&&(32===_||9===_))-1===g&&(g=y);else if(59===_||44===_){if(-1===m)throw SyntaxError(`Unexpected character at index ${y}`);-1===g&&(g=y);let o=t.slice(m,g);l&&(o=o.replace(/\\/g,""),l=!1),push(c,n,o),44===_&&(push(a,r,c),c=Object.create(null),r=void 0),n=void 0,m=g=-1}else throw SyntaxError(`Unexpected character at index ${y}`);if(-1===m||f||32===_||9===_)throw SyntaxError("Unexpected end of input");-1===g&&(g=y);let b=t.slice(m,g);return void 0===r?push(a,b,c):(void 0===n?push(c,b,!0):l?push(c,n,b.replace(/\\/g,"")):push(c,n,b),push(a,r,c)),a}}},4155:t=>{"use strict";let r=Symbol("kDone"),n=Symbol("kRun");t.exports=class{constructor(t){this[r]=()=>{this.pending--,this[n]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[r])}}}},79788:(t,r,n)=>{"use strict";let o;let a=n(59796),c=n(84326),l=n(4155),{kStatusCode:d}=n(58578),f=Buffer.from([0,0,255,255]),m=Symbol("permessage-deflate"),_=Symbol("total-length"),g=Symbol("callback"),y=Symbol("buffers"),b=Symbol("error");function deflateOnData(t){this[y].push(t),this[_]+=t.length}function inflateOnData(t){if(this[_]+=t.length,this[m]._maxPayload<1||this[_]<=this[m]._maxPayload){this[y].push(t);return}this[b]=RangeError("Max payload size exceeded"),this[b].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[b][d]=1009,this.removeListener("data",inflateOnData),this.reset()}function inflateOnError(t){this[m]._inflate=null,t[d]=1007,this[g](t)}t.exports=class{constructor(t,r,n){if(this._maxPayload=0|n,this._options=t||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!o){let t=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;o=new l(t)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[g];this._deflate.close(),this._deflate=null,t&&t(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let r=this._options,n=t.find(t=>(!1!==r.serverNoContextTakeover||!t.server_no_context_takeover)&&(!t.server_max_window_bits||!1!==r.serverMaxWindowBits&&("number"!=typeof r.serverMaxWindowBits||!(r.serverMaxWindowBits>t.server_max_window_bits)))&&("number"!=typeof r.clientMaxWindowBits||!!t.client_max_window_bits));if(!n)throw Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(n.server_no_context_takeover=!0),r.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof r.serverMaxWindowBits&&(n.server_max_window_bits=r.serverMaxWindowBits),"number"==typeof r.clientMaxWindowBits?n.client_max_window_bits=r.clientMaxWindowBits:(!0===n.client_max_window_bits||!1===r.clientMaxWindowBits)&&delete n.client_max_window_bits,n}acceptAsClient(t){let r=t[0];if(!1===this._options.clientNoContextTakeover&&r.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(r.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(r.client_max_window_bits=this._options.clientMaxWindowBits);return r}normalizeParams(t){return t.forEach(t=>{Object.keys(t).forEach(r=>{let n=t[r];if(n.length>1)throw Error(`Parameter "${r}" must have only a single value`);if(n=n[0],"client_max_window_bits"===r){if(!0!==n){let t=+n;if(!Number.isInteger(t)||t<8||t>15)throw TypeError(`Invalid value for parameter "${r}": ${n}`);n=t}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${r}": ${n}`)}else if("server_max_window_bits"===r){let t=+n;if(!Number.isInteger(t)||t<8||t>15)throw TypeError(`Invalid value for parameter "${r}": ${n}`);n=t}else if("client_no_context_takeover"===r||"server_no_context_takeover"===r){if(!0!==n)throw TypeError(`Invalid value for parameter "${r}": ${n}`)}else throw Error(`Unknown parameter "${r}"`);t[r]=n})}),t}decompress(t,r,n){o.add(o=>{this._decompress(t,r,(t,r)=>{o(),n(t,r)})})}compress(t,r,n){o.add(o=>{this._compress(t,r,(t,r)=>{o(),n(t,r)})})}_decompress(t,r,n){let o=this._isServer?"client":"server";if(!this._inflate){let t=`${o}_max_window_bits`,r="number"!=typeof this.params[t]?a.Z_DEFAULT_WINDOWBITS:this.params[t];this._inflate=a.createInflateRaw({...this._options.zlibInflateOptions,windowBits:r}),this._inflate[m]=this,this._inflate[_]=0,this._inflate[y]=[],this._inflate.on("error",inflateOnError),this._inflate.on("data",inflateOnData)}this._inflate[g]=n,this._inflate.write(t),r&&this._inflate.write(f),this._inflate.flush(()=>{let t=this._inflate[b];if(t){this._inflate.close(),this._inflate=null,n(t);return}let a=c.concat(this._inflate[y],this._inflate[_]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[_]=0,this._inflate[y]=[],r&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),n(null,a)})}_compress(t,r,n){let o=this._isServer?"server":"client";if(!this._deflate){let t=`${o}_max_window_bits`,r="number"!=typeof this.params[t]?a.Z_DEFAULT_WINDOWBITS:this.params[t];this._deflate=a.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:r}),this._deflate[_]=0,this._deflate[y]=[],this._deflate.on("data",deflateOnData)}this._deflate[g]=n,this._deflate.write(t),this._deflate.flush(a.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let t=c.concat(this._deflate[y],this._deflate[_]);r&&(t=t.slice(0,t.length-4)),this._deflate[g]=null,this._deflate[_]=0,this._deflate[y]=[],r&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),n(null,t)})}}},56961:(t,r,n)=>{"use strict";let{Writable:o}=n(12781),a=n(79788),{BINARY_TYPES:c,EMPTY_BUFFER:l,kStatusCode:d,kWebSocket:f}=n(58578),{concat:m,toArrayBuffer:_,unmask:g}=n(84326),{isValidStatusCode:y,isValidUTF8:b}=n(23402);function error(t,r,n,o,a){let c=new t(n?`Invalid WebSocket frame: ${r}`:r);return Error.captureStackTrace(c,error),c.code=a,c[d]=o,c}t.exports=class extends o{constructor(t={}){super(),this._binaryType=t.binaryType||c[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=0|t.maxPayload,this._skipUTF8Validation=!!t.skipUTF8Validation,this[f]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(t,r,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(n)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let r=this._buffers[0];return this._buffers[0]=r.slice(t),r.slice(0,t)}let r=Buffer.allocUnsafe(t);do{let n=this._buffers[0],o=r.length-t;t>=n.length?r.set(this._buffers.shift(),o):(r.set(new Uint8Array(n.buffer,n.byteOffset,t),o),this._buffers[0]=n.slice(t)),t-=n.length}while(t>0);return r}startLoop(t){let r;this._loop=!0;do switch(this._state){case 0:r=this.getInfo();break;case 1:r=this.getPayloadLength16();break;case 2:r=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:r=this.getData(t);break;default:this._loop=!1;return}while(this._loop);t(r)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((48&t[0])!=0)return this._loop=!1,error(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let r=(64&t[0])==64;if(r&&!this._extensions[a.extensionName])return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(128&t[0])==128,this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r)return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,error(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,error(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=r}else{if(!(this._opcode>7)||!(this._opcode<11))return this._loop=!1,error(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,error(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(r)return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,error(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&t[1])==128,this._isServer){if(!this._masked)return this._loop=!1,error(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,error(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),r=t.readUInt32BE(0);return r>2097151?(this._loop=!1,error(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=4294967296*r+t.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,error(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(t){let r=l;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&g(r,this._mask)}if(this._opcode>7)return this.controlMessage(r);if(this._compressed){this._state=5,this.decompress(r,t);return}return r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage()}decompress(t,r){let n=this._extensions[a.extensionName];n.decompress(t,this._fin,(t,n)=>{if(t)return r(t);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return r(error(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(n)}let o=this.dataMessage();if(o)return r(o);this.startLoop(r)})}dataMessage(){if(this._fin){let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?m(r,t):"arraybuffer"===this._binaryType?_(m(r,t)):r,this.emit("message",n,!0)}else{let n=m(r,t);if(!this._skipUTF8Validation&&!b(n))return this._loop=!1,error(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n,!1)}}this._state=0}controlMessage(t){if(8===this._opcode){if(this._loop=!1,0===t.length)this.emit("conclude",1005,l),this.end();else{if(1===t.length)return error(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");let r=t.readUInt16BE(0);if(!y(r))return error(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let n=t.slice(2);if(!this._skipUTF8Validation&&!b(n))return error(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",r,n),this.end()}}else 9===this._opcode?this.emit("ping",t):this.emit("pong",t);this._state=0}}},25616:(t,r,n)=>{"use strict";n(41808),n(24404);let{randomFillSync:o}=n(6113),a=n(79788),{EMPTY_BUFFER:c}=n(58578),{isValidStatusCode:l}=n(23402),{mask:d,toBuffer:f}=n(84326),m=Symbol("kByteLength"),_=Buffer.alloc(4);let Sender=class Sender{constructor(t,r,n){this._extensions=r||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,r){let n,a;let c=!1,l=2,f=!1;r.mask&&(n=r.maskBuffer||_,r.generateMask?r.generateMask(n):o(n,0,4),f=(n[0]|n[1]|n[2]|n[3])==0,l=6),"string"==typeof t?a=(!r.mask||f)&&void 0!==r[m]?r[m]:(t=Buffer.from(t)).length:(a=t.length,c=r.mask&&r.readOnly&&!f);let g=a;a>=65536?(l+=8,g=127):a>125&&(l+=2,g=126);let y=Buffer.allocUnsafe(c?a+l:l);return(y[0]=r.fin?128|r.opcode:r.opcode,r.rsv1&&(y[0]|=64),y[1]=g,126===g?y.writeUInt16BE(a,2):127===g&&(y[2]=y[3]=0,y.writeUIntBE(a,4,6)),r.mask)?(y[1]|=128,y[l-4]=n[0],y[l-3]=n[1],y[l-2]=n[2],y[l-1]=n[3],f)?[y,t]:c?(d(t,n,y,l,a),[y]):(d(t,n,t,0,a),[y,t]):[y,t]}close(t,r,n,o){let a;if(void 0===t)a=c;else if("number"==typeof t&&l(t)){if(void 0!==r&&r.length){let n=Buffer.byteLength(r);if(n>123)throw RangeError("The message must not be greater than 123 bytes");(a=Buffer.allocUnsafe(2+n)).writeUInt16BE(t,0),"string"==typeof r?a.write(r,2):a.set(r,2)}else(a=Buffer.allocUnsafe(2)).writeUInt16BE(t,0)}else throw TypeError("First argument must be a valid error code number");let d={[m]:a.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,a,!1,d,o]):this.sendFrame(Sender.frame(a,d),o)}ping(t,r,n){let o,a;if("string"==typeof t?(o=Buffer.byteLength(t),a=!1):(o=(t=f(t)).length,a=f.readOnly),o>125)throw RangeError("The data size must not be greater than 125 bytes");let c={[m]:o,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:a,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,c,n]):this.sendFrame(Sender.frame(t,c),n)}pong(t,r,n){let o,a;if("string"==typeof t?(o=Buffer.byteLength(t),a=!1):(o=(t=f(t)).length,a=f.readOnly),o>125)throw RangeError("The data size must not be greater than 125 bytes");let c={[m]:o,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:a,rsv1:!1};this._deflating?this.enqueue([this.dispatch,t,!1,c,n]):this.sendFrame(Sender.frame(t,c),n)}send(t,r,n){let o,c;let l=this._extensions[a.extensionName],d=r.binary?2:1,_=r.compress;if("string"==typeof t?(o=Buffer.byteLength(t),c=!1):(o=(t=f(t)).length,c=f.readOnly),this._firstFragment?(this._firstFragment=!1,_&&l&&l.params[l._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(_=o>=l._threshold),this._compress=_):(_=!1,d=0),r.fin&&(this._firstFragment=!0),l){let a={[m]:o,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:d,readOnly:c,rsv1:_};this._deflating?this.enqueue([this.dispatch,t,this._compress,a,n]):this.dispatch(t,this._compress,a,n)}else this.sendFrame(Sender.frame(t,{[m]:o,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:d,readOnly:c,rsv1:!1}),n)}dispatch(t,r,n,o){if(!r){this.sendFrame(Sender.frame(t,n),o);return}let c=this._extensions[a.extensionName];this._bufferedBytes+=n[m],this._deflating=!0,c.compress(t,n.fin,(t,r)=>{if(this._socket.destroyed){let t=Error("The socket was closed while data was being compressed");"function"==typeof o&&o(t);for(let r=0;r<this._queue.length;r++){let n=this._queue[r],o=n[n.length-1];"function"==typeof o&&o(t)}return}this._bufferedBytes-=n[m],this._deflating=!1,n.readOnly=!1,this.sendFrame(Sender.frame(r,n),o),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[3][m],Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[3][m],this._queue.push(t)}sendFrame(t,r){2===t.length?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],r),this._socket.uncork()):this._socket.write(t[0],r)}};t.exports=Sender},86304:(t,r,n)=>{"use strict";let{Duplex:o}=n(12781);function emitClose(t){t.emit("close")}function duplexOnEnd(){!this.destroyed&&this._writableState.finished&&this.destroy()}function duplexOnError(t){this.removeListener("error",duplexOnError),this.destroy(),0===this.listenerCount("error")&&this.emit("error",t)}t.exports=function(t,r){let n=!0,a=new o({...r,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",function(r,n){let o=!n&&a._readableState.objectMode?r.toString():r;a.push(o)||t.pause()}),t.once("error",function(t){a.destroyed||(n=!1,a.destroy(t))}),t.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(r,o){if(t.readyState===t.CLOSED){o(r),process.nextTick(emitClose,a);return}let c=!1;t.once("error",function(t){c=!0,o(t)}),t.once("close",function(){c||o(r),process.nextTick(emitClose,a)}),n&&t.terminate()},a._final=function(r){if(t.readyState===t.CONNECTING){t.once("open",function(){a._final(r)});return}null!==t._socket&&(t._socket._writableState.finished?(r(),a._readableState.endEmitted&&a.destroy()):(t._socket.once("finish",function(){r()}),t.close()))},a._read=function(){t.isPaused&&t.resume()},a._write=function(r,n,o){if(t.readyState===t.CONNECTING){t.once("open",function(){a._write(r,n,o)});return}t.send(r,o)},a.on("end",duplexOnEnd),a.on("error",duplexOnError),a}},49235:(t,r,n)=>{"use strict";let{tokenChars:o}=n(23402);t.exports={parse:function(t){let r=new Set,n=-1,a=-1,c=0;for(;c<t.length;c++){let l=t.charCodeAt(c);if(-1===a&&1===o[l])-1===n&&(n=c);else if(0!==c&&(32===l||9===l))-1===a&&-1!==n&&(a=c);else if(44===l){if(-1===n)throw SyntaxError(`Unexpected character at index ${c}`);-1===a&&(a=c);let o=t.slice(n,a);if(r.has(o))throw SyntaxError(`The "${o}" subprotocol is duplicated`);r.add(o),n=a=-1}else throw SyntaxError(`Unexpected character at index ${c}`)}if(-1===n||-1!==a)throw SyntaxError("Unexpected end of input");let l=t.slice(n,c);if(r.has(l))throw SyntaxError(`The "${l}" subprotocol is duplicated`);return r.add(l),r}}},23402:(t,r,n)=>{"use strict";function _isValidUTF8(t){let r=t.length,n=0;for(;n<r;)if((128&t[n])==0)n++;else if((224&t[n])==192){if(n+1===r||(192&t[n+1])!=128||(254&t[n])==192)return!1;n+=2}else if((240&t[n])==224){if(n+2>=r||(192&t[n+1])!=128||(192&t[n+2])!=128||224===t[n]&&(224&t[n+1])==128||237===t[n]&&(224&t[n+1])==160)return!1;n+=3}else{if((248&t[n])!=240||n+3>=r||(192&t[n+1])!=128||(192&t[n+2])!=128||(192&t[n+3])!=128||240===t[n]&&(240&t[n+1])==128||244===t[n]&&t[n+1]>143||t[n]>244)return!1;n+=4}return!0}if(t.exports={isValidStatusCode:function(t){return t>=1e3&&t<=1014&&1004!==t&&1005!==t&&1006!==t||t>=3e3&&t<=4999},isValidUTF8:_isValidUTF8,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},!process.env.WS_NO_UTF_8_VALIDATE)try{let r=n(Object(function(){var t=Error("Cannot find module 'utf-8-validate'");throw t.code="MODULE_NOT_FOUND",t}()));t.exports.isValidUTF8=function(t){return t.length<150?_isValidUTF8(t):r(t)}}catch(t){}},21311:(t,r,n)=>{"use strict";let o=n(82361),a=n(13685);n(95687),n(41808),n(24404);let{createHash:c}=n(6113),l=n(53399),d=n(79788),f=n(49235),m=n(59921),{GUID:_,kWebSocket:g}=n(58578),y=/^[+/0-9A-Za-z]{22}==$/;function emitClose(t){t._state=2,t.emit("close")}function socketOnError(){this.destroy()}function abortHandshake(t,r,n,o){n=n||a.STATUS_CODES[r],o={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...o},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${r} ${a.STATUS_CODES[r]}\r
`+Object.keys(o).map(t=>`${t}: ${o[t]}`).join("\r\n")+"\r\n\r\n"+n)}function abortHandshakeOrEmitwsClientError(t,r,n,o,a){if(t.listenerCount("wsClientError")){let o=Error(a);Error.captureStackTrace(o,abortHandshakeOrEmitwsClientError),t.emit("wsClientError",o,n,r)}else abortHandshake(n,o,a)}t.exports=class extends o{constructor(t,r){if(super(),null==(t={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:m,...t}).port&&!t.server&&!t.noServer||null!=t.port&&(t.server||t.noServer)||t.server&&t.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=t.port?(this._server=a.createServer((t,r)=>{let n=a.STATUS_CODES[426];r.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),r.end(n)}),this._server.listen(t.port,t.host,t.backlog,r)):t.server&&(this._server=t.server),this._server){let t=this.emit.bind(this,"connection");this._removeListeners=function(t,r){for(let n of Object.keys(r))t.on(n,r[n]);return function(){for(let n of Object.keys(r))t.removeListener(n,r[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(r,n,o)=>{this.handleUpgrade(r,n,o,t)}})}!0===t.perMessageDeflate&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(2===this._state){t&&this.once("close",()=>{t(Error("The server is not running"))}),process.nextTick(emitClose,this);return}if(t&&this.once("close",t),1!==this._state){if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(emitClose,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{emitClose(this)})}}}shouldHandle(t){if(this.options.path){let r=t.url.indexOf("?"),n=-1!==r?t.url.slice(0,r):t.url;if(n!==this.options.path)return!1}return!0}handleUpgrade(t,r,n,o){r.on("error",socketOnError);let a=t.headers["sec-websocket-key"],c=+t.headers["sec-websocket-version"];if("GET"!==t.method){abortHandshakeOrEmitwsClientError(this,t,r,405,"Invalid HTTP method");return}if("websocket"!==t.headers.upgrade.toLowerCase()){abortHandshakeOrEmitwsClientError(this,t,r,400,"Invalid Upgrade header");return}if(!a||!y.test(a)){abortHandshakeOrEmitwsClientError(this,t,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(8!==c&&13!==c){abortHandshakeOrEmitwsClientError(this,t,r,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(t)){abortHandshake(r,400);return}let m=t.headers["sec-websocket-protocol"],_=new Set;if(void 0!==m)try{_=f.parse(m)}catch(n){abortHandshakeOrEmitwsClientError(this,t,r,400,"Invalid Sec-WebSocket-Protocol header");return}let g=t.headers["sec-websocket-extensions"],b={};if(this.options.perMessageDeflate&&void 0!==g){let n=new d(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let t=l.parse(g);t[d.extensionName]&&(n.accept(t[d.extensionName]),b[d.extensionName]=n)}catch(n){abortHandshakeOrEmitwsClientError(this,t,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let l={origin:t.headers[`${8===c?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(2===this.options.verifyClient.length){this.options.verifyClient(l,(c,l,d,f)=>{if(!c)return abortHandshake(r,l||401,d,f);this.completeUpgrade(b,a,_,t,r,n,o)});return}if(!this.options.verifyClient(l))return abortHandshake(r,401)}this.completeUpgrade(b,a,_,t,r,n,o)}completeUpgrade(t,r,n,o,a,f,m){if(!a.readable||!a.writable)return a.destroy();if(a[g])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return abortHandshake(a,503);let y=c("sha1").update(r+_).digest("base64"),b=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${y}`],S=new this.options.WebSocket(null);if(n.size){let t=this.options.handleProtocols?this.options.handleProtocols(n,o):n.values().next().value;t&&(b.push(`Sec-WebSocket-Protocol: ${t}`),S._protocol=t)}if(t[d.extensionName]){let r=t[d.extensionName].params,n=l.format({[d.extensionName]:[r]});b.push(`Sec-WebSocket-Extensions: ${n}`),S._extensions=t}this.emit("headers",b,o),a.write(b.concat("\r\n").join("\r\n")),a.removeListener("error",socketOnError),S.setSocket(a,f,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(S),S.on("close",()=>{this.clients.delete(S),this._shouldEmitClose&&!this.clients.size&&process.nextTick(emitClose,this)})),m(S,o)}}},59921:(t,r,n)=>{"use strict";let o=n(82361),a=n(95687),c=n(13685),l=n(41808),d=n(24404),{randomBytes:f,createHash:m}=n(6113),{Readable:_}=n(12781),{URL:g}=n(57310),y=n(79788),b=n(56961),S=n(25616),{BINARY_TYPES:E,EMPTY_BUFFER:w,GUID:T,kForOnEventAttribute:O,kListener:R,kStatusCode:x,kWebSocket:P,NOOP:A}=n(58578),{EventTarget:{addEventListener:M,removeEventListener:D}}=n(67033),{format:I,parse:j}=n(53399),{toBuffer:B}=n(84326),U=Symbol("kAborted"),N=[8,13],F=["CONNECTING","OPEN","CLOSING","CLOSED"],$=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;let WebSocket=class WebSocket extends o{constructor(t,r,n){super(),this._binaryType=E[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=w,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=WebSocket.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==t?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===r?r=[]:Array.isArray(r)||("object"==typeof r&&null!==r?(n=r,r=[]):r=[r]),function initAsClient(t,r,n,o){let l,d,_,b;let S={protocolVersion:N[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!N.includes(S.protocolVersion))throw RangeError(`Unsupported protocol version: ${S.protocolVersion} (supported versions: ${N.join(", ")})`);if(r instanceof g)l=r,t._url=r.href;else{try{l=new g(r)}catch(t){throw SyntaxError(`Invalid URL: ${r}`)}t._url=r}let E="wss:"===l.protocol,w="ws+unix:"===l.protocol;if("ws:"===l.protocol||E||w?w&&!l.pathname?d="The URL's pathname is empty":l.hash&&(d="The URL contains a fragment identifier"):d='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"',d){let r=SyntaxError(d);if(0===t._redirects)throw r;emitErrorAndClose(t,r);return}let O=E?443:80,R=f(16).toString("base64"),x=E?a.request:c.request,P=new Set;if(S.createConnection=E?tlsConnect:netConnect,S.defaultPort=S.defaultPort||O,S.port=l.port||O,S.host=l.hostname.startsWith("[")?l.hostname.slice(1,-1):l.hostname,S.headers={...S.headers,"Sec-WebSocket-Version":S.protocolVersion,"Sec-WebSocket-Key":R,Connection:"Upgrade",Upgrade:"websocket"},S.path=l.pathname+l.search,S.timeout=S.handshakeTimeout,S.perMessageDeflate&&(_=new y(!0!==S.perMessageDeflate?S.perMessageDeflate:{},!1,S.maxPayload),S.headers["Sec-WebSocket-Extensions"]=I({[y.extensionName]:_.offer()})),n.length){for(let t of n){if("string"!=typeof t||!$.test(t)||P.has(t))throw SyntaxError("An invalid or duplicated subprotocol was specified");P.add(t)}S.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(S.origin&&(S.protocolVersion<13?S.headers["Sec-WebSocket-Origin"]=S.origin:S.headers.Origin=S.origin),(l.username||l.password)&&(S.auth=`${l.username}:${l.password}`),w){let t=S.path.split(":");S.socketPath=t[0],S.path=t[1]}if(S.followRedirects){if(0===t._redirects){t._originalIpc=w,t._originalSecure=E,t._originalHostOrSocketPath=w?S.socketPath:l.host;let r=o&&o.headers;if(o={...o,headers:{}},r)for(let[t,n]of Object.entries(r))o.headers[t.toLowerCase()]=n}else if(0===t.listenerCount("redirect")){let r=w?!!t._originalIpc&&S.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&l.host===t._originalHostOrSocketPath;r&&(!t._originalSecure||E)||(delete S.headers.authorization,delete S.headers.cookie,r||delete S.headers.host,S.auth=void 0)}S.auth&&!o.headers.authorization&&(o.headers.authorization="Basic "+Buffer.from(S.auth).toString("base64")),b=t._req=x(S),t._redirects&&t.emit("redirect",t.url,b)}else b=t._req=x(S);S.timeout&&b.on("timeout",()=>{abortHandshake(t,b,"Opening handshake has timed out")}),b.on("error",r=>{null===b||b[U]||(b=t._req=null,emitErrorAndClose(t,r))}),b.on("response",a=>{let c=a.headers.location,l=a.statusCode;if(c&&S.followRedirects&&l>=300&&l<400){let a;if(++t._redirects>S.maxRedirects){abortHandshake(t,b,"Maximum redirects exceeded");return}b.abort();try{a=new g(c,r)}catch(n){let r=SyntaxError(`Invalid URL: ${c}`);emitErrorAndClose(t,r);return}initAsClient(t,a,n,o)}else t.emit("unexpected-response",b,a)||abortHandshake(t,b,`Unexpected server response: ${a.statusCode}`)}),b.on("upgrade",(r,n,o)=>{let a;if(t.emit("upgrade",r),t.readyState!==WebSocket.CONNECTING)return;if(b=t._req=null,"websocket"!==r.headers.upgrade.toLowerCase()){abortHandshake(t,n,"Invalid Upgrade header");return}let c=m("sha1").update(R+T).digest("base64");if(r.headers["sec-websocket-accept"]!==c){abortHandshake(t,n,"Invalid Sec-WebSocket-Accept header");return}let l=r.headers["sec-websocket-protocol"];if(void 0!==l?P.size?P.has(l)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":P.size&&(a="Server sent no subprotocol"),a){abortHandshake(t,n,a);return}l&&(t._protocol=l);let d=r.headers["sec-websocket-extensions"];if(void 0!==d){let r;if(!_){abortHandshake(t,n,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}try{r=j(d)}catch(r){abortHandshake(t,n,"Invalid Sec-WebSocket-Extensions header");return}let o=Object.keys(r);if(1!==o.length||o[0]!==y.extensionName){abortHandshake(t,n,"Server indicated an extension that was not requested");return}try{_.accept(r[y.extensionName])}catch(r){abortHandshake(t,n,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[y.extensionName]=_}t.setSocket(n,o,{generateMask:S.generateMask,maxPayload:S.maxPayload,skipUTF8Validation:S.skipUTF8Validation})}),b.end()}(this,t,r,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(t){E.includes(t)&&(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,r,n){let o=new b({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new S(t,this._extensions,n.generateMask),this._receiver=o,this._socket=t,o[P]=this,t[P]=this,o.on("conclude",receiverOnConclude),o.on("drain",receiverOnDrain),o.on("error",receiverOnError),o.on("message",receiverOnMessage),o.on("ping",receiverOnPing),o.on("pong",receiverOnPong),t.setTimeout(0),t.setNoDelay(),r.length>0&&t.unshift(r),t.on("close",socketOnClose),t.on("data",socketOnData),t.on("end",socketOnEnd),t.on("error",socketOnError),this._readyState=WebSocket.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=WebSocket.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[y.extensionName]&&this._extensions[y.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=WebSocket.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,r){if(this.readyState!==WebSocket.CLOSED){if(this.readyState===WebSocket.CONNECTING)return abortHandshake(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===WebSocket.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=WebSocket.CLOSING,this._sender.close(t,r,!this._isServer,t=>{!t&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)}}pause(){this.readyState!==WebSocket.CONNECTING&&this.readyState!==WebSocket.CLOSED&&(this._paused=!0,this._socket.pause())}ping(t,r,n){if(this.readyState===WebSocket.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t?(n=t,t=r=void 0):"function"==typeof r&&(n=r,r=void 0),"number"==typeof t&&(t=t.toString()),this.readyState!==WebSocket.OPEN){sendAfterClose(this,t,n);return}void 0===r&&(r=!this._isServer),this._sender.ping(t||w,r,n)}pong(t,r,n){if(this.readyState===WebSocket.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t?(n=t,t=r=void 0):"function"==typeof r&&(n=r,r=void 0),"number"==typeof t&&(t=t.toString()),this.readyState!==WebSocket.OPEN){sendAfterClose(this,t,n);return}void 0===r&&(r=!this._isServer),this._sender.pong(t||w,r,n)}resume(){this.readyState!==WebSocket.CONNECTING&&this.readyState!==WebSocket.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,r,n){if(this.readyState===WebSocket.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof r&&(n=r,r={}),"number"==typeof t&&(t=t.toString()),this.readyState!==WebSocket.OPEN){sendAfterClose(this,t,n);return}let o={binary:"string"!=typeof t,mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[y.extensionName]||(o.compress=!1),this._sender.send(t||w,o,n)}terminate(){if(this.readyState!==WebSocket.CLOSED){if(this.readyState===WebSocket.CONNECTING)return abortHandshake(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=WebSocket.CLOSING,this._socket.destroy())}}};function emitErrorAndClose(t,r){t._readyState=WebSocket.CLOSING,t.emit("error",r),t.emitClose()}function netConnect(t){return t.path=t.socketPath,l.connect(t)}function tlsConnect(t){return t.path=void 0,t.servername||""===t.servername||(t.servername=l.isIP(t.host)?"":t.host),d.connect(t)}function abortHandshake(t,r,n){t._readyState=WebSocket.CLOSING;let o=Error(n);Error.captureStackTrace(o,abortHandshake),r.setHeader?(r[U]=!0,r.abort(),r.socket&&!r.socket.destroyed&&r.socket.destroy(),process.nextTick(emitErrorAndClose,t,o)):(r.destroy(o),r.once("error",t.emit.bind(t,"error")),r.once("close",t.emitClose.bind(t)))}function sendAfterClose(t,r,n){if(r){let n=B(r).length;t._socket?t._sender._bufferedBytes+=n:t._bufferedAmount+=n}if(n){let r=Error(`WebSocket is not open: readyState ${t.readyState} (${F[t.readyState]})`);n(r)}}function receiverOnConclude(t,r){let n=this[P];n._closeFrameReceived=!0,n._closeMessage=r,n._closeCode=t,void 0!==n._socket[P]&&(n._socket.removeListener("data",socketOnData),process.nextTick(resume,n._socket),1005===t?n.close():n.close(t,r))}function receiverOnDrain(){let t=this[P];t.isPaused||t._socket.resume()}function receiverOnError(t){let r=this[P];void 0!==r._socket[P]&&(r._socket.removeListener("data",socketOnData),process.nextTick(resume,r._socket),r.close(t[x])),r.emit("error",t)}function receiverOnFinish(){this[P].emitClose()}function receiverOnMessage(t,r){this[P].emit("message",t,r)}function receiverOnPing(t){let r=this[P];r.pong(t,!r._isServer,A),r.emit("ping",t)}function receiverOnPong(t){this[P].emit("pong",t)}function resume(t){t.resume()}function socketOnClose(){let t;let r=this[P];this.removeListener("close",socketOnClose),this.removeListener("data",socketOnData),this.removeListener("end",socketOnEnd),r._readyState=WebSocket.CLOSING,this._readableState.endEmitted||r._closeFrameReceived||r._receiver._writableState.errorEmitted||null===(t=r._socket.read())||r._receiver.write(t),r._receiver.end(),this[P]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",receiverOnFinish),r._receiver.on("finish",receiverOnFinish))}function socketOnData(t){this[P]._receiver.write(t)||this.pause()}function socketOnEnd(){let t=this[P];t._readyState=WebSocket.CLOSING,t._receiver.end(),this.end()}function socketOnError(){let t=this[P];this.removeListener("error",socketOnError),this.on("error",A),t&&(t._readyState=WebSocket.CLOSING,this.destroy())}Object.defineProperty(WebSocket,"CONNECTING",{enumerable:!0,value:F.indexOf("CONNECTING")}),Object.defineProperty(WebSocket.prototype,"CONNECTING",{enumerable:!0,value:F.indexOf("CONNECTING")}),Object.defineProperty(WebSocket,"OPEN",{enumerable:!0,value:F.indexOf("OPEN")}),Object.defineProperty(WebSocket.prototype,"OPEN",{enumerable:!0,value:F.indexOf("OPEN")}),Object.defineProperty(WebSocket,"CLOSING",{enumerable:!0,value:F.indexOf("CLOSING")}),Object.defineProperty(WebSocket.prototype,"CLOSING",{enumerable:!0,value:F.indexOf("CLOSING")}),Object.defineProperty(WebSocket,"CLOSED",{enumerable:!0,value:F.indexOf("CLOSED")}),Object.defineProperty(WebSocket.prototype,"CLOSED",{enumerable:!0,value:F.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty(WebSocket.prototype,t,{enumerable:!0})}),["open","error","close","message"].forEach(t=>{Object.defineProperty(WebSocket.prototype,`on${t}`,{enumerable:!0,get(){for(let r of this.listeners(t))if(r[O])return r[R];return null},set(r){for(let r of this.listeners(t))if(r[O]){this.removeListener(t,r);break}"function"==typeof r&&this.addEventListener(t,r,{[O]:!0})}})}),WebSocket.prototype.addEventListener=M,WebSocket.prototype.removeEventListener=D,t.exports=WebSocket},48419:t=>{"use strict";var r=Object.prototype.hasOwnProperty,n="~";function Events(){}function EE(t,r,n){this.fn=t,this.context=r,this.once=n||!1}function addListener(t,r,o,a,c){if("function"!=typeof o)throw TypeError("The listener must be a function");var l=new EE(o,a||t,c),d=n?n+r:r;return t._events[d]?t._events[d].fn?t._events[d]=[t._events[d],l]:t._events[d].push(l):(t._events[d]=l,t._eventsCount++),t}function clearEvent(t,r){0==--t._eventsCount?t._events=new Events:delete t._events[r]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),new Events().__proto__||(n=!1)),EventEmitter.prototype.eventNames=function(){var t,o,a=[];if(0===this._eventsCount)return a;for(o in t=this._events)r.call(t,o)&&a.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(t)):a},EventEmitter.prototype.listeners=function(t){var r=n?n+t:t,o=this._events[r];if(!o)return[];if(o.fn)return[o.fn];for(var a=0,c=o.length,l=Array(c);a<c;a++)l[a]=o[a].fn;return l},EventEmitter.prototype.listenerCount=function(t){var r=n?n+t:t,o=this._events[r];return o?o.fn?1:o.length:0},EventEmitter.prototype.emit=function(t,r,o,a,c,l){var d=n?n+t:t;if(!this._events[d])return!1;var f,m,_=this._events[d],g=arguments.length;if(_.fn){switch(_.once&&this.removeListener(t,_.fn,void 0,!0),g){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,r),!0;case 3:return _.fn.call(_.context,r,o),!0;case 4:return _.fn.call(_.context,r,o,a),!0;case 5:return _.fn.call(_.context,r,o,a,c),!0;case 6:return _.fn.call(_.context,r,o,a,c,l),!0}for(m=1,f=Array(g-1);m<g;m++)f[m-1]=arguments[m];_.fn.apply(_.context,f)}else{var y,b=_.length;for(m=0;m<b;m++)switch(_[m].once&&this.removeListener(t,_[m].fn,void 0,!0),g){case 1:_[m].fn.call(_[m].context);break;case 2:_[m].fn.call(_[m].context,r);break;case 3:_[m].fn.call(_[m].context,r,o);break;case 4:_[m].fn.call(_[m].context,r,o,a);break;default:if(!f)for(y=1,f=Array(g-1);y<g;y++)f[y-1]=arguments[y];_[m].fn.apply(_[m].context,f)}}return!0},EventEmitter.prototype.on=function(t,r,n){return addListener(this,t,r,n,!1)},EventEmitter.prototype.once=function(t,r,n){return addListener(this,t,r,n,!0)},EventEmitter.prototype.removeListener=function(t,r,o,a){var c=n?n+t:t;if(!this._events[c])return this;if(!r)return clearEvent(this,c),this;var l=this._events[c];if(l.fn)l.fn!==r||a&&!l.once||o&&l.context!==o||clearEvent(this,c);else{for(var d=0,f=[],m=l.length;d<m;d++)(l[d].fn!==r||a&&!l[d].once||o&&l[d].context!==o)&&f.push(l[d]);f.length?this._events[c]=1===f.length?f[0]:f:clearEvent(this,c)}return this},EventEmitter.prototype.removeAllListeners=function(t){var r;return t?(r=n?n+t:t,this._events[r]&&clearEvent(this,r)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=n,EventEmitter.EventEmitter=EventEmitter,t.exports=EventEmitter},5446:t=>{self,t.exports=function(){var t={"./node_modules/es6-promise/dist/es6-promise.js":function(t,r,n){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */t.exports=function(){"use strict";function isFunction(t){return"function"==typeof t}var t,r,o,a,c=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},l=0,d=void 0,f=void 0,asap=function(t,r){S[l]=t,S[l+1]=r,2===(l+=2)&&(f?f(flush):E())},m="undefined"!=typeof window?window:void 0,_=m||{},g=_.MutationObserver||_.WebKitMutationObserver,y="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"===({}).toString.call(process),b="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function useSetTimeout(){var t=setTimeout;return function(){return t(flush,1)}}var S=Array(1e3);function flush(){for(var t=0;t<l;t+=2)(0,S[t])(S[t+1]),S[t]=void 0,S[t+1]=void 0;l=0}var E=void 0;function then(t,r){var n=this,o=new this.constructor(noop);void 0===o[w]&&makePromise(o);var a=n._state;if(a){var c=arguments[a-1];asap(function(){return invokeCallback(a,o,c,n._result)})}else subscribe(n,o,t,r);return o}function resolve$1(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var r=new this(noop);return resolve(r,t),r}y?E=function(){return process.nextTick(flush)}:g?(t=0,r=new g(flush),o=document.createTextNode(""),r.observe(o,{characterData:!0}),E=function(){o.data=t=++t%2}):b?((a=new MessageChannel).port1.onmessage=flush,E=function(){return a.port2.postMessage(0)}):E=void 0===m?function(){try{var t=Function("return this")().require("vertx");return d=t.runOnLoop||t.runOnContext,void 0!==d?function(){d(flush)}:useSetTimeout()}catch(t){return useSetTimeout()}}():useSetTimeout();var w=Math.random().toString(36).substring(2);function noop(){}var T=void 0;function handleMaybeThenable(t,r,n){r.constructor===t.constructor&&n===then&&r.constructor.resolve===resolve$1?1===r._state?fulfill(t,r._result):2===r._state?reject(t,r._result):subscribe(r,void 0,function(r){return resolve(t,r)},function(r){return reject(t,r)}):void 0===n?fulfill(t,r):isFunction(n)?asap(function(t){var o=!1,a=function(t,r,n,o){try{t.call(r,n,o)}catch(t){return t}}(n,r,function(n){o||(o=!0,r!==n?resolve(t,n):fulfill(t,n))},function(r){o||(o=!0,reject(t,r))},"Settle: "+(t._label||" unknown promise"));!o&&a&&(o=!0,reject(t,a))},t):fulfill(t,r)}function resolve(t,r){if(t===r)reject(t,TypeError("You cannot resolve a promise with itself"));else if(n=typeof r,null!==r&&("object"===n||"function"===n)){var n,o=void 0;try{o=r.then}catch(r){reject(t,r);return}handleMaybeThenable(t,r,o)}else fulfill(t,r)}function publishRejection(t){t._onerror&&t._onerror(t._result),publish(t)}function fulfill(t,r){t._state===T&&(t._result=r,t._state=1,0!==t._subscribers.length&&asap(publish,t))}function reject(t,r){t._state===T&&(t._state=2,t._result=r,asap(publishRejection,t))}function subscribe(t,r,n,o){var a=t._subscribers,c=a.length;t._onerror=null,a[c]=r,a[c+1]=n,a[c+2]=o,0===c&&t._state&&asap(publish,t)}function publish(t){var r=t._subscribers,n=t._state;if(0!==r.length){for(var o=void 0,a=void 0,c=t._result,l=0;l<r.length;l+=3)o=r[l],a=r[l+n],o?invokeCallback(n,o,a,c):a(c);t._subscribers.length=0}}function invokeCallback(t,r,n,o){var a=isFunction(n),c=void 0,l=void 0,d=!0;if(a){try{c=n(o)}catch(t){d=!1,l=t}if(r===c){reject(r,TypeError("A promises callback cannot return that same promise."));return}}else c=o;r._state!==T||(a&&d?resolve(r,c):!1===d?reject(r,l):1===t?fulfill(r,c):2===t&&reject(r,c))}var O=0;function makePromise(t){t[w]=O++,t._state=void 0,t._result=void 0,t._subscribers=[]}var R=function(){function Enumerator(t,r){this._instanceConstructor=t,this.promise=new t(noop),this.promise[w]||makePromise(this.promise),c(r)?(this.length=r.length,this._remaining=r.length,this._result=Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,Error("Array Methods must be provided an Array"))}return Enumerator.prototype._enumerate=function(t){for(var r=0;this._state===T&&r<t.length;r++)this._eachEntry(t[r],r)},Enumerator.prototype._eachEntry=function(t,r){var n=this._instanceConstructor,o=n.resolve;if(o===resolve$1){var a=void 0,c=void 0,l=!1;try{a=t.then}catch(t){l=!0,c=t}if(a===then&&t._state!==T)this._settledAt(t._state,r,t._result);else if("function"!=typeof a)this._remaining--,this._result[r]=t;else if(n===x){var d=new n(noop);l?reject(d,c):handleMaybeThenable(d,t,a),this._willSettleAt(d,r)}else this._willSettleAt(new n(function(r){return r(t)}),r)}else this._willSettleAt(o(t),r)},Enumerator.prototype._settledAt=function(t,r,n){var o=this.promise;o._state===T&&(this._remaining--,2===t?reject(o,n):this._result[r]=n),0===this._remaining&&fulfill(o,this._result)},Enumerator.prototype._willSettleAt=function(t,r){var n=this;subscribe(t,void 0,function(t){return n._settledAt(1,r,t)},function(t){return n._settledAt(2,r,t)})},Enumerator}(),x=function(){function Promise(t){this[w]=O++,this._result=this._state=void 0,this._subscribers=[],noop!==t&&("function"!=typeof t&&function(){throw TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof Promise?function(t,r){try{r(function(r){resolve(t,r)},function(r){reject(t,r)})}catch(r){reject(t,r)}}(this,t):function(){throw TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return Promise.prototype.catch=function(t){return this.then(null,t)},Promise.prototype.finally=function(t){var r=this.constructor;return isFunction(t)?this.then(function(n){return r.resolve(t()).then(function(){return n})},function(n){return r.resolve(t()).then(function(){throw n})}):this.then(t,t)},Promise}();return x.prototype.then=then,x.all=function(t){return new R(this,t).promise},x.race=function(t){var r=this;return new r(c(t)?function(n,o){for(var a=t.length,c=0;c<a;c++)r.resolve(t[c]).then(n,o)}:function(t,r){return r(TypeError("You must pass an array to race."))})},x.resolve=resolve$1,x.reject=function(t){var r=new this(noop);return reject(r,t),r},x._setScheduler=function(t){f=t},x._setAsap=function(t){asap=t},x._asap=asap,x.polyfill=function(){var t=void 0;if(void 0!==n.g)t=n.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw Error("polyfill failed because global object is unavailable in this environment")}var r=t.Promise;if(r){var o=null;try{o=Object.prototype.toString.call(r.resolve())}catch(t){}if("[object Promise]"===o&&!r.cast)return}t.Promise=x},x.Promise=x,x}()},"./node_modules/events/events.js":function(t){"use strict";var r,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function EventEmitter(){EventEmitter.init.call(this)}t.exports=EventEmitter,t.exports.once=function(t,r){return new Promise(function(n,o){function errorListener(n){t.removeListener(r,resolver),o(n)}function resolver(){"function"==typeof t.removeListener&&t.removeListener("error",errorListener),n([].slice.call(arguments))}eventTargetAgnosticAddListener(t,r,resolver,{once:!0}),"error"!==r&&"function"==typeof t.on&&eventTargetAgnosticAddListener(t,"error",errorListener,{once:!0})})},EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var c=10;function checkListener(t){if("function"!=typeof t)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function _getMaxListeners(t){return void 0===t._maxListeners?EventEmitter.defaultMaxListeners:t._maxListeners}function _addListener(t,r,n,o){if(checkListener(n),void 0===(c=t._events)?(c=t._events=Object.create(null),t._eventsCount=0):(void 0!==c.newListener&&(t.emit("newListener",r,n.listener?n.listener:n),c=t._events),l=c[r]),void 0===l)l=c[r]=n,++t._eventsCount;else if("function"==typeof l?l=c[r]=o?[n,l]:[l,n]:o?l.unshift(n):l.push(n),(a=_getMaxListeners(t))>0&&l.length>a&&!l.warned){l.warned=!0;var a,c,l,d=Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=t,d.type=r,d.count=l.length,console&&console.warn&&console.warn(d)}return t}function onceWrapper(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(t,r,n){var o={fired:!1,wrapFn:void 0,target:t,type:r,listener:n},a=onceWrapper.bind(o);return a.listener=n,o.wrapFn=a,a}function _listeners(t,r,n){var o=t._events;if(void 0===o)return[];var a=o[r];return void 0===a?[]:"function"==typeof a?n?[a.listener||a]:[a]:n?function(t){for(var r=Array(t.length),n=0;n<r.length;++n)r[n]=t[n].listener||t[n];return r}(a):arrayClone(a,a.length)}function listenerCount(t){var r=this._events;if(void 0!==r){var n=r[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(t,r){for(var n=Array(r),o=0;o<r;++o)n[o]=t[o];return n}function eventTargetAgnosticAddListener(t,r,n,o){if("function"==typeof t.on)o.once?t.once(r,n):t.on(r,n);else if("function"==typeof t.addEventListener)t.addEventListener(r,function wrapListener(a){o.once&&t.removeEventListener(r,wrapListener),n(a)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||a(t))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),EventEmitter.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var a="error"===t,c=this._events;if(void 0!==c)a=a&&void 0===c.error;else if(!a)return!1;if(a){if(r.length>0&&(l=r[0]),l instanceof Error)throw l;var l,d=Error("Unhandled error."+(l?" ("+l.message+")":""));throw d.context=l,d}var f=c[t];if(void 0===f)return!1;if("function"==typeof f)o(f,this,r);else for(var m=f.length,_=arrayClone(f,m),n=0;n<m;++n)o(_[n],this,r);return!0},EventEmitter.prototype.addListener=function(t,r){return _addListener(this,t,r,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(t,r){return _addListener(this,t,r,!0)},EventEmitter.prototype.once=function(t,r){return checkListener(r),this.on(t,_onceWrap(this,t,r)),this},EventEmitter.prototype.prependOnceListener=function(t,r){return checkListener(r),this.prependListener(t,_onceWrap(this,t,r)),this},EventEmitter.prototype.removeListener=function(t,r){var n,o,a,c,l;if(checkListener(r),void 0===(o=this._events)||void 0===(n=o[t]))return this;if(n===r||n.listener===r)0==--this._eventsCount?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||r));else if("function"!=typeof n){for(a=-1,c=n.length-1;c>=0;c--)if(n[c]===r||n[c].listener===r){l=n[c].listener,a=c;break}if(a<0)return this;0===a?n.shift():function(t,r){for(;r+1<t.length;r++)t[r]=t[r+1];t.pop()}(n,a),1===n.length&&(o[t]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",t,l||r)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(t){var r,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0==arguments.length){var a,c=Object.keys(n);for(o=0;o<c.length;++o)"removeListener"!==(a=c[o])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(r=n[t]))this.removeListener(t,r);else if(void 0!==r)for(o=r.length-1;o>=0;o--)this.removeListener(t,r[o]);return this},EventEmitter.prototype.listeners=function(t){return _listeners(this,t,!0)},EventEmitter.prototype.rawListeners=function(t){return _listeners(this,t,!1)},EventEmitter.listenerCount=function(t,r){return"function"==typeof t.listenerCount?t.listenerCount(r):listenerCount.call(t,r)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},"./node_modules/webworkify-webpack/index.js":function(t,r,n){function webpackBootstrapFunc(t){var r={};function __nested_webpack_require_164__(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,__nested_webpack_require_164__),o.l=!0,o.exports}__nested_webpack_require_164__.m=t,__nested_webpack_require_164__.c=r,__nested_webpack_require_164__.i=function(t){return t},__nested_webpack_require_164__.d=function(t,r,n){__nested_webpack_require_164__.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},__nested_webpack_require_164__.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},__nested_webpack_require_164__.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return __nested_webpack_require_164__.d(r,"a",r),r},__nested_webpack_require_164__.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},__nested_webpack_require_164__.p="/",__nested_webpack_require_164__.oe=function(t){throw console.error(t),t};var n=__nested_webpack_require_164__(__nested_webpack_require_164__.s=ENTRY_MODULE);return n.default||n}var o="[\\.|\\-|\\+|\\w|/|@]+",a="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+o+").*?\\)";function quoteRegExp(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}t.exports=function(t,r){r=r||{};var c={main:n.m},l=r.all?{main:Object.keys(c.main)}:function(t,r){for(var c={main:[r]},l={main:[]},d={main:{}};Object.keys(c).reduce(function(t,r){return t||c[r].length>0},!1);)for(var f=Object.keys(c),m=0;m<f.length;m++){var _=f[m],g=c[_].pop();if(d[_]=d[_]||{},!d[_][g]&&t[_][g]){d[_][g]=!0,l[_]=l[_]||[],l[_].push(g);for(var y=function(t,r,c){var l,d={};d[c]=[];var f=r.toString(),m=f.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!m)return d;for(var _=m[1],g=RegExp("(\\\\n|\\W)"+quoteRegExp(_)+a,"g");l=g.exec(f);)"dll-reference"!==l[3]&&d[c].push(l[3]);for(g=RegExp("\\("+quoteRegExp(_)+'\\("(dll-reference\\s('+o+'))"\\)\\)'+a,"g");l=g.exec(f);)t[l[2]]||(d[c].push(l[1]),t[l[2]]=n(l[1]).m),d[l[2]]=d[l[2]]||[],d[l[2]].push(l[4]);for(var y=Object.keys(d),b=0;b<y.length;b++)for(var S=0;S<d[y[b]].length;S++)isNaN(1*d[y[b]][S])||(d[y[b]][S]=1*d[y[b]][S]);return d}(t,t[_][g],_),b=Object.keys(y),S=0;S<b.length;S++)c[b[S]]=c[b[S]]||[],c[b[S]]=c[b[S]].concat(y[b[S]])}}return l}(c,t),d="";Object.keys(l).filter(function(t){return"main"!==t}).forEach(function(t){for(var r=0;l[t][r];)r++;l[t].push(r),c[t][r]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",d=d+"var "+t+" = ("+webpackBootstrapFunc.toString().replace("ENTRY_MODULE",JSON.stringify(r))+")({"+l[t].map(function(r){return""+JSON.stringify(r)+": "+c[t][r].toString()}).join(",")+"});\n"}),d=d+"new (("+webpackBootstrapFunc.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+l.main.map(function(t){return""+JSON.stringify(t)+": "+c.main[t].toString()}).join(",")+"}))(self);";var f=new window.Blob([d],{type:"text/javascript"});if(r.bare)return f;var m=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(f),_=new window.Worker(m);return _.objectURL=m,_}},"./src/config.js":function(t,r,n){"use strict";n.r(r),n.d(r,{defaultConfig:function(){return o},createDefaultConfig:function(){return createDefaultConfig}});var o={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function createDefaultConfig(){return Object.assign({},o)}},"./src/core/features.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ../io/io-controller.js */"./src/io/io-controller.js"),a=n(/*! ../config.js */"./src/config.js"),c=function(){function Features(){}return Features.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},Features.supportNetworkStreamIO=function(){var t=new o.default({},(0,a.createDefaultConfig)()),r=t.loaderType;return t.destroy(),"fetch-stream-loader"==r||"xhr-moz-chunked-loader"==r},Features.getNetworkLoaderTypeName=function(){var t=new o.default({},(0,a.createDefaultConfig)()),r=t.loaderType;return t.destroy(),r},Features.supportNativeMediaPlayback=function(t){void 0==Features.videoElement&&(Features.videoElement=window.document.createElement("video"));var r=Features.videoElement.canPlayType(t);return"probably"===r||"maybe"==r},Features.getFeatureList=function(){var t={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.mseFlvPlayback=Features.supportMSEH264Playback(),t.networkStreamIO=Features.supportNetworkStreamIO(),t.networkLoaderName=Features.getNetworkLoaderTypeName(),t.mseLiveFlvPlayback=t.mseFlvPlayback&&t.networkStreamIO,t.nativeMP4H264Playback=Features.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeWebmVP8Playback=Features.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=Features.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},Features}();r.default=c},"./src/core/media-info.js":function(t,r,n){"use strict";n.r(r);var o=function(){function MediaInfo(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return MediaInfo.prototype.isComplete=function(){var t=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,r=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&null!=this.duration&&null!=this.metadata&&null!=this.hasKeyframesIndex&&t&&r},MediaInfo.prototype.isSeekable=function(){return!0===this.hasKeyframesIndex},MediaInfo.prototype.getNearestKeyframe=function(t){if(null==this.keyframesIndex)return null;var r=this.keyframesIndex,n=this._search(r.times,t);return{index:n,milliseconds:r.times[n],fileposition:r.filepositions[n]}},MediaInfo.prototype._search=function(t,r){var n=0,o=t.length-1,a=0,c=0,l=o;for(r<t[0]&&(n=0,c=l+1);c<=l;){if((a=c+Math.floor((l-c)/2))===o||r>=t[a]&&r<t[a+1]){n=a;break}t[a]<r?c=a+1:l=a-1}return n},MediaInfo}();r.default=o},"./src/core/media-segment-info.js":function(t,r,n){"use strict";n.r(r),n.d(r,{SampleInfo:function(){return SampleInfo},MediaSegmentInfo:function(){return o},IDRSampleList:function(){return a},MediaSegmentInfoList:function(){return c}});var SampleInfo=function(t,r,n,o,a){this.dts=t,this.pts=r,this.duration=n,this.originalDts=o,this.isSyncPoint=a,this.fileposition=null},o=function(){function MediaSegmentInfo(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return MediaSegmentInfo.prototype.appendSyncPoint=function(t){t.isSyncPoint=!0,this.syncPoints.push(t)},MediaSegmentInfo}(),a=function(){function IDRSampleList(){this._list=[]}return IDRSampleList.prototype.clear=function(){this._list=[]},IDRSampleList.prototype.appendArray=function(t){var r=this._list;0!==t.length&&(r.length>0&&t[0].originalDts<r[r.length-1].originalDts&&this.clear(),Array.prototype.push.apply(r,t))},IDRSampleList.prototype.getLastSyncPointBeforeDts=function(t){if(0==this._list.length)return null;var r=this._list,n=0,o=r.length-1,a=0,c=0,l=o;for(t<r[0].dts&&(n=0,c=l+1);c<=l;){if((a=c+Math.floor((l-c)/2))===o||t>=r[a].dts&&t<r[a+1].dts){n=a;break}r[a].dts<t?c=a+1:l=a-1}return this._list[n]},IDRSampleList}(),c=function(){function MediaSegmentInfoList(t){this._type=t,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(MediaSegmentInfoList.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(MediaSegmentInfoList.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),MediaSegmentInfoList.prototype.isEmpty=function(){return 0===this._list.length},MediaSegmentInfoList.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},MediaSegmentInfoList.prototype._searchNearestSegmentBefore=function(t){var r=this._list;if(0===r.length)return -2;var n=r.length-1,o=0,a=0,c=n,l=0;if(t<r[0].originalBeginDts)return -1;for(;a<=c;){if((o=a+Math.floor((c-a)/2))===n||t>r[o].lastSample.originalDts&&t<r[o+1].originalBeginDts){l=o;break}r[o].originalBeginDts<t?a=o+1:c=o-1}return l},MediaSegmentInfoList.prototype._searchNearestSegmentAfter=function(t){return this._searchNearestSegmentBefore(t)+1},MediaSegmentInfoList.prototype.append=function(t){var r=this._list,n=this._lastAppendLocation,o=0;-1!==n&&n<r.length&&t.originalBeginDts>=r[n].lastSample.originalDts&&(n===r.length-1||n<r.length-1&&t.originalBeginDts<r[n+1].originalBeginDts)?o=n+1:r.length>0&&(o=this._searchNearestSegmentBefore(t.originalBeginDts)+1),this._lastAppendLocation=o,this._list.splice(o,0,t)},MediaSegmentInfoList.prototype.getLastSegmentBefore=function(t){var r=this._searchNearestSegmentBefore(t);return r>=0?this._list[r]:null},MediaSegmentInfoList.prototype.getLastSampleBefore=function(t){var r=this.getLastSegmentBefore(t);return null!=r?r.lastSample:null},MediaSegmentInfoList.prototype.getLastSyncPointBefore=function(t){for(var r=this._searchNearestSegmentBefore(t),n=this._list[r].syncPoints;0===n.length&&r>0;)r--,n=this._list[r].syncPoints;return n.length>0?n[n.length-1]:null},MediaSegmentInfoList}()},"./src/core/mse-controller.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=n(/*! ../utils/logger.js */"./src/utils/logger.js"),l=n(/*! ../utils/browser.js */"./src/utils/browser.js"),d=n(/*! ./mse-events.js */"./src/core/mse-events.js"),f=n(/*! ./media-segment-info.js */"./src/core/media-segment-info.js"),m=n(/*! ../utils/exception.js */"./src/utils/exception.js"),_=function(){function MSEController(t){this.TAG="MSEController",this._config=t,this._emitter=new(a()),this._config.isLive&&void 0==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new f.IDRSampleList}return MSEController.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},MSEController.prototype.on=function(t,r){this._emitter.addListener(t,r)},MSEController.prototype.off=function(t,r){this._emitter.removeListener(t,r)},MSEController.prototype.attachMediaElement=function(t){if(this._mediaSource)throw new m.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var r=this._mediaSource=new window.MediaSource;r.addEventListener("sourceopen",this.e.onSourceOpen),r.addEventListener("sourceended",this.e.onSourceEnded),r.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=t,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),t.src=this._mediaSourceObjectURL},MSEController.prototype.detachMediaElement=function(){if(this._mediaSource){var t=this._mediaSource;for(var r in this._sourceBuffers){var n=this._pendingSegments[r];n.splice(0,n.length),this._pendingSegments[r]=null,this._pendingRemoveRanges[r]=null,this._lastInitSegments[r]=null;var o=this._sourceBuffers[r];if(o){if("closed"!==t.readyState){try{t.removeSourceBuffer(o)}catch(t){c.default.e(this.TAG,t.message)}o.removeEventListener("error",this.e.onSourceBufferError),o.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[r]=null,this._sourceBuffers[r]=null}}if("open"===t.readyState)try{t.endOfStream()}catch(t){c.default.e(this.TAG,t.message)}t.removeEventListener("sourceopen",this.e.onSourceOpen),t.removeEventListener("sourceended",this.e.onSourceEnded),t.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},MSEController.prototype.appendInitSegment=function(t,r){if(!this._mediaSource||"open"!==this._mediaSource.readyState){this._pendingSourceBufferInit.push(t),this._pendingSegments[t.type].push(t);return}var n=""+t.container;t.codec&&t.codec.length>0&&(n+=";codecs="+t.codec);var o=!1;if(c.default.v(this.TAG,"Received Initialization Segment, mimeType: "+n),this._lastInitSegments[t.type]=t,n!==this._mimeTypes[t.type]){if(this._mimeTypes[t.type])c.default.v(this.TAG,"Notice: "+t.type+" mimeType changed, origin: "+this._mimeTypes[t.type]+", target: "+n);else{o=!0;try{var a=this._sourceBuffers[t.type]=this._mediaSource.addSourceBuffer(n);a.addEventListener("error",this.e.onSourceBufferError),a.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(t){c.default.e(this.TAG,t.message),this._emitter.emit(d.default.ERROR,{code:t.code,msg:t.message});return}}this._mimeTypes[t.type]=n}r||this._pendingSegments[t.type].push(t),o||!this._sourceBuffers[t.type]||this._sourceBuffers[t.type].updating||this._doAppendSegments(),l.default.safari&&"audio/mpeg"===t.container&&t.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=t.mediaDuration/1e3,this._updateMediaSourceDuration())},MSEController.prototype.appendMediaSegment=function(t){this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var r=this._sourceBuffers[t.type];!r||r.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},MSEController.prototype.seek=function(t){for(var r in this._sourceBuffers)if(this._sourceBuffers[r]){var n=this._sourceBuffers[r];if("open"===this._mediaSource.readyState)try{n.abort()}catch(t){c.default.e(this.TAG,t.message)}this._idrList.clear();var o=this._pendingSegments[r];if(o.splice(0,o.length),"closed"!==this._mediaSource.readyState){for(var a=0;a<n.buffered.length;a++){var d=n.buffered.start(a),f=n.buffered.end(a);this._pendingRemoveRanges[r].push({start:d,end:f})}if(n.updating||this._doRemoveRanges(),l.default.safari){var m=this._lastInitSegments[r];m&&(this._pendingSegments[r].push(m),n.updating||this._doAppendSegments())}}}},MSEController.prototype.endOfStream=function(){var t=this._mediaSource,r=this._sourceBuffers;if(!t||"open"!==t.readyState){t&&"closed"===t.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}r.video&&r.video.updating||r.audio&&r.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,t.endOfStream())},MSEController.prototype.getNearestKeyframe=function(t){return this._idrList.getLastSyncPointBeforeDts(t)},MSEController.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var t=this._mediaElement.currentTime;for(var r in this._sourceBuffers){var n=this._sourceBuffers[r];if(n){var o=n.buffered;if(o.length>=1&&t-o.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},MSEController.prototype._doCleanupSourceBuffer=function(){var t=this._mediaElement.currentTime;for(var r in this._sourceBuffers){var n=this._sourceBuffers[r];if(n){for(var o=n.buffered,a=!1,c=0;c<o.length;c++){var l=o.start(c),d=o.end(c);if(l<=t&&t<d+3){if(t-l>=this._config.autoCleanupMaxBackwardDuration){a=!0;var f=t-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[r].push({start:l,end:f})}}else d<t&&(a=!0,this._pendingRemoveRanges[r].push({start:l,end:d}))}a&&!n.updating&&this._doRemoveRanges()}}},MSEController.prototype._updateMediaSourceDuration=function(){var t=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&(!t.video||!t.video.updating)&&(!t.audio||!t.audio.updating)){var r=this._mediaSource.duration,n=this._pendingMediaDuration;n>0&&(isNaN(r)||n>r)&&(c.default.v(this.TAG,"Update MediaSource duration from "+r+" to "+n),this._mediaSource.duration=n),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},MSEController.prototype._doRemoveRanges=function(){for(var t in this._pendingRemoveRanges)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating)for(var r=this._sourceBuffers[t],n=this._pendingRemoveRanges[t];n.length&&!r.updating;){var o=n.shift();r.remove(o.start,o.end)}},MSEController.prototype._doAppendSegments=function(){var t=this._pendingSegments;for(var r in t)if(this._sourceBuffers[r]&&!this._sourceBuffers[r].updating&&t[r].length>0){var n=t[r].shift();if(n.timestampOffset){var o=this._sourceBuffers[r].timestampOffset,a=n.timestampOffset/1e3;Math.abs(o-a)>.1&&(c.default.v(this.TAG,"Update MPEG audio timestampOffset from "+o+" to "+a),this._sourceBuffers[r].timestampOffset=a),delete n.timestampOffset}if(!n.data||0===n.data.byteLength)continue;try{this._sourceBuffers[r].appendBuffer(n.data),this._isBufferFull=!1,"video"===r&&n.hasOwnProperty("info")&&this._idrList.appendArray(n.info.syncPoints)}catch(t){this._pendingSegments[r].unshift(n),22===t.code?(this._isBufferFull||this._emitter.emit(d.default.BUFFER_FULL),this._isBufferFull=!0):(c.default.e(this.TAG,t.message),this._emitter.emit(d.default.ERROR,{code:t.code,msg:t.message}))}}},MSEController.prototype._onSourceOpen=function(){if(c.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var t=this._pendingSourceBufferInit;t.length;){var r=t.shift();this.appendInitSegment(r,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(d.default.SOURCE_OPEN)},MSEController.prototype._onSourceEnded=function(){c.default.v(this.TAG,"MediaSource onSourceEnded")},MSEController.prototype._onSourceClose=function(){c.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},MSEController.prototype._hasPendingSegments=function(){var t=this._pendingSegments;return t.video.length>0||t.audio.length>0},MSEController.prototype._hasPendingRemoveRanges=function(){var t=this._pendingRemoveRanges;return t.video.length>0||t.audio.length>0},MSEController.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(d.default.UPDATE_END)},MSEController.prototype._onSourceBufferError=function(t){c.default.e(this.TAG,"SourceBuffer Error: "+t)},MSEController}();r.default=_},"./src/core/mse-events.js":function(t,r,n){"use strict";n.r(r),r.default={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"}},"./src/core/transmuxer.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=n(/*! webworkify-webpack */"./node_modules/webworkify-webpack/index.js"),l=n.n(c),d=n(/*! ../utils/logger.js */"./src/utils/logger.js"),f=n(/*! ../utils/logging-control.js */"./src/utils/logging-control.js"),m=n(/*! ./transmuxing-controller.js */"./src/core/transmuxing-controller.js"),_=n(/*! ./transmuxing-events.js */"./src/core/transmuxing-events.js"),g=n(/*! ./media-info.js */"./src/core/media-info.js"),y=function(){function Transmuxer(t,r){if(this.TAG="Transmuxer",this._emitter=new(a()),r.enableWorker&&"undefined"!=typeof Worker)try{this._worker=l()(/*! ./transmuxing-worker */"./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[t,r]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},f.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:f.default.getConfig()})}catch(n){d.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new m.default(t,r)}else this._controller=new m.default(t,r);if(this._controller){var n=this._controller;n.on(_.default.IO_ERROR,this._onIOError.bind(this)),n.on(_.default.DEMUX_ERROR,this._onDemuxError.bind(this)),n.on(_.default.INIT_SEGMENT,this._onInitSegment.bind(this)),n.on(_.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),n.on(_.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),n.on(_.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),n.on(_.default.MEDIA_INFO,this._onMediaInfo.bind(this)),n.on(_.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),n.on(_.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),n.on(_.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),n.on(_.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return Transmuxer.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),f.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},Transmuxer.prototype.on=function(t,r){this._emitter.addListener(t,r)},Transmuxer.prototype.off=function(t,r){this._emitter.removeListener(t,r)},Transmuxer.prototype.hasWorker=function(){return null!=this._worker},Transmuxer.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},Transmuxer.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},Transmuxer.prototype.seek=function(t){this._worker?this._worker.postMessage({cmd:"seek",param:t}):this._controller.seek(t)},Transmuxer.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},Transmuxer.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},Transmuxer.prototype._onInitSegment=function(t,r){var n=this;Promise.resolve().then(function(){n._emitter.emit(_.default.INIT_SEGMENT,t,r)})},Transmuxer.prototype._onMediaSegment=function(t,r){var n=this;Promise.resolve().then(function(){n._emitter.emit(_.default.MEDIA_SEGMENT,t,r)})},Transmuxer.prototype._onLoadingComplete=function(){var t=this;Promise.resolve().then(function(){t._emitter.emit(_.default.LOADING_COMPLETE)})},Transmuxer.prototype._onRecoveredEarlyEof=function(){var t=this;Promise.resolve().then(function(){t._emitter.emit(_.default.RECOVERED_EARLY_EOF)})},Transmuxer.prototype._onMediaInfo=function(t){var r=this;Promise.resolve().then(function(){r._emitter.emit(_.default.MEDIA_INFO,t)})},Transmuxer.prototype._onMetaDataArrived=function(t){var r=this;Promise.resolve().then(function(){r._emitter.emit(_.default.METADATA_ARRIVED,t)})},Transmuxer.prototype._onScriptDataArrived=function(t){var r=this;Promise.resolve().then(function(){r._emitter.emit(_.default.SCRIPTDATA_ARRIVED,t)})},Transmuxer.prototype._onStatisticsInfo=function(t){var r=this;Promise.resolve().then(function(){r._emitter.emit(_.default.STATISTICS_INFO,t)})},Transmuxer.prototype._onIOError=function(t,r){var n=this;Promise.resolve().then(function(){n._emitter.emit(_.default.IO_ERROR,t,r)})},Transmuxer.prototype._onDemuxError=function(t,r){var n=this;Promise.resolve().then(function(){n._emitter.emit(_.default.DEMUX_ERROR,t,r)})},Transmuxer.prototype._onRecommendSeekpoint=function(t){var r=this;Promise.resolve().then(function(){r._emitter.emit(_.default.RECOMMEND_SEEKPOINT,t)})},Transmuxer.prototype._onLoggingConfigChanged=function(t){this._worker&&this._worker.postMessage({cmd:"logging_config",param:t})},Transmuxer.prototype._onWorkerMessage=function(t){var r=t.data,n=r.data;if("destroyed"===r.msg||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(r.msg){case _.default.INIT_SEGMENT:case _.default.MEDIA_SEGMENT:this._emitter.emit(r.msg,n.type,n.data);break;case _.default.LOADING_COMPLETE:case _.default.RECOVERED_EARLY_EOF:this._emitter.emit(r.msg);break;case _.default.MEDIA_INFO:Object.setPrototypeOf(n,g.default.prototype),this._emitter.emit(r.msg,n);break;case _.default.METADATA_ARRIVED:case _.default.SCRIPTDATA_ARRIVED:case _.default.STATISTICS_INFO:this._emitter.emit(r.msg,n);break;case _.default.IO_ERROR:case _.default.DEMUX_ERROR:this._emitter.emit(r.msg,n.type,n.info);break;case _.default.RECOMMEND_SEEKPOINT:this._emitter.emit(r.msg,n);break;case"logcat_callback":d.default.emitter.emit("log",n.type,n.logcat)}},Transmuxer}();r.default=y},"./src/core/transmuxing-controller.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=n(/*! ../utils/logger.js */"./src/utils/logger.js"),l=n(/*! ../utils/browser.js */"./src/utils/browser.js"),d=n(/*! ./media-info.js */"./src/core/media-info.js"),f=n(/*! ../demux/flv-demuxer.js */"./src/demux/flv-demuxer.js"),m=n(/*! ../remux/mp4-remuxer.js */"./src/remux/mp4-remuxer.js"),_=n(/*! ../demux/demux-errors.js */"./src/demux/demux-errors.js"),g=n(/*! ../io/io-controller.js */"./src/io/io-controller.js"),y=n(/*! ./transmuxing-events.js */"./src/core/transmuxing-events.js"),b=function(){function TransmuxingController(t,r){this.TAG="TransmuxingController",this._emitter=new(a()),this._config=r,t.segments||(t.segments=[{duration:t.duration,filesize:t.filesize,url:t.url}]),"boolean"!=typeof t.cors&&(t.cors=!0),"boolean"!=typeof t.withCredentials&&(t.withCredentials=!1),this._mediaDataSource=t,this._currentSegmentIndex=0;var n=0;this._mediaDataSource.segments.forEach(function(o){o.timestampBase=n,n+=o.duration,o.cors=t.cors,o.withCredentials=t.withCredentials,r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy)}),isNaN(n)||this._mediaDataSource.duration===n||(this._mediaDataSource.duration=n),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return TransmuxingController.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},TransmuxingController.prototype.on=function(t,r){this._emitter.addListener(t,r)},TransmuxingController.prototype.off=function(t,r){this._emitter.removeListener(t,r)},TransmuxingController.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},TransmuxingController.prototype._loadSegment=function(t,r){this._currentSegmentIndex=t;var n=this._mediaDataSource.segments[t],o=this._ioctl=new g.default(n,this._config,t);o.onError=this._onIOException.bind(this),o.onSeeked=this._onIOSeeked.bind(this),o.onComplete=this._onIOComplete.bind(this),o.onRedirect=this._onIORedirect.bind(this),o.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),r?this._demuxer.bindDataSource(this._ioctl):o.onDataArrival=this._onInitChunkArrival.bind(this),o.open(r)},TransmuxingController.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},TransmuxingController.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},TransmuxingController.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},TransmuxingController.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},TransmuxingController.prototype.seek=function(t){if(null!=this._mediaInfo&&this._mediaInfo.isSeekable()){var r=this._searchSegmentIndexContains(t);if(r===this._currentSegmentIndex){var n=this._mediaInfo.segments[r];if(void 0==n)this._pendingSeekTime=t;else{var o=n.getNearestKeyframe(t);this._remuxer.seek(o.milliseconds),this._ioctl.seek(o.fileposition),this._pendingResolveSeekPoint=o.milliseconds}}else{var a=this._mediaInfo.segments[r];if(void 0==a)this._pendingSeekTime=t,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(r);else{var o=a.getNearestKeyframe(t);this._internalAbort(),this._remuxer.seek(t),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[r].timestampBase,this._loadSegment(r,o.fileposition),this._pendingResolveSeekPoint=o.milliseconds,this._reportSegmentMediaInfo(r)}}this._enableStatisticsReporter()}},TransmuxingController.prototype._searchSegmentIndexContains=function(t){for(var r=this._mediaDataSource.segments,n=r.length-1,o=0;o<r.length;o++)if(t<r[o].timestampBase){n=o-1;break}return n},TransmuxingController.prototype._onInitChunkArrival=function(t,r){var n=this,o=null,a=0;if(r>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,a=this._demuxer.parseChunks(t,r);else if((o=f.default.probe(t)).match){this._demuxer=new f.default(o,this._config),this._remuxer||(this._remuxer=new m.default(this._config));var l=this._mediaDataSource;void 0==l.duration||isNaN(l.duration)||(this._demuxer.overridedDuration=l.duration),"boolean"==typeof l.hasAudio&&(this._demuxer.overridedHasAudio=l.hasAudio),"boolean"==typeof l.hasVideo&&(this._demuxer.overridedHasVideo=l.hasVideo),this._demuxer.timestampBase=l.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),a=this._demuxer.parseChunks(t,r)}else o=null,c.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){n._internalAbort()}),this._emitter.emit(y.default.DEMUX_ERROR,_.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),a=0;return a},TransmuxingController.prototype._onMediaInfo=function(t){var r=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},t),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,d.default.prototype));var n=Object.assign({},t);Object.setPrototypeOf(n,d.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=n,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then(function(){var t=r._pendingSeekTime;r._pendingSeekTime=null,r.seek(t)})},TransmuxingController.prototype._onMetaDataArrived=function(t){this._emitter.emit(y.default.METADATA_ARRIVED,t)},TransmuxingController.prototype._onScriptDataArrived=function(t){this._emitter.emit(y.default.SCRIPTDATA_ARRIVED,t)},TransmuxingController.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},TransmuxingController.prototype._onIOComplete=function(t){var r=t+1;r<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(r)):(this._remuxer.flushStashedSamples(),this._emitter.emit(y.default.LOADING_COMPLETE),this._disableStatisticsReporter())},TransmuxingController.prototype._onIORedirect=function(t){var r=this._ioctl.extraData;this._mediaDataSource.segments[r].redirectedURL=t},TransmuxingController.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(y.default.RECOVERED_EARLY_EOF)},TransmuxingController.prototype._onIOException=function(t,r){c.default.e(this.TAG,"IOException: type = "+t+", code = "+r.code+", msg = "+r.msg),this._emitter.emit(y.default.IO_ERROR,t,r),this._disableStatisticsReporter()},TransmuxingController.prototype._onDemuxException=function(t,r){c.default.e(this.TAG,"DemuxException: type = "+t+", info = "+r),this._emitter.emit(y.default.DEMUX_ERROR,t,r)},TransmuxingController.prototype._onRemuxerInitSegmentArrival=function(t,r){this._emitter.emit(y.default.INIT_SEGMENT,t,r)},TransmuxingController.prototype._onRemuxerMediaSegmentArrival=function(t,r){if(null==this._pendingSeekTime&&(this._emitter.emit(y.default.MEDIA_SEGMENT,t,r),null!=this._pendingResolveSeekPoint&&"video"===t)){var n=r.info.syncPoints,o=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,l.default.safari&&n.length>0&&n[0].originalDts===o&&(o=n[0].pts),this._emitter.emit(y.default.RECOMMEND_SEEKPOINT,o)}},TransmuxingController.prototype._enableStatisticsReporter=function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},TransmuxingController.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},TransmuxingController.prototype._reportSegmentMediaInfo=function(t){var r=Object.assign({},this._mediaInfo.segments[t]);r.duration=this._mediaInfo.duration,r.segmentCount=this._mediaInfo.segmentCount,delete r.segments,delete r.keyframesIndex,this._emitter.emit(y.default.MEDIA_INFO,r)},TransmuxingController.prototype._reportStatisticsInfo=function(){var t={};t.url=this._ioctl.currentURL,t.hasRedirect=this._ioctl.hasRedirect,t.hasRedirect&&(t.redirectedURL=this._ioctl.currentRedirectedURL),t.speed=this._ioctl.currentSpeed,t.loaderType=this._ioctl.loaderType,t.currentSegmentIndex=this._currentSegmentIndex,t.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(y.default.STATISTICS_INFO,t)},TransmuxingController}();r.default=b},"./src/core/transmuxing-events.js":function(t,r,n){"use strict";n.r(r),r.default={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},"./src/core/transmuxing-worker.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ../utils/logging-control.js */"./src/utils/logging-control.js"),a=n(/*! ../utils/polyfill.js */"./src/utils/polyfill.js"),c=n(/*! ./transmuxing-controller.js */"./src/core/transmuxing-controller.js"),l=n(/*! ./transmuxing-events.js */"./src/core/transmuxing-events.js");r.default=function(t){var r=null,n=(function(r,n){t.postMessage({msg:"logcat_callback",data:{type:r,logcat:n}})}).bind(this);function onInitSegment(r,n){var o={msg:l.default.INIT_SEGMENT,data:{type:r,data:n}};t.postMessage(o,[n.data])}function onMediaSegment(r,n){var o={msg:l.default.MEDIA_SEGMENT,data:{type:r,data:n}};t.postMessage(o,[n.data])}function onLoadingComplete(){var r={msg:l.default.LOADING_COMPLETE};t.postMessage(r)}function onRecoveredEarlyEof(){var r={msg:l.default.RECOVERED_EARLY_EOF};t.postMessage(r)}function onMediaInfo(r){var n={msg:l.default.MEDIA_INFO,data:r};t.postMessage(n)}function onMetaDataArrived(r){var n={msg:l.default.METADATA_ARRIVED,data:r};t.postMessage(n)}function onScriptDataArrived(r){var n={msg:l.default.SCRIPTDATA_ARRIVED,data:r};t.postMessage(n)}function onStatisticsInfo(r){var n={msg:l.default.STATISTICS_INFO,data:r};t.postMessage(n)}function onIOError(r,n){t.postMessage({msg:l.default.IO_ERROR,data:{type:r,info:n}})}function onDemuxError(r,n){t.postMessage({msg:l.default.DEMUX_ERROR,data:{type:r,info:n}})}function onRecommendSeekpoint(r){t.postMessage({msg:l.default.RECOMMEND_SEEKPOINT,data:r})}a.default.install(),t.addEventListener("message",function(a){switch(a.data.cmd){case"init":(r=new c.default(a.data.param[0],a.data.param[1])).on(l.default.IO_ERROR,onIOError.bind(this)),r.on(l.default.DEMUX_ERROR,onDemuxError.bind(this)),r.on(l.default.INIT_SEGMENT,onInitSegment.bind(this)),r.on(l.default.MEDIA_SEGMENT,onMediaSegment.bind(this)),r.on(l.default.LOADING_COMPLETE,onLoadingComplete.bind(this)),r.on(l.default.RECOVERED_EARLY_EOF,onRecoveredEarlyEof.bind(this)),r.on(l.default.MEDIA_INFO,onMediaInfo.bind(this)),r.on(l.default.METADATA_ARRIVED,onMetaDataArrived.bind(this)),r.on(l.default.SCRIPTDATA_ARRIVED,onScriptDataArrived.bind(this)),r.on(l.default.STATISTICS_INFO,onStatisticsInfo.bind(this)),r.on(l.default.RECOMMEND_SEEKPOINT,onRecommendSeekpoint.bind(this));break;case"destroy":r&&(r.destroy(),r=null),t.postMessage({msg:"destroyed"});break;case"start":r.start();break;case"stop":r.stop();break;case"seek":r.seek(a.data.param);break;case"pause":r.pause();break;case"resume":r.resume();break;case"logging_config":var d=a.data.param;o.default.applyConfig(d),!0===d.enableCallback?o.default.addLogListener(n):o.default.removeLogListener(n)}})}},"./src/demux/amf-parser.js":function(t,r,n){"use strict";n.r(r);var o,a=n(/*! ../utils/logger.js */"./src/utils/logger.js"),c=n(/*! ../utils/utf8-conv.js */"./src/utils/utf8-conv.js"),l=n(/*! ../utils/exception.js */"./src/utils/exception.js"),d=(o=new ArrayBuffer(2),new DataView(o).setInt16(0,256,!0),256===new Int16Array(o)[0]),f=function(){function AMF(){}return AMF.parseScriptData=function(t,r,n){var o={};try{var c=AMF.parseValue(t,r,n),l=AMF.parseValue(t,r+c.size,n-c.size);o[c.data]=l.data}catch(t){a.default.e("AMF",t.toString())}return o},AMF.parseObject=function(t,r,n){if(n<3)throw new l.IllegalStateException("Data not enough when parse ScriptDataObject");var o=AMF.parseString(t,r,n),a=AMF.parseValue(t,r+o.size,n-o.size),c=a.objectEnd;return{data:{name:o.data,value:a.data},size:o.size+a.size,objectEnd:c}},AMF.parseVariable=function(t,r,n){return AMF.parseObject(t,r,n)},AMF.parseString=function(t,r,n){if(n<2)throw new l.IllegalStateException("Data not enough when parse String");var o=new DataView(t,r,n).getUint16(0,!d);return{data:o>0?(0,c.default)(new Uint8Array(t,r+2,o)):"",size:2+o}},AMF.parseLongString=function(t,r,n){if(n<4)throw new l.IllegalStateException("Data not enough when parse LongString");var o=new DataView(t,r,n).getUint32(0,!d);return{data:o>0?(0,c.default)(new Uint8Array(t,r+4,o)):"",size:4+o}},AMF.parseDate=function(t,r,n){if(n<10)throw new l.IllegalStateException("Data size invalid when parse Date");var o=new DataView(t,r,n),a=o.getFloat64(0,!d);return a+=6e4*o.getInt16(8,!d),{data:new Date(a),size:10}},AMF.parseValue=function(t,r,n){if(n<1)throw new l.IllegalStateException("Data not enough when parse Value");var o,c=new DataView(t,r,n),f=1,m=c.getUint8(0),_=!1;try{switch(m){case 0:o=c.getFloat64(1,!d),f+=8;break;case 1:o=!!c.getUint8(1),f+=1;break;case 2:var g=AMF.parseString(t,r+1,n-1);o=g.data,f+=g.size;break;case 3:o={};var y=0;for((16777215&c.getUint32(n-4,!d))==9&&(y=3);f<n-4;){var b=AMF.parseObject(t,r+f,n-f-y);if(b.objectEnd)break;o[b.data.name]=b.data.value,f+=b.size}if(f<=n-3){var S=16777215&c.getUint32(f-1,!d);9===S&&(f+=3)}break;case 8:o={},f+=4;var y=0;for((16777215&c.getUint32(n-4,!d))==9&&(y=3);f<n-8;){var E=AMF.parseVariable(t,r+f,n-f-y);if(E.objectEnd)break;o[E.data.name]=E.data.value,f+=E.size}if(f<=n-3){var S=16777215&c.getUint32(f-1,!d);9===S&&(f+=3)}break;case 9:o=void 0,f=1,_=!0;break;case 10:o=[];var w=c.getUint32(1,!d);f+=4;for(var T=0;T<w;T++){var O=AMF.parseValue(t,r+f,n-f);o.push(O.data),f+=O.size}break;case 11:var R=AMF.parseDate(t,r+1,n-1);o=R.data,f+=R.size;break;case 12:var x=AMF.parseString(t,r+1,n-1);o=x.data,f+=x.size;break;default:f=n,a.default.w("AMF","Unsupported AMF value type "+m)}}catch(t){a.default.e("AMF",t.toString())}return{data:o,size:f,objectEnd:_}},AMF}();r.default=f},"./src/demux/demux-errors.js":function(t,r,n){"use strict";n.r(r),r.default={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},"./src/demux/exp-golomb.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ../utils/exception.js */"./src/utils/exception.js"),a=function(){function ExpGolomb(t){this.TAG="ExpGolomb",this._buffer=t,this._buffer_index=0,this._total_bytes=t.byteLength,this._total_bits=8*t.byteLength,this._current_word=0,this._current_word_bits_left=0}return ExpGolomb.prototype.destroy=function(){this._buffer=null},ExpGolomb.prototype._fillCurrentWord=function(){var t=this._total_bytes-this._buffer_index;if(t<=0)throw new o.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var r=Math.min(4,t),n=new Uint8Array(4);n.set(this._buffer.subarray(this._buffer_index,this._buffer_index+r)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=r,this._current_word_bits_left=8*r},ExpGolomb.prototype.readBits=function(t){if(t>32)throw new o.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(t<=this._current_word_bits_left){var r=this._current_word>>>32-t;return this._current_word<<=t,this._current_word_bits_left-=t,r}var n=this._current_word_bits_left?this._current_word:0;n>>>=32-this._current_word_bits_left;var a=t-this._current_word_bits_left;this._fillCurrentWord();var c=Math.min(a,this._current_word_bits_left),l=this._current_word>>>32-c;return this._current_word<<=c,this._current_word_bits_left-=c,n=n<<c|l},ExpGolomb.prototype.readBool=function(){return 1===this.readBits(1)},ExpGolomb.prototype.readByte=function(){return this.readBits(8)},ExpGolomb.prototype._skipLeadingZero=function(){var t;for(t=0;t<this._current_word_bits_left;t++)if(0!=(this._current_word&2147483648>>>t))return this._current_word<<=t,this._current_word_bits_left-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()},ExpGolomb.prototype.readUEG=function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1},ExpGolomb.prototype.readSEG=function(){var t=this.readUEG();return 1&t?t+1>>>1:-1*(t>>>1)},ExpGolomb}();r.default=a},"./src/demux/flv-demuxer.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ../utils/logger.js */"./src/utils/logger.js"),a=n(/*! ./amf-parser.js */"./src/demux/amf-parser.js"),c=n(/*! ./sps-parser.js */"./src/demux/sps-parser.js"),l=n(/*! ./demux-errors.js */"./src/demux/demux-errors.js"),d=n(/*! ../core/media-info.js */"./src/core/media-info.js"),f=n(/*! ../utils/exception.js */"./src/utils/exception.js"),m=function(){function FLVDemuxer(t,r){var n;this.TAG="FLVDemuxer",this._config=r,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=t.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=t.hasAudioTrack,this._hasVideo=t.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new d.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=(n=new ArrayBuffer(2),new DataView(n).setInt16(0,256,!0),256===new Int16Array(n)[0])}return FLVDemuxer.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},FLVDemuxer.probe=function(t){var r=new Uint8Array(t),n={match:!1};if(70!==r[0]||76!==r[1]||86!==r[2]||1!==r[3])return n;var o=(4&r[4])>>>2!=0,a=(1&r[4])!=0,c=r[5]<<24|r[6]<<16|r[7]<<8|r[8];return c<9?n:{match:!0,consumed:c,dataOffset:c,hasAudioTrack:o,hasVideoTrack:a}},FLVDemuxer.prototype.bindDataSource=function(t){return t.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(FLVDemuxer.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(t){this._onTrackMetadata=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(t){this._onMediaInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(t){this._onMetaDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(t){this._onScriptDataArrived=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(t){this._onDataAvailable=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(t){this._timestampBase=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"overridedDuration",{get:function(){return this._duration},set:function(t){this._durationOverrided=!0,this._duration=t,this._mediaInfo.duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"overridedHasAudio",{set:function(t){this._hasAudioFlagOverrided=!0,this._hasAudio=t,this._mediaInfo.hasAudio=t},enumerable:!1,configurable:!0}),Object.defineProperty(FLVDemuxer.prototype,"overridedHasVideo",{set:function(t){this._hasVideoFlagOverrided=!0,this._hasVideo=t,this._mediaInfo.hasVideo=t},enumerable:!1,configurable:!0}),FLVDemuxer.prototype.resetMediaInfo=function(){this._mediaInfo=new d.default},FLVDemuxer.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&!!this._hasVideo&&this._videoInitialMetadataDispatched},FLVDemuxer.prototype.parseChunks=function(t,r){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new f.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var n=0,a=this._littleEndian;if(0===r){if(!(t.byteLength>13))return 0;n=FLVDemuxer.probe(t).dataOffset}if(this._firstParse){this._firstParse=!1,r+n!==this._dataOffset&&o.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var c=new DataView(t,n);0!==c.getUint32(0,!a)&&o.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),n+=4}for(;n<t.byteLength;){this._dispatch=!0;var c=new DataView(t,n);if(n+11+4>t.byteLength)break;var l=c.getUint8(0),d=16777215&c.getUint32(0,!a);if(n+11+d+4>t.byteLength)break;if(8!==l&&9!==l&&18!==l){o.default.w(this.TAG,"Unsupported tag type "+l+", skipped"),n+=11+d+4;continue}var m=c.getUint8(4),_=c.getUint8(5),g=c.getUint8(6)|_<<8|m<<16|c.getUint8(7)<<24;0!=(16777215&c.getUint32(7,!a))&&o.default.w(this.TAG,"Meet tag which has StreamID != 0!");var y=n+11;switch(l){case 8:this._parseAudioData(t,y,d,g);break;case 9:this._parseVideoData(t,y,d,g,r+n);break;case 18:this._parseScriptData(t,y,d)}var b=c.getUint32(11+d,!a);b!==11+d&&o.default.w(this.TAG,"Invalid PrevTagSize "+b),n+=11+d+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),n},FLVDemuxer.prototype._parseScriptData=function(t,r,n){var c=a.default.parseScriptData(t,r,n);if(c.hasOwnProperty("onMetaData")){if(null==c.onMetaData||"object"!=typeof c.onMetaData){o.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&o.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=c;var l=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},l)),"boolean"==typeof l.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=l.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof l.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=l.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof l.audiodatarate&&(this._mediaInfo.audioDataRate=l.audiodatarate),"number"==typeof l.videodatarate&&(this._mediaInfo.videoDataRate=l.videodatarate),"number"==typeof l.width&&(this._mediaInfo.width=l.width),"number"==typeof l.height&&(this._mediaInfo.height=l.height),"number"==typeof l.duration){if(!this._durationOverrided){var d=Math.floor(l.duration*this._timescale);this._duration=d,this._mediaInfo.duration=d}}else this._mediaInfo.duration=0;if("number"==typeof l.framerate){var f=Math.floor(1e3*l.framerate);if(f>0){var m=f/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=m,this._referenceFrameRate.fps_num=f,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=m}}if("object"==typeof l.keyframes){this._mediaInfo.hasKeyframesIndex=!0;var _=l.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(_),l.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=l,o.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(c).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},c))},FLVDemuxer.prototype._parseKeyframesIndex=function(t){for(var r=[],n=[],o=1;o<t.times.length;o++){var a=this._timestampBase+Math.floor(1e3*t.times[o]);r.push(a),n.push(t.filepositions[o])}return{times:r,filepositions:n}},FLVDemuxer.prototype._parseAudioData=function(t,r,n,a){if(n<=1){o.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var c=new DataView(t,r,n).getUint8(0),d=c>>>4;if(2!==d&&10!==d){this._onError(l.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+d);return}var f=0,m=(12&c)>>>2;if(m>=0&&m<=4)f=this._flvSoundRateTable[m];else{this._onError(l.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+m);return}var _=this._audioMetadata,g=this._audioTrack;if(_||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(_=this._audioMetadata={}).type="audio",_.id=g.id,_.timescale=this._timescale,_.duration=this._duration,_.audioSampleRate=f,_.channelCount=0==(1&c)?1:2),10===d){var y=this._parseAACAudioData(t,r+1,n-1);if(void 0==y)return;if(0===y.packetType){_.config&&o.default.w(this.TAG,"Found another AudioSpecificConfig!");var b=y.data;_.audioSampleRate=b.samplingRate,_.channelCount=b.channelCount,_.codec=b.codec,_.originalCodec=b.originalCodec,_.config=b.config,_.refSampleDuration=1024/_.audioSampleRate*_.timescale,o.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",_);var S=this._mediaInfo;S.audioCodec=_.originalCodec,S.audioSampleRate=_.audioSampleRate,S.audioChannelCount=_.channelCount,S.hasVideo?null!=S.videoCodec&&(S.mimeType='video/x-flv; codecs="'+S.videoCodec+","+S.audioCodec+'"'):S.mimeType='video/x-flv; codecs="'+S.audioCodec+'"',S.isComplete()&&this._onMediaInfo(S)}else if(1===y.packetType){var E=this._timestampBase+a,w={unit:y.data,length:y.data.byteLength,dts:E,pts:E};g.samples.push(w),g.length+=y.data.length}else o.default.e(this.TAG,"Flv: Unsupported AAC data type "+y.packetType)}else if(2===d){if(!_.codec){var b=this._parseMP3AudioData(t,r+1,n-1,!0);if(void 0==b)return;_.audioSampleRate=b.samplingRate,_.channelCount=b.channelCount,_.codec=b.codec,_.originalCodec=b.originalCodec,_.refSampleDuration=1152/_.audioSampleRate*_.timescale,o.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",_);var S=this._mediaInfo;S.audioCodec=_.codec,S.audioSampleRate=_.audioSampleRate,S.audioChannelCount=_.channelCount,S.audioDataRate=b.bitRate,S.hasVideo?null!=S.videoCodec&&(S.mimeType='video/x-flv; codecs="'+S.videoCodec+","+S.audioCodec+'"'):S.mimeType='video/x-flv; codecs="'+S.audioCodec+'"',S.isComplete()&&this._onMediaInfo(S)}var T=this._parseMP3AudioData(t,r+1,n-1,!1);if(void 0==T)return;var E=this._timestampBase+a,O={unit:T,length:T.byteLength,dts:E,pts:E};g.samples.push(O),g.length+=T.length}}},FLVDemuxer.prototype._parseAACAudioData=function(t,r,n){if(n<=1){o.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var a={},c=new Uint8Array(t,r,n);return a.packetType=c[0],0===c[0]?a.data=this._parseAACAudioSpecificConfig(t,r+1,n-1):a.data=c.subarray(1),a},FLVDemuxer.prototype._parseAACAudioSpecificConfig=function(t,r,n){var o=new Uint8Array(t,r,n),a=null,c=0,d=0,f=0,m=null;if(c=d=o[0]>>>3,(f=(7&o[0])<<1|o[1]>>>7)<0||f>=this._mpegSamplingRates.length){this._onError(l.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var _=this._mpegSamplingRates[f],g=(120&o[1])>>>3;if(g<0||g>=8){this._onError(l.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}5===c&&(m=(7&o[1])<<1|o[2]>>>7,o[2]);var y=self.navigator.userAgent.toLowerCase();return -1!==y.indexOf("firefox")?f>=6?(c=5,a=[,,,,],m=f-3):(c=2,a=[,,],m=f):-1!==y.indexOf("android")?(c=2,a=[,,],m=f):(c=5,m=f,a=[,,,,],f>=6?m=f-3:1===g&&(c=2,a=[,,],m=f)),a[0]=c<<3,a[0]|=(15&f)>>>1,a[1]=(15&f)<<7,a[1]|=(15&g)<<3,5===c&&(a[1]|=(15&m)>>>1,a[2]=(1&m)<<7,a[2]|=8,a[3]=0),{config:a,samplingRate:_,channelCount:g,codec:"mp4a.40."+c,originalCodec:"mp4a.40."+d}},FLVDemuxer.prototype._parseMP3AudioData=function(t,r,n,a){if(n<4){o.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var c=new Uint8Array(t,r,n),l=null;if(a){if(255!==c[0])return;var d=c[1]>>>3&3,f=(6&c[1])>>1,m=(240&c[2])>>>4,_=(12&c[2])>>>2,g=c[3]>>>6&3,y=0,b=0;switch(d){case 0:y=this._mpegAudioV25SampleRateTable[_];break;case 2:y=this._mpegAudioV20SampleRateTable[_];break;case 3:y=this._mpegAudioV10SampleRateTable[_]}switch(f){case 1:m<this._mpegAudioL3BitRateTable.length&&(b=this._mpegAudioL3BitRateTable[m]);break;case 2:m<this._mpegAudioL2BitRateTable.length&&(b=this._mpegAudioL2BitRateTable[m]);break;case 3:m<this._mpegAudioL1BitRateTable.length&&(b=this._mpegAudioL1BitRateTable[m])}l={bitRate:b,samplingRate:y,channelCount:3!==g?2:1,codec:"mp3",originalCodec:"mp3"}}else l=c;return l},FLVDemuxer.prototype._parseVideoData=function(t,r,n,a,c){if(n<=1){o.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var d=new Uint8Array(t,r,n)[0],f=15&d;if(7!==f){this._onError(l.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+f);return}this._parseAVCVideoPacket(t,r+1,n-1,a,c,(240&d)>>>4)}},FLVDemuxer.prototype._parseAVCVideoPacket=function(t,r,n,a,c,d){if(n<4){o.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var f=this._littleEndian,m=new DataView(t,r,n),_=m.getUint8(0),g=16777215&m.getUint32(0,!f);if(0===_)this._parseAVCDecoderConfigurationRecord(t,r+4,n-4);else if(1===_)this._parseAVCVideoData(t,r+4,n-4,a,c,d,g<<8>>8);else if(2===_);else{this._onError(l.default.FORMAT_ERROR,"Flv: Invalid video packet type "+_);return}},FLVDemuxer.prototype._parseAVCDecoderConfigurationRecord=function(t,r,n){if(n<7){o.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var a=this._videoMetadata,d=this._videoTrack,f=this._littleEndian,m=new DataView(t,r,n);a?void 0!==a.avcc&&o.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(a=this._videoMetadata={}).type="video",a.id=d.id,a.timescale=this._timescale,a.duration=this._duration);var _=m.getUint8(0),g=m.getUint8(1);if(m.getUint8(2),m.getUint8(3),1!==_||0===g){this._onError(l.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(3&m.getUint8(4))+1,3!==this._naluLengthSize&&4!==this._naluLengthSize){this._onError(l.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var y=31&m.getUint8(5);if(0===y){this._onError(l.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}y>1&&o.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+y);for(var b=6,S=0;S<y;S++){var E=m.getUint16(b,!f);if(b+=2,0!==E){var w=new Uint8Array(t,r+b,E);b+=E;var T=c.default.parseSPS(w);if(0===S){a.codecWidth=T.codec_size.width,a.codecHeight=T.codec_size.height,a.presentWidth=T.present_size.width,a.presentHeight=T.present_size.height,a.profile=T.profile_string,a.level=T.level_string,a.bitDepth=T.bit_depth,a.chromaFormat=T.chroma_format,a.sarRatio=T.sar_ratio,a.frameRate=T.frame_rate,(!1===T.frame_rate.fixed||0===T.frame_rate.fps_num||0===T.frame_rate.fps_den)&&(a.frameRate=this._referenceFrameRate);var O=a.frameRate.fps_den,R=a.frameRate.fps_num;a.refSampleDuration=a.timescale*(O/R);for(var x=w.subarray(1,4),P="avc1.",A=0;A<3;A++){var M=x[A].toString(16);M.length<2&&(M="0"+M),P+=M}a.codec=P;var D=this._mediaInfo;D.width=a.codecWidth,D.height=a.codecHeight,D.fps=a.frameRate.fps,D.profile=a.profile,D.level=a.level,D.refFrames=T.ref_frames,D.chromaFormat=T.chroma_format_string,D.sarNum=a.sarRatio.width,D.sarDen=a.sarRatio.height,D.videoCodec=P,D.hasAudio?null!=D.audioCodec&&(D.mimeType='video/x-flv; codecs="'+D.videoCodec+","+D.audioCodec+'"'):D.mimeType='video/x-flv; codecs="'+D.videoCodec+'"',D.isComplete()&&this._onMediaInfo(D)}}}var I=m.getUint8(b);if(0===I){this._onError(l.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}I>1&&o.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+I),b++;for(var S=0;S<I;S++){var E=m.getUint16(b,!f);b+=2,0!==E&&(b+=E)}a.avcc=new Uint8Array(n),a.avcc.set(new Uint8Array(t,r,n),0),o.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",a)},FLVDemuxer.prototype._parseAVCVideoData=function(t,r,n,a,c,l,d){for(var f=this._littleEndian,m=new DataView(t,r,n),_=[],g=0,y=0,b=this._naluLengthSize,S=this._timestampBase+a,E=1===l;y<n;){if(y+4>=n){o.default.w(this.TAG,"Malformed Nalu near timestamp "+S+", offset = "+y+", dataSize = "+n);break}var w=m.getUint32(y,!f);if(3===b&&(w>>>=8),w>n-b){o.default.w(this.TAG,"Malformed Nalus near timestamp "+S+", NaluSize > DataSize!");return}var T=31&m.getUint8(y+b);5===T&&(E=!0);var O=new Uint8Array(t,r+y,b+w),R={type:T,data:O};_.push(R),g+=O.byteLength,y+=b+w}if(_.length){var x=this._videoTrack,P={units:_,length:g,isKeyframe:E,dts:S,cts:d,pts:S+d};E&&(P.fileposition=c),x.samples.push(P),x.length+=g}},FLVDemuxer}();r.default=m},"./src/demux/sps-parser.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ./exp-golomb.js */"./src/demux/exp-golomb.js"),a=function(){function SPSParser(){}return SPSParser._ebsp2rbsp=function(t){for(var r=t.byteLength,n=new Uint8Array(r),o=0,a=0;a<r;a++)(!(a>=2)||3!==t[a]||0!==t[a-1]||0!==t[a-2])&&(n[o]=t[a],o++);return new Uint8Array(n.buffer,0,o)},SPSParser.parseSPS=function(t){var r=SPSParser._ebsp2rbsp(t),n=new o.default(r);n.readByte();var a=n.readByte();n.readByte();var c=n.readByte();n.readUEG();var l=SPSParser.getProfileString(a),d=SPSParser.getLevelString(c),f=1,m=420,_=8;if((100===a||110===a||122===a||244===a||44===a||83===a||86===a||118===a||128===a||138===a||144===a)&&(3===(f=n.readUEG())&&n.readBits(1),f<=3&&(m=[0,420,422,444][f]),_=n.readUEG()+8,n.readUEG(),n.readBits(1),n.readBool()))for(var g=3!==f?8:12,y=0;y<g;y++)n.readBool()&&(y<6?SPSParser._skipScalingList(n,16):SPSParser._skipScalingList(n,64));n.readUEG();var b=n.readUEG();if(0===b)n.readUEG();else if(1===b){n.readBits(1),n.readSEG(),n.readSEG();for(var S=n.readUEG(),y=0;y<S;y++)n.readSEG()}var E=n.readUEG();n.readBits(1);var w=n.readUEG(),T=n.readUEG(),O=n.readBits(1);0===O&&n.readBits(1),n.readBits(1);var R=0,x=0,P=0,A=0;n.readBool()&&(R=n.readUEG(),x=n.readUEG(),P=n.readUEG(),A=n.readUEG());var M=1,D=1,I=0,j=!0,B=0,U=0;if(n.readBool()){if(n.readBool()){var N=n.readByte();N>0&&N<16?(M=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][N-1],D=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][N-1]):255===N&&(M=n.readByte()<<8|n.readByte(),D=n.readByte()<<8|n.readByte())}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(4),n.readBool()&&n.readBits(24)),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool()){var F=n.readBits(32),$=n.readBits(32);j=n.readBool(),I=(B=$)/(U=2*F)}}var V=1;(1!==M||1!==D)&&(V=M/D);var W=0,z=0;if(0===f)W=1,z=2-O;else{var G=3===f?1:2,q=1===f?2:1;W=G,z=q*(2-O)}var H=(w+1)*16,K=(2-O)*((T+1)*16);H-=(R+x)*W,K-=(P+A)*z;var J=Math.ceil(H*V);return n.destroy(),n=null,{profile_string:l,level_string:d,bit_depth:_,ref_frames:E,chroma_format:m,chroma_format_string:SPSParser.getChromaFormatString(m),frame_rate:{fixed:j,fps:I,fps_den:U,fps_num:B},sar_ratio:{width:M,height:D},codec_size:{width:H,height:K},present_size:{width:J,height:K}}},SPSParser._skipScalingList=function(t,r){for(var n=8,o=8,a=0;a<r;a++)0!==o&&(o=(n+t.readSEG()+256)%256),n=0===o?n:o},SPSParser.getProfileString=function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},SPSParser.getLevelString=function(t){return(t/10).toFixed(1)},SPSParser.getChromaFormatString=function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},SPSParser}();r.default=a},"./src/flv.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ./utils/polyfill.js */"./src/utils/polyfill.js"),a=n(/*! ./core/features.js */"./src/core/features.js"),c=n(/*! ./io/loader.js */"./src/io/loader.js"),l=n(/*! ./player/flv-player.js */"./src/player/flv-player.js"),d=n(/*! ./player/native-player.js */"./src/player/native-player.js"),f=n(/*! ./player/player-events.js */"./src/player/player-events.js"),m=n(/*! ./player/player-errors.js */"./src/player/player-errors.js"),_=n(/*! ./utils/logging-control.js */"./src/utils/logging-control.js"),g=n(/*! ./utils/exception.js */"./src/utils/exception.js");o.default.install();var y={};y.createPlayer=function(t,r){if(null==t||"object"!=typeof t)throw new g.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!t.hasOwnProperty("type"))throw new g.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");return"flv"===t.type?new l.default(t,r):new d.default(t,r)},y.isSupported=function(){return a.default.supportMSEH264Playback()},y.getFeatureList=function(){return a.default.getFeatureList()},y.BaseLoader=c.BaseLoader,y.LoaderStatus=c.LoaderStatus,y.LoaderErrors=c.LoaderErrors,y.Events=f.default,y.ErrorTypes=m.ErrorTypes,y.ErrorDetails=m.ErrorDetails,y.FlvPlayer=l.default,y.NativePlayer=d.default,y.LoggingControl=_.default,Object.defineProperty(y,"version",{enumerable:!0,get:function(){return"1.6.2"}}),r.default=y},"./src/index.js":function(t,r,n){t.exports=n(/*! ./flv.js */"./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(t,r,n){"use strict";n.r(r);var o,a=n(/*! ../utils/browser.js */"./src/utils/browser.js"),c=n(/*! ./loader.js */"./src/io/loader.js"),l=n(/*! ../utils/exception.js */"./src/utils/exception.js"),d=(o=function(t,r){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function __(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}),f=function(t){function FetchStreamLoader(r,n){var o=t.call(this,"fetch-stream-loader")||this;return o.TAG="FetchStreamLoader",o._seekHandler=r,o._config=n,o._needStash=!0,o._requestAbort=!1,o._contentLength=null,o._receivedLength=0,o}return d(FetchStreamLoader,t),FetchStreamLoader.isSupported=function(){try{var t=a.default.msedge&&a.default.version.minor>=15048,r=!a.default.msedge||t;return self.fetch&&self.ReadableStream&&r}catch(t){return!1}},FetchStreamLoader.prototype.destroy=function(){this.isWorking()&&this.abort(),t.prototype.destroy.call(this)},FetchStreamLoader.prototype.open=function(t,r){var n=this;this._dataSource=t,this._range=r;var o=t.url;this._config.reuseRedirectedURL&&void 0!=t.redirectedURL&&(o=t.redirectedURL);var a=this._seekHandler.getConfig(o,r),d=new self.Headers;if("object"==typeof a.headers){var f=a.headers;for(var m in f)f.hasOwnProperty(m)&&d.append(m,f[m])}var _={method:"GET",headers:d,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(var m in this._config.headers)d.append(m,this._config.headers[m]);!1===t.cors&&(_.mode="same-origin"),t.withCredentials&&(_.credentials="include"),t.referrerPolicy&&(_.referrerPolicy=t.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,_.signal=this._abortController.signal),this._status=c.LoaderStatus.kConnecting,self.fetch(a.url,_).then(function(t){if(n._requestAbort){n._status=c.LoaderStatus.kIdle,t.body.cancel();return}if(t.ok&&t.status>=200&&t.status<=299){if(t.url!==a.url&&n._onURLRedirect){var r=n._seekHandler.removeURLParameters(t.url);n._onURLRedirect(r)}var o=t.headers.get("Content-Length");return null!=o&&(n._contentLength=parseInt(o),0!==n._contentLength&&n._onContentLengthKnown&&n._onContentLengthKnown(n._contentLength)),n._pump.call(n,t.body.getReader())}if(n._status=c.LoaderStatus.kError,n._onError)n._onError(c.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText});else throw new l.RuntimeException("FetchStreamLoader: Http code invalid, "+t.status+" "+t.statusText)}).catch(function(t){if(!n._abortController||!n._abortController.signal.aborted){if(n._status=c.LoaderStatus.kError,n._onError)n._onError(c.LoaderErrors.EXCEPTION,{code:-1,msg:t.message});else throw t}})},FetchStreamLoader.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==c.LoaderStatus.kBuffering||!a.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(t){}},FetchStreamLoader.prototype._pump=function(t){var r=this;return t.read().then(function(n){if(n.done){if(null!==r._contentLength&&r._receivedLength<r._contentLength){r._status=c.LoaderStatus.kError;var o=c.LoaderErrors.EARLY_EOF,a={code:-1,msg:"Fetch stream meet Early-EOF"};if(r._onError)r._onError(o,a);else throw new l.RuntimeException(a.msg)}else r._status=c.LoaderStatus.kComplete,r._onComplete&&r._onComplete(r._range.from,r._range.from+r._receivedLength-1)}else{if(r._abortController&&r._abortController.signal.aborted){r._status=c.LoaderStatus.kComplete;return}if(!0===r._requestAbort)return r._status=c.LoaderStatus.kComplete,t.cancel();r._status=c.LoaderStatus.kBuffering;var d=n.value.buffer,f=r._range.from+r._receivedLength;r._receivedLength+=d.byteLength,r._onDataArrival&&r._onDataArrival(d,f,r._receivedLength),r._pump(t)}}).catch(function(t){if(r._abortController&&r._abortController.signal.aborted){r._status=c.LoaderStatus.kComplete;return}if(11!==t.code||!a.default.msedge){r._status=c.LoaderStatus.kError;var n=0,o=null;if((19===t.code||"network error"===t.message)&&(null===r._contentLength||null!==r._contentLength&&r._receivedLength<r._contentLength)?(n=c.LoaderErrors.EARLY_EOF,o={code:t.code,msg:"Fetch stream meet Early-EOF"}):(n=c.LoaderErrors.EXCEPTION,o={code:t.code,msg:t.message}),r._onError)r._onError(n,o);else throw new l.RuntimeException(o.msg)}})},FetchStreamLoader}(c.BaseLoader);r.default=f},"./src/io/io-controller.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ../utils/logger.js */"./src/utils/logger.js"),a=n(/*! ./speed-sampler.js */"./src/io/speed-sampler.js"),c=n(/*! ./loader.js */"./src/io/loader.js"),l=n(/*! ./fetch-stream-loader.js */"./src/io/fetch-stream-loader.js"),d=n(/*! ./xhr-moz-chunked-loader.js */"./src/io/xhr-moz-chunked-loader.js"),f=n(/*! ./xhr-range-loader.js */"./src/io/xhr-range-loader.js"),m=n(/*! ./websocket-loader.js */"./src/io/websocket-loader.js"),_=n(/*! ./range-seek-handler.js */"./src/io/range-seek-handler.js"),g=n(/*! ./param-seek-handler.js */"./src/io/param-seek-handler.js"),y=n(/*! ../utils/exception.js */"./src/utils/exception.js"),b=function(){function IOController(t,r,n){this.TAG="IOController",this._config=r,this._extraData=n,this._stashInitialSize=393216,void 0!=r.stashInitialSize&&r.stashInitialSize>0&&(this._stashInitialSize=r.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===r.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=t,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(t.url),this._refTotalLength=t.filesize?t.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new a.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return IOController.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},IOController.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},IOController.prototype.isPaused=function(){return this._paused},Object.defineProperty(IOController.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"extraData",{get:function(){return this._extraData},set:function(t){this._extraData=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(t){this._onDataArrival=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(t){this._onSeeked=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"onComplete",{get:function(){return this._onComplete},set:function(t){this._onComplete=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(t){this._onRedirect=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(t){this._onRecoveredEarlyEof=t},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"hasRedirect",{get:function(){return null!=this._redirectedURL||void 0!=this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"currentSpeed",{get:function(){return this._loaderClass===f.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(IOController.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),IOController.prototype._selectSeekHandler=function(){var t=this._config;if("range"===t.seekType)this._seekHandler=new _.default(this._config.rangeLoadZeroStart);else if("param"===t.seekType){var r=t.seekParamStart||"bstart",n=t.seekParamEnd||"bend";this._seekHandler=new g.default(r,n)}else if("custom"===t.seekType){if("function"!=typeof t.customSeekHandler)throw new y.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new t.customSeekHandler}else throw new y.InvalidArgumentException("Invalid seekType in config: "+t.seekType)},IOController.prototype._selectLoader=function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=m.default;else if(l.default.isSupported())this._loaderClass=l.default;else if(d.default.isSupported())this._loaderClass=d.default;else if(f.default.isSupported())this._loaderClass=f.default;else throw new y.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},IOController.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},IOController.prototype.open=function(t){this._currentRange={from:0,to:-1},t&&(this._currentRange.from=t),this._speedSampler.reset(),t||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},IOController.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},IOController.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},IOController.prototype.resume=function(){if(this._paused){this._paused=!1;var t=this._resumeFrom;this._resumeFrom=0,this._internalSeek(t,!0)}},IOController.prototype.seek=function(t){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(t,!0)},IOController.prototype._internalSeek=function(t,r){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(r),this._loader.destroy(),this._loader=null;var n={from:t,to:-1};this._currentRange={from:n.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,n),this._onSeeked&&this._onSeeked()},IOController.prototype.updateUrl=function(t){if(!t||"string"!=typeof t||0===t.length)throw new y.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=t},IOController.prototype._expandBuffer=function(t){for(var r=this._stashSize;r+1048576<t;)r*=2;if((r+=1048576)!==this._bufferSize){var n=new ArrayBuffer(r);if(this._stashUsed>0){var o=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(n,0,r).set(o,0)}this._stashBuffer=n,this._bufferSize=r}},IOController.prototype._normalizeSpeed=function(t){var r=this._speedNormalizeList,n=r.length-1,o=0,a=0,c=n;if(t<r[0])return r[0];for(;a<=c;){if((o=a+Math.floor((c-a)/2))===n||t>=r[o]&&t<r[o+1])return r[o];r[o]<t?a=o+1:c=o-1}},IOController.prototype._adjustStashSize=function(t){var r=0;(r=this._config.isLive?t:t<512?t:t>=512&&t<=1024?Math.floor(1.5*t):2*t)>8192&&(r=8192);var n=1024*r+1048576;this._bufferSize<n&&this._expandBuffer(n),this._stashSize=1024*r},IOController.prototype._dispatchChunks=function(t,r){return this._currentRange.to=r+t.byteLength-1,this._onDataArrival(t,r)},IOController.prototype._onURLRedirect=function(t){this._redirectedURL=t,this._onRedirect&&this._onRedirect(t)},IOController.prototype._onContentLengthKnown=function(t){t&&this._fullRequestFlag&&(this._totalLength=t,this._fullRequestFlag=!1)},IOController.prototype._onLoaderChunkArrival=function(t,r,n){if(!this._onDataArrival)throw new y.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(t.byteLength);var o=this._speedSampler.lastSecondKBps;if(0!==o){var a=this._normalizeSpeed(o);this._speedNormalized!==a&&(this._speedNormalized=a,this._adjustStashSize(a))}if(this._enableStash){if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=r),this._stashUsed+t.byteLength<=this._stashSize){var c=new Uint8Array(this._stashBuffer,0,this._stashSize);c.set(new Uint8Array(t),this._stashUsed),this._stashUsed+=t.byteLength}else{var c=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var l=this._stashBuffer.slice(0,this._stashUsed),d=this._dispatchChunks(l,this._stashByteStart);if(d<l.byteLength){if(d>0){var f=new Uint8Array(l,d);c.set(f,0),this._stashUsed=f.byteLength,this._stashByteStart+=d}}else this._stashUsed=0,this._stashByteStart+=d;this._stashUsed+t.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+t.byteLength),c=new Uint8Array(this._stashBuffer,0,this._bufferSize)),c.set(new Uint8Array(t),this._stashUsed),this._stashUsed+=t.byteLength}else{var d=this._dispatchChunks(t,r);if(d<t.byteLength){var m=t.byteLength-d;m>this._bufferSize&&(this._expandBuffer(m),c=new Uint8Array(this._stashBuffer,0,this._bufferSize)),c.set(new Uint8Array(t,d),0),this._stashUsed+=m,this._stashByteStart=r+d}}}}else if(0===this._stashUsed){var d=this._dispatchChunks(t,r);if(d<t.byteLength){var m=t.byteLength-d;m>this._bufferSize&&this._expandBuffer(m);var c=new Uint8Array(this._stashBuffer,0,this._bufferSize);c.set(new Uint8Array(t,d),0),this._stashUsed+=m,this._stashByteStart=r+d}}else{this._stashUsed+t.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+t.byteLength);var c=new Uint8Array(this._stashBuffer,0,this._bufferSize);c.set(new Uint8Array(t),this._stashUsed),this._stashUsed+=t.byteLength;var d=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(d<this._stashUsed&&d>0){var f=new Uint8Array(this._stashBuffer,d);c.set(f,0)}this._stashUsed-=d,this._stashByteStart+=d}}},IOController.prototype._flushStashBuffer=function(t){if(this._stashUsed>0){var r=this._stashBuffer.slice(0,this._stashUsed),n=this._dispatchChunks(r,this._stashByteStart),a=r.byteLength-n;if(n<r.byteLength){if(t)o.default.w(this.TAG,a+" bytes unconsumed data remain when flush buffer, dropped");else{if(n>0){var c=new Uint8Array(this._stashBuffer,0,this._bufferSize),l=new Uint8Array(r,n);c.set(l,0),this._stashUsed=l.byteLength,this._stashByteStart+=n}return 0}}return this._stashUsed=0,this._stashByteStart=0,a}return 0},IOController.prototype._onLoaderComplete=function(t,r){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},IOController.prototype._onLoaderError=function(t,r){switch(o.default.e(this.TAG,"Loader error, code = "+r.code+", msg = "+r.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,t=c.LoaderErrors.UNRECOVERABLE_EARLY_EOF),t){case c.LoaderErrors.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var n=this._currentRange.to+1;n<this._totalLength&&(o.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(n,!1));return}t=c.LoaderErrors.UNRECOVERABLE_EARLY_EOF;case c.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case c.LoaderErrors.CONNECTING_TIMEOUT:case c.LoaderErrors.HTTP_STATUS_CODE_INVALID:case c.LoaderErrors.EXCEPTION:}if(this._onError)this._onError(t,r);else throw new y.RuntimeException("IOException: "+r.msg)},IOController}();r.default=b},"./src/io/loader.js":function(t,r,n){"use strict";n.r(r),n.d(r,{LoaderStatus:function(){return a},LoaderErrors:function(){return c},BaseLoader:function(){return l}});var o=n(/*! ../utils/exception.js */"./src/utils/exception.js"),a={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},c={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},l=function(){function BaseLoader(t){this._type=t||"undefined",this._status=a.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return BaseLoader.prototype.destroy=function(){this._status=a.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},BaseLoader.prototype.isWorking=function(){return this._status===a.kConnecting||this._status===a.kBuffering},Object.defineProperty(BaseLoader.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(t){this._onContentLengthKnown=t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(t){this._onURLRedirect=t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(t){this._onDataArrival=t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"onError",{get:function(){return this._onError},set:function(t){this._onError=t},enumerable:!1,configurable:!0}),Object.defineProperty(BaseLoader.prototype,"onComplete",{get:function(){return this._onComplete},set:function(t){this._onComplete=t},enumerable:!1,configurable:!0}),BaseLoader.prototype.open=function(t,r){throw new o.NotImplementedException("Unimplemented abstract function!")},BaseLoader.prototype.abort=function(){throw new o.NotImplementedException("Unimplemented abstract function!")},BaseLoader}()},"./src/io/param-seek-handler.js":function(t,r,n){"use strict";n.r(r);var o=function(){function ParamSeekHandler(t,r){this._startName=t,this._endName=r}return ParamSeekHandler.prototype.getConfig=function(t,r){var n=t;if(0!==r.from||-1!==r.to){var o=!0;-1===n.indexOf("?")&&(n+="?",o=!1),o&&(n+="&"),n+=this._startName+"="+r.from.toString(),-1!==r.to&&(n+="&"+this._endName+"="+r.to.toString())}return{url:n,headers:{}}},ParamSeekHandler.prototype.removeURLParameters=function(t){var r=t.split("?")[0],n=void 0,o=t.indexOf("?");-1!==o&&(n=t.substring(o+1));var a="";if(void 0!=n&&n.length>0)for(var c=n.split("&"),l=0;l<c.length;l++){var d=c[l].split("="),f=l>0;d[0]!==this._startName&&d[0]!==this._endName&&(f&&(a+="&"),a+=c[l])}return 0===a.length?r:r+"?"+a},ParamSeekHandler}();r.default=o},"./src/io/range-seek-handler.js":function(t,r,n){"use strict";n.r(r);var o=function(){function RangeSeekHandler(t){this._zeroStart=t||!1}return RangeSeekHandler.prototype.getConfig=function(t,r){var n={};if(0!==r.from||-1!==r.to){var o=void 0;o=-1!==r.to?"bytes="+r.from.toString()+"-"+r.to.toString():"bytes="+r.from.toString()+"-",n.Range=o}else this._zeroStart&&(n.Range="bytes=0-");return{url:t,headers:n}},RangeSeekHandler.prototype.removeURLParameters=function(t){return t},RangeSeekHandler}();r.default=o},"./src/io/speed-sampler.js":function(t,r,n){"use strict";n.r(r);var o=function(){function SpeedSampler(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return SpeedSampler.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},SpeedSampler.prototype.addBytes=function(t){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=t,this._totalBytes+=t):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=t,this._totalBytes+=t):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=t,this._totalBytes+=t,this._lastCheckpoint=this._now())},Object.defineProperty(SpeedSampler.prototype,"currentKBps",{get:function(){this.addBytes(0);var t=(this._now()-this._lastCheckpoint)/1e3;return 0==t&&(t=1),this._intervalBytes/t/1024},enumerable:!1,configurable:!0}),Object.defineProperty(SpeedSampler.prototype,"lastSecondKBps",{get:function(){return(this.addBytes(0),0!==this._lastSecondBytes)?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(SpeedSampler.prototype,"averageKBps",{get:function(){var t=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/t/1024},enumerable:!1,configurable:!0}),SpeedSampler}();r.default=o},"./src/io/websocket-loader.js":function(t,r,n){"use strict";n.r(r);var o,a=n(/*! ./loader.js */"./src/io/loader.js"),c=n(/*! ../utils/exception.js */"./src/utils/exception.js"),l=(o=function(t,r){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function __(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}),d=function(t){function WebSocketLoader(){var r=t.call(this,"websocket-loader")||this;return r.TAG="WebSocketLoader",r._needStash=!0,r._ws=null,r._requestAbort=!1,r._receivedLength=0,r}return l(WebSocketLoader,t),WebSocketLoader.isSupported=function(){try{return void 0!==self.WebSocket}catch(t){return!1}},WebSocketLoader.prototype.destroy=function(){this._ws&&this.abort(),t.prototype.destroy.call(this)},WebSocketLoader.prototype.open=function(t){try{var r=this._ws=new self.WebSocket(t.url);r.binaryType="arraybuffer",r.onopen=this._onWebSocketOpen.bind(this),r.onclose=this._onWebSocketClose.bind(this),r.onmessage=this._onWebSocketMessage.bind(this),r.onerror=this._onWebSocketError.bind(this),this._status=a.LoaderStatus.kConnecting}catch(t){this._status=a.LoaderStatus.kError;var n={code:t.code,msg:t.message};if(this._onError)this._onError(a.LoaderErrors.EXCEPTION,n);else throw new c.RuntimeException(n.msg)}},WebSocketLoader.prototype.abort=function(){var t=this._ws;t&&(0===t.readyState||1===t.readyState)&&(this._requestAbort=!0,t.close()),this._ws=null,this._status=a.LoaderStatus.kComplete},WebSocketLoader.prototype._onWebSocketOpen=function(t){this._status=a.LoaderStatus.kBuffering},WebSocketLoader.prototype._onWebSocketClose=function(t){if(!0===this._requestAbort){this._requestAbort=!1;return}this._status=a.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},WebSocketLoader.prototype._onWebSocketMessage=function(t){var r=this;if(t.data instanceof ArrayBuffer)this._dispatchArrayBuffer(t.data);else if(t.data instanceof Blob){var n=new FileReader;n.onload=function(){r._dispatchArrayBuffer(n.result)},n.readAsArrayBuffer(t.data)}else{this._status=a.LoaderStatus.kError;var o={code:-1,msg:"Unsupported WebSocket message type: "+t.data.constructor.name};if(this._onError)this._onError(a.LoaderErrors.EXCEPTION,o);else throw new c.RuntimeException(o.msg)}},WebSocketLoader.prototype._dispatchArrayBuffer=function(t){var r=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,r,this._receivedLength)},WebSocketLoader.prototype._onWebSocketError=function(t){this._status=a.LoaderStatus.kError;var r={code:t.code,msg:t.message};if(this._onError)this._onError(a.LoaderErrors.EXCEPTION,r);else throw new c.RuntimeException(r.msg)},WebSocketLoader}(a.BaseLoader);r.default=d},"./src/io/xhr-moz-chunked-loader.js":function(t,r,n){"use strict";n.r(r);var o,a=n(/*! ../utils/logger.js */"./src/utils/logger.js"),c=n(/*! ./loader.js */"./src/io/loader.js"),l=n(/*! ../utils/exception.js */"./src/utils/exception.js"),d=(o=function(t,r){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function __(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}),f=function(t){function MozChunkedLoader(r,n){var o=t.call(this,"xhr-moz-chunked-loader")||this;return o.TAG="MozChunkedLoader",o._seekHandler=r,o._config=n,o._needStash=!0,o._xhr=null,o._requestAbort=!1,o._contentLength=null,o._receivedLength=0,o}return d(MozChunkedLoader,t),MozChunkedLoader.isSupported=function(){try{var t=new XMLHttpRequest;return t.open("GET","https://example.com",!0),t.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===t.responseType}catch(t){return a.default.w("MozChunkedLoader",t.message),!1}},MozChunkedLoader.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),t.prototype.destroy.call(this)},MozChunkedLoader.prototype.open=function(t,r){this._dataSource=t,this._range=r;var n=t.url;this._config.reuseRedirectedURL&&void 0!=t.redirectedURL&&(n=t.redirectedURL);var o=this._seekHandler.getConfig(n,r);this._requestURL=o.url;var a=this._xhr=new XMLHttpRequest;if(a.open("GET",o.url,!0),a.responseType="moz-chunked-arraybuffer",a.onreadystatechange=this._onReadyStateChange.bind(this),a.onprogress=this._onProgress.bind(this),a.onloadend=this._onLoadEnd.bind(this),a.onerror=this._onXhrError.bind(this),t.withCredentials&&(a.withCredentials=!0),"object"==typeof o.headers){var l=o.headers;for(var d in l)l.hasOwnProperty(d)&&a.setRequestHeader(d,l[d])}if("object"==typeof this._config.headers){var l=this._config.headers;for(var d in l)l.hasOwnProperty(d)&&a.setRequestHeader(d,l[d])}this._status=c.LoaderStatus.kConnecting,a.send()},MozChunkedLoader.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=c.LoaderStatus.kComplete},MozChunkedLoader.prototype._onReadyStateChange=function(t){var r=t.target;if(2===r.readyState){if(void 0!=r.responseURL&&r.responseURL!==this._requestURL&&this._onURLRedirect){var n=this._seekHandler.removeURLParameters(r.responseURL);this._onURLRedirect(n)}if(0!==r.status&&(r.status<200||r.status>299)){if(this._status=c.LoaderStatus.kError,this._onError)this._onError(c.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText});else throw new l.RuntimeException("MozChunkedLoader: Http code invalid, "+r.status+" "+r.statusText)}else this._status=c.LoaderStatus.kBuffering}},MozChunkedLoader.prototype._onProgress=function(t){if(this._status!==c.LoaderStatus.kError){null===this._contentLength&&null!==t.total&&0!==t.total&&(this._contentLength=t.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var r=t.target.response,n=this._range.from+this._receivedLength;this._receivedLength+=r.byteLength,this._onDataArrival&&this._onDataArrival(r,n,this._receivedLength)}},MozChunkedLoader.prototype._onLoadEnd=function(t){if(!0===this._requestAbort){this._requestAbort=!1;return}this._status!==c.LoaderStatus.kError&&(this._status=c.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))},MozChunkedLoader.prototype._onXhrError=function(t){this._status=c.LoaderStatus.kError;var r=0,n=null;if(this._contentLength&&t.loaded<this._contentLength?(r=c.LoaderErrors.EARLY_EOF,n={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(r=c.LoaderErrors.EXCEPTION,n={code:-1,msg:t.constructor.name+" "+t.type}),this._onError)this._onError(r,n);else throw new l.RuntimeException(n.msg)},MozChunkedLoader}(c.BaseLoader);r.default=f},"./src/io/xhr-range-loader.js":function(t,r,n){"use strict";n.r(r);var o,a=n(/*! ../utils/logger.js */"./src/utils/logger.js"),c=n(/*! ./speed-sampler.js */"./src/io/speed-sampler.js"),l=n(/*! ./loader.js */"./src/io/loader.js"),d=n(/*! ../utils/exception.js */"./src/utils/exception.js"),f=(o=function(t,r){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function __(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}),m=function(t){function RangeLoader(r,n){var o=t.call(this,"xhr-range-loader")||this;return o.TAG="RangeLoader",o._seekHandler=r,o._config=n,o._needStash=!1,o._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],o._currentChunkSizeKB=384,o._currentSpeedNormalized=0,o._zeroSpeedChunkCount=0,o._xhr=null,o._speedSampler=new c.default,o._requestAbort=!1,o._waitForTotalLength=!1,o._totalLengthReceived=!1,o._currentRequestURL=null,o._currentRedirectedURL=null,o._currentRequestRange=null,o._totalLength=null,o._contentLength=null,o._receivedLength=0,o._lastTimeLoaded=0,o}return f(RangeLoader,t),RangeLoader.isSupported=function(){try{var t=new XMLHttpRequest;return t.open("GET","https://example.com",!0),t.responseType="arraybuffer","arraybuffer"===t.responseType}catch(t){return a.default.w("RangeLoader",t.message),!1}},RangeLoader.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),t.prototype.destroy.call(this)},Object.defineProperty(RangeLoader.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),RangeLoader.prototype.open=function(t,r){this._dataSource=t,this._range=r,this._status=l.LoaderStatus.kConnecting;var n=!1;void 0!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(n=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||n?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},RangeLoader.prototype._openSubRange=function(){var t=1024*this._currentChunkSizeKB,r=this._range.from+this._receivedLength,n=r+t;null!=this._contentLength&&n-this._range.from>=this._contentLength&&(n=this._range.from+this._contentLength-1),this._currentRequestRange={from:r,to:n},this._internalOpen(this._dataSource,this._currentRequestRange)},RangeLoader.prototype._internalOpen=function(t,r){this._lastTimeLoaded=0;var n=t.url;this._config.reuseRedirectedURL&&(void 0!=this._currentRedirectedURL?n=this._currentRedirectedURL:void 0!=t.redirectedURL&&(n=t.redirectedURL));var o=this._seekHandler.getConfig(n,r);this._currentRequestURL=o.url;var a=this._xhr=new XMLHttpRequest;if(a.open("GET",o.url,!0),a.responseType="arraybuffer",a.onreadystatechange=this._onReadyStateChange.bind(this),a.onprogress=this._onProgress.bind(this),a.onload=this._onLoad.bind(this),a.onerror=this._onXhrError.bind(this),t.withCredentials&&(a.withCredentials=!0),"object"==typeof o.headers){var c=o.headers;for(var l in c)c.hasOwnProperty(l)&&a.setRequestHeader(l,c[l])}if("object"==typeof this._config.headers){var c=this._config.headers;for(var l in c)c.hasOwnProperty(l)&&a.setRequestHeader(l,c[l])}a.send()},RangeLoader.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=l.LoaderStatus.kComplete},RangeLoader.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},RangeLoader.prototype._onReadyStateChange=function(t){var r=t.target;if(2===r.readyState){if(void 0!=r.responseURL){var n=this._seekHandler.removeURLParameters(r.responseURL);r.responseURL!==this._currentRequestURL&&n!==this._currentRedirectedURL&&(this._currentRedirectedURL=n,this._onURLRedirect&&this._onURLRedirect(n))}if(r.status>=200&&r.status<=299){if(this._waitForTotalLength)return;this._status=l.LoaderStatus.kBuffering}else if(this._status=l.LoaderStatus.kError,this._onError)this._onError(l.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText});else throw new d.RuntimeException("RangeLoader: Http code invalid, "+r.status+" "+r.statusText)}},RangeLoader.prototype._onProgress=function(t){if(this._status!==l.LoaderStatus.kError){if(null===this._contentLength){var r=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,r=!0;var n=t.total;this._internalAbort(),null!=n&0!==n&&(this._totalLength=n)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,r){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var o=t.loaded-this._lastTimeLoaded;this._lastTimeLoaded=t.loaded,this._speedSampler.addBytes(o)}},RangeLoader.prototype._normalizeSpeed=function(t){var r=this._chunkSizeKBList,n=r.length-1,o=0,a=0,c=n;if(t<r[0])return r[0];for(;a<=c;){if((o=a+Math.floor((c-a)/2))===n||t>=r[o]&&t<r[o+1])return r[o];r[o]<t?a=o+1:c=o-1}},RangeLoader.prototype._onLoad=function(t){if(this._status!==l.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var r=this._speedSampler.lastSecondKBps;if(0===r&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(r=this._speedSampler.currentKBps)),0!==r){var n=this._normalizeSpeed(r);this._currentSpeedNormalized!==n&&(this._currentSpeedNormalized=n,this._currentChunkSizeKB=n)}var o=t.target.response,a=this._range.from+this._receivedLength;this._receivedLength+=o.byteLength;var c=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():c=!0,this._onDataArrival&&this._onDataArrival(o,a,this._receivedLength),c&&(this._status=l.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},RangeLoader.prototype._onXhrError=function(t){this._status=l.LoaderStatus.kError;var r=0,n=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(r=l.LoaderErrors.EARLY_EOF,n={code:-1,msg:"RangeLoader meet Early-Eof"}):(r=l.LoaderErrors.EXCEPTION,n={code:-1,msg:t.constructor.name+" "+t.type}),this._onError)this._onError(r,n);else throw new d.RuntimeException(n.msg)},RangeLoader}(l.BaseLoader);r.default=m},"./src/player/flv-player.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=n(/*! ../utils/logger.js */"./src/utils/logger.js"),l=n(/*! ../utils/browser.js */"./src/utils/browser.js"),d=n(/*! ./player-events.js */"./src/player/player-events.js"),f=n(/*! ../core/transmuxer.js */"./src/core/transmuxer.js"),m=n(/*! ../core/transmuxing-events.js */"./src/core/transmuxing-events.js"),_=n(/*! ../core/mse-controller.js */"./src/core/mse-controller.js"),g=n(/*! ../core/mse-events.js */"./src/core/mse-events.js"),y=n(/*! ./player-errors.js */"./src/player/player-errors.js"),b=n(/*! ../config.js */"./src/config.js"),S=n(/*! ../utils/exception.js */"./src/utils/exception.js"),E=function(){function FlvPlayer(t,r){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(a()),this._config=(0,b.createDefaultConfig)(),"object"==typeof r&&Object.assign(this._config,r),"flv"!==t.type.toLowerCase())throw new S.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");!0===t.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=t,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var n=l.default.chrome&&(l.default.version.major<50||50===l.default.version.major&&l.default.version.build<2661);this._alwaysSeekKeyframe=!!n||!!l.default.msedge||!!l.default.msie,this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return FlvPlayer.prototype.destroy=function(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},FlvPlayer.prototype.on=function(t,r){var n=this;t===d.default.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then(function(){n._emitter.emit(d.default.MEDIA_INFO,n.mediaInfo)}):t===d.default.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then(function(){n._emitter.emit(d.default.STATISTICS_INFO,n.statisticsInfo)}),this._emitter.addListener(t,r)},FlvPlayer.prototype.off=function(t,r){this._emitter.removeListener(t,r)},FlvPlayer.prototype.attachMediaElement=function(t){var r=this;if(this._mediaElement=t,t.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),t.addEventListener("seeking",this.e.onvSeeking),t.addEventListener("canplay",this.e.onvCanPlay),t.addEventListener("stalled",this.e.onvStalled),t.addEventListener("progress",this.e.onvProgress),this._msectl=new _.default(this._config),this._msectl.on(g.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(g.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(g.default.SOURCE_OPEN,function(){r._mseSourceOpened=!0,r._hasPendingLoad&&(r._hasPendingLoad=!1,r.load())}),this._msectl.on(g.default.ERROR,function(t){r._emitter.emit(d.default.ERROR,y.ErrorTypes.MEDIA_ERROR,y.ErrorDetails.MEDIA_MSE_ERROR,t)}),this._msectl.attachMediaElement(t),null!=this._pendingSeekTime)try{t.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(t){}},FlvPlayer.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},FlvPlayer.prototype.load=function(){var t=this;if(!this._mediaElement)throw new S.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new S.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new f.default(this._mediaDataSource,this._config),this._transmuxer.on(m.default.INIT_SEGMENT,function(r,n){t._msectl.appendInitSegment(n)}),this._transmuxer.on(m.default.MEDIA_SEGMENT,function(r,n){if(t._msectl.appendMediaSegment(n),t._config.lazyLoad&&!t._config.isLive){var o=t._mediaElement.currentTime;n.info.endDts>=(o+t._config.lazyLoadMaxDuration)*1e3&&null==t._progressChecker&&(c.default.v(t.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),t._suspendTransmuxer())}}),this._transmuxer.on(m.default.LOADING_COMPLETE,function(){t._msectl.endOfStream(),t._emitter.emit(d.default.LOADING_COMPLETE)}),this._transmuxer.on(m.default.RECOVERED_EARLY_EOF,function(){t._emitter.emit(d.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(m.default.IO_ERROR,function(r,n){t._emitter.emit(d.default.ERROR,y.ErrorTypes.NETWORK_ERROR,r,n)}),this._transmuxer.on(m.default.DEMUX_ERROR,function(r,n){t._emitter.emit(d.default.ERROR,y.ErrorTypes.MEDIA_ERROR,r,{code:-1,msg:n})}),this._transmuxer.on(m.default.MEDIA_INFO,function(r){t._mediaInfo=r,t._emitter.emit(d.default.MEDIA_INFO,Object.assign({},r))}),this._transmuxer.on(m.default.METADATA_ARRIVED,function(r){t._emitter.emit(d.default.METADATA_ARRIVED,r)}),this._transmuxer.on(m.default.SCRIPTDATA_ARRIVED,function(r){t._emitter.emit(d.default.SCRIPTDATA_ARRIVED,r)}),this._transmuxer.on(m.default.STATISTICS_INFO,function(r){t._statisticsInfo=t._fillStatisticsInfo(r),t._emitter.emit(d.default.STATISTICS_INFO,Object.assign({},t._statisticsInfo))}),this._transmuxer.on(m.default.RECOMMEND_SEEKPOINT,function(r){t._mediaElement&&!t._config.accurateSeek&&(t._requestSetTime=!0,t._mediaElement.currentTime=r/1e3)}),this._transmuxer.open()}},FlvPlayer.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},FlvPlayer.prototype.play=function(){return this._mediaElement.play()},FlvPlayer.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(FlvPlayer.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(t){this._mediaElement.volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(t){this._mediaElement.muted=t},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(t){this._mediaElement?this._internalSeek(t):this._pendingSeekTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(FlvPlayer.prototype,"statisticsInfo",{get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),FlvPlayer.prototype._fillStatisticsInfo=function(t){if(t.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return t;var r=!0,n=0,o=0;if(this._mediaElement.getVideoPlaybackQuality){var a=this._mediaElement.getVideoPlaybackQuality();n=a.totalVideoFrames,o=a.droppedVideoFrames}else void 0!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,o=this._mediaElement.webkitDroppedFrameCount):r=!1;return r&&(t.decodedFrames=n,t.droppedFrames=o),t},FlvPlayer.prototype._onmseUpdateEnd=function(){if(this._config.lazyLoad&&!this._config.isLive){for(var t=this._mediaElement.buffered,r=this._mediaElement.currentTime,n=0,o=0;o<t.length;o++){var a=t.start(o),l=t.end(o);if(a<=r&&r<l){n=l;break}}n>=r+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(c.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},FlvPlayer.prototype._onmseBufferFull=function(){c.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()},FlvPlayer.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},FlvPlayer.prototype._checkProgressAndResume=function(){for(var t=this._mediaElement.currentTime,r=this._mediaElement.buffered,n=!1,o=0;o<r.length;o++){var a=r.start(o),l=r.end(o);if(t>=a&&t<l){t>=l-this._config.lazyLoadRecoverDuration&&(n=!0);break}}n&&(window.clearInterval(this._progressChecker),this._progressChecker=null,n&&(c.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},FlvPlayer.prototype._isTimepointBuffered=function(t){for(var r=this._mediaElement.buffered,n=0;n<r.length;n++){var o=r.start(n),a=r.end(n);if(t>=o&&t<a)return!0}return!1},FlvPlayer.prototype._internalSeek=function(t){var r=this._isTimepointBuffered(t),n=!1,o=0;if(t<1&&this._mediaElement.buffered.length>0){var a=this._mediaElement.buffered.start(0);(a<1&&t<a||l.default.safari)&&(n=!0,o=l.default.safari?.1:a)}if(n)this._requestSetTime=!0,this._mediaElement.currentTime=o;else if(r){if(this._alwaysSeekKeyframe){var c=this._msectl.getNearestKeyframe(Math.floor(1e3*t));this._requestSetTime=!0,null!=c?this._mediaElement.currentTime=c.dts/1e3:this._mediaElement.currentTime=t}else this._requestSetTime=!0,this._mediaElement.currentTime=t;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(t),this._transmuxer.seek(Math.floor(1e3*t)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=t)},FlvPlayer.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord){if(this._seekpointRecord.recordTime<=this._now()-100){var t=this._mediaElement.currentTime;this._seekpointRecord=null,!this._isTimepointBuffered(t)&&(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(t),this._transmuxer.seek(Math.floor(1e3*t)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=t))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},FlvPlayer.prototype._checkAndResumeStuckPlayback=function(t){var r=this._mediaElement;if(t||!this._receivedCanPlay||r.readyState<2){var n=r.buffered;n.length>0&&r.currentTime<n.start(0)&&(c.default.w(this.TAG,"Playback seems stuck at "+r.currentTime+", seek to "+n.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=n.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},FlvPlayer.prototype._onvLoadedMetadata=function(t){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},FlvPlayer.prototype._onvSeeking=function(t){var r=this._mediaElement.currentTime,n=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(r<1&&n.length>0){var o=n.start(0);if(o<1&&r<o||l.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=l.default.safari?.1:o;return}}if(this._isTimepointBuffered(r)){if(this._alwaysSeekKeyframe){var a=this._msectl.getNearestKeyframe(Math.floor(1e3*r));null!=a&&(this._requestSetTime=!0,this._mediaElement.currentTime=a.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:r,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},FlvPlayer.prototype._onvCanPlay=function(t){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},FlvPlayer.prototype._onvStalled=function(t){this._checkAndResumeStuckPlayback(!0)},FlvPlayer.prototype._onvProgress=function(t){this._checkAndResumeStuckPlayback()},FlvPlayer}();r.default=E},"./src/player/native-player.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=n(/*! ./player-events.js */"./src/player/player-events.js"),l=n(/*! ../config.js */"./src/config.js"),d=n(/*! ../utils/exception.js */"./src/utils/exception.js"),f=function(){function NativePlayer(t,r){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(a()),this._config=(0,l.createDefaultConfig)(),"object"==typeof r&&Object.assign(this._config,r),"flv"===t.type.toLowerCase())throw new d.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(t.hasOwnProperty("segments"))throw new d.InvalidArgumentException("NativePlayer("+t.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=t,this._mediaElement=null}return NativePlayer.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},NativePlayer.prototype.on=function(t,r){var n=this;t===c.default.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(function(){n._emitter.emit(c.default.MEDIA_INFO,n.mediaInfo)}):t===c.default.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(function(){n._emitter.emit(c.default.STATISTICS_INFO,n.statisticsInfo)}),this._emitter.addListener(t,r)},NativePlayer.prototype.off=function(t,r){this._emitter.removeListener(t,r)},NativePlayer.prototype.attachMediaElement=function(t){if(this._mediaElement=t,t.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{t.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(t){}},NativePlayer.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},NativePlayer.prototype.load=function(){if(!this._mediaElement)throw new d.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},NativePlayer.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},NativePlayer.prototype.play=function(){return this._mediaElement.play()},NativePlayer.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(NativePlayer.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(t){this._mediaElement.volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(t){this._mediaElement.muted=t},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(t){this._mediaElement?this._mediaElement.currentTime=t:this._pendingSeekTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"mediaInfo",{get:function(){var t={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(t.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(t.width=this._mediaElement.videoWidth,t.height=this._mediaElement.videoHeight)),t},enumerable:!1,configurable:!0}),Object.defineProperty(NativePlayer.prototype,"statisticsInfo",{get:function(){var t={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return t;var r=!0,n=0,o=0;if(this._mediaElement.getVideoPlaybackQuality){var a=this._mediaElement.getVideoPlaybackQuality();n=a.totalVideoFrames,o=a.droppedVideoFrames}else void 0!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,o=this._mediaElement.webkitDroppedFrameCount):r=!1;return r&&(t.decodedFrames=n,t.droppedFrames=o),t},enumerable:!1,configurable:!0}),NativePlayer.prototype._onvLoadedMetadata=function(t){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(c.default.MEDIA_INFO,this.mediaInfo)},NativePlayer.prototype._reportStatisticsInfo=function(){this._emitter.emit(c.default.STATISTICS_INFO,this.statisticsInfo)},NativePlayer}();r.default=f},"./src/player/player-errors.js":function(t,r,n){"use strict";n.r(r),n.d(r,{ErrorTypes:function(){return c},ErrorDetails:function(){return l}});var o=n(/*! ../io/loader.js */"./src/io/loader.js"),a=n(/*! ../demux/demux-errors.js */"./src/demux/demux-errors.js"),c={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},l={NETWORK_EXCEPTION:o.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:o.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:o.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:o.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:a.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:a.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:a.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(t,r,n){"use strict";n.r(r),r.default={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"}},"./src/remux/aac-silent.js":function(t,r,n){"use strict";n.r(r);var o=function(){function AAC(){}return AAC.getSilentFrame=function(t,r){if("mp4a.40.2"===t){if(1===r)return new Uint8Array([0,200,0,128,35,128]);if(2===r)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===r)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===r)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);else if(5===r)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);else if(6===r)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===r)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===r||3===r)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},AAC}();r.default=o},"./src/remux/mp4-generator.js":function(t,r,n){"use strict";n.r(r);var o=function(){function MP4(){}return MP4.init=function(){for(var t in MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]},MP4.types)MP4.types.hasOwnProperty(t)&&(MP4.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=MP4.constants={};r.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),r.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),r.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),r.STSC=r.STCO=r.STTS,r.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),r.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),r.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),r.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},MP4.box=function(t){for(var r=8,n=null,o=Array.prototype.slice.call(arguments,1),a=o.length,c=0;c<a;c++)r+=o[c].byteLength;(n=new Uint8Array(r))[0]=r>>>24&255,n[1]=r>>>16&255,n[2]=r>>>8&255,n[3]=255&r,n.set(t,4);for(var l=8,c=0;c<a;c++)n.set(o[c],l),l+=o[c].byteLength;return n},MP4.generateInitSegment=function(t){var r=MP4.box(MP4.types.ftyp,MP4.constants.FTYP),n=MP4.moov(t),o=new Uint8Array(r.byteLength+n.byteLength);return o.set(r,0),o.set(n,r.byteLength),o},MP4.moov=function(t){var r=MP4.mvhd(t.timescale,t.duration),n=MP4.trak(t),o=MP4.mvex(t);return MP4.box(MP4.types.moov,r,n,o)},MP4.mvhd=function(t,r){return MP4.box(MP4.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},MP4.trak=function(t){return MP4.box(MP4.types.trak,MP4.tkhd(t),MP4.mdia(t))},MP4.tkhd=function(t){var r=t.id,n=t.duration,o=t.presentWidth,a=t.presentHeight;return MP4.box(MP4.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>>8&255,255&o,0,0,a>>>8&255,255&a,0,0]))},MP4.mdia=function(t){return MP4.box(MP4.types.mdia,MP4.mdhd(t),MP4.hdlr(t),MP4.minf(t))},MP4.mdhd=function(t){var r=t.timescale,n=t.duration;return MP4.box(MP4.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,85,196,0,0]))},MP4.hdlr=function(t){var r=null;return r="audio"===t.type?MP4.constants.HDLR_AUDIO:MP4.constants.HDLR_VIDEO,MP4.box(MP4.types.hdlr,r)},MP4.minf=function(t){var r=null;return r="audio"===t.type?MP4.box(MP4.types.smhd,MP4.constants.SMHD):MP4.box(MP4.types.vmhd,MP4.constants.VMHD),MP4.box(MP4.types.minf,r,MP4.dinf(),MP4.stbl(t))},MP4.dinf=function(){return MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,MP4.constants.DREF))},MP4.stbl=function(t){return MP4.box(MP4.types.stbl,MP4.stsd(t),MP4.box(MP4.types.stts,MP4.constants.STTS),MP4.box(MP4.types.stsc,MP4.constants.STSC),MP4.box(MP4.types.stsz,MP4.constants.STSZ),MP4.box(MP4.types.stco,MP4.constants.STCO))},MP4.stsd=function(t){return"audio"!==t.type?MP4.box(MP4.types.stsd,MP4.constants.STSD_PREFIX,MP4.avc1(t)):"mp3"===t.codec?MP4.box(MP4.types.stsd,MP4.constants.STSD_PREFIX,MP4.mp3(t)):MP4.box(MP4.types.stsd,MP4.constants.STSD_PREFIX,MP4.mp4a(t))},MP4.mp3=function(t){var r=t.channelCount,n=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return MP4.box(MP4.types[".mp3"],o)},MP4.mp4a=function(t){var r=t.channelCount,n=t.audioSampleRate,o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return MP4.box(MP4.types.mp4a,o,MP4.esds(t))},MP4.esds=function(t){var r=t.config||[],n=r.length,o=new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(r).concat([6,1,2]));return MP4.box(MP4.types.esds,o)},MP4.avc1=function(t){var r=t.avcc,n=t.codecWidth,o=t.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,o>>>8&255,255&o,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return MP4.box(MP4.types.avc1,a,MP4.box(MP4.types.avcC,r))},MP4.mvex=function(t){return MP4.box(MP4.types.mvex,MP4.trex(t))},MP4.trex=function(t){var r=t.id,n=new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return MP4.box(MP4.types.trex,n)},MP4.moof=function(t,r){return MP4.box(MP4.types.moof,MP4.mfhd(t.sequenceNumber),MP4.traf(t,r))},MP4.mfhd=function(t){var r=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return MP4.box(MP4.types.mfhd,r)},MP4.traf=function(t,r){var n=t.id,o=MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),a=MP4.box(MP4.types.tfdt,new Uint8Array([0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,255&r])),c=MP4.sdtp(t),l=MP4.trun(t,c.byteLength+16+16+8+16+8+8);return MP4.box(MP4.types.traf,o,a,l,c)},MP4.sdtp=function(t){for(var r=t.samples||[],n=r.length,o=new Uint8Array(4+n),a=0;a<n;a++){var c=r[a].flags;o[a+4]=c.isLeading<<6|c.dependsOn<<4|c.isDependedOn<<2|c.hasRedundancy}return MP4.box(MP4.types.sdtp,o)},MP4.trun=function(t,r){var n=t.samples||[],o=n.length,a=12+16*o,c=new Uint8Array(a);r+=8+a,c.set([0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,255&o,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(var l=0;l<o;l++){var d=n[l].duration,f=n[l].size,m=n[l].flags,_=n[l].cts;c.set([d>>>24&255,d>>>16&255,d>>>8&255,255&d,f>>>24&255,f>>>16&255,f>>>8&255,255&f,m.isLeading<<2|m.dependsOn,m.isDependedOn<<6|m.hasRedundancy<<4|m.isNonSync,0,0,_>>>24&255,_>>>16&255,_>>>8&255,255&_],12+16*l)}return MP4.box(MP4.types.trun,c)},MP4.mdat=function(t){return MP4.box(MP4.types.mdat,t)},MP4}();o.init(),r.default=o},"./src/remux/mp4-remuxer.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! ../utils/logger.js */"./src/utils/logger.js"),a=n(/*! ./mp4-generator.js */"./src/remux/mp4-generator.js"),c=n(/*! ./aac-silent.js */"./src/remux/aac-silent.js"),l=n(/*! ../utils/browser.js */"./src/utils/browser.js"),d=n(/*! ../core/media-segment-info.js */"./src/core/media-segment-info.js"),f=n(/*! ../utils/exception.js */"./src/utils/exception.js"),m=function(){function MP4Remuxer(t){this.TAG="MP4Remuxer",this._config=t,this._isLive=!0===t.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new d.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new d.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!l.default.chrome&&(l.default.version.major<50||50===l.default.version.major&&l.default.version.build<2661),this._fillSilentAfterSeek=l.default.msedge||l.default.msie,this._mp3UseMpegAudio=!l.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return MP4Remuxer.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},MP4Remuxer.prototype.bindDataSource=function(t){return t.onDataAvailable=this.remux.bind(this),t.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(MP4Remuxer.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(t){this._onInitSegment=t},enumerable:!1,configurable:!0}),Object.defineProperty(MP4Remuxer.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(t){this._onMediaSegment=t},enumerable:!1,configurable:!0}),MP4Remuxer.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},MP4Remuxer.prototype.seek=function(t){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},MP4Remuxer.prototype.remux=function(t,r){if(!this._onMediaSegment)throw new f.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(t,r),this._remuxVideo(r),this._remuxAudio(t)},MP4Remuxer.prototype._onTrackMetadataReceived=function(t,r){var n=null,o="mp4",c=r.codec;if("audio"===t)this._audioMeta=r,"mp3"===r.codec&&this._mp3UseMpegAudio?(o="mpeg",c="",n=new Uint8Array):n=a.default.generateInitSegment(r);else{if("video"!==t)return;this._videoMeta=r,n=a.default.generateInitSegment(r)}if(!this._onInitSegment)throw new f.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(t,{type:t,data:n.buffer,codec:c,container:t+"/"+o,mediaDuration:r.duration})},MP4Remuxer.prototype._calculateDtsBase=function(t,r){this._dtsBaseInited||(t.samples&&t.samples.length&&(this._audioDtsBase=t.samples[0].dts),r.samples&&r.samples.length&&(this._videoDtsBase=r.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},MP4Remuxer.prototype.flushStashedSamples=function(){var t=this._videoStashedLastSample,r=this._audioStashedLastSample,n={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=t.length);var o={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=r&&(o.samples.push(r),o.length=r.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(n,!0),this._remuxAudio(o,!0)},MP4Remuxer.prototype._remuxAudio=function(t,r){if(null!=this._audioMeta){var n=t.samples,f=void 0,m=-1,_=-1,g=this._audioMeta.refSampleDuration,y="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,b=this._dtsBaseInited&&void 0===this._audioNextDts,S=!1;if(n&&0!==n.length&&(1!==n.length||r)){var E=0,w=null,T=0;y?(E=0,T=t.length):(E=8,T=8+t.length);var O=null;if(n.length>1&&(T-=(O=n.pop()).length),null!=this._audioStashedLastSample){var R=this._audioStashedLastSample;this._audioStashedLastSample=null,n.unshift(R),T+=R.length}null!=O&&(this._audioStashedLastSample=O);var x=n[0].dts-this._dtsBase;if(this._audioNextDts)f=x-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())f=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(S=!0);else{var P=this._audioSegmentInfoList.getLastSampleBefore(x);if(null!=P){var A=x-(P.originalDts+P.duration);A<=3&&(A=0),f=x-(P.dts+P.duration+A)}else f=0}if(S){var M=x-f,D=this._videoSegmentInfoList.getLastSegmentBefore(x);if(null!=D&&D.beginDts<M){var I=c.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(I){var j=D.beginDts,B=M-D.beginDts;o.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+j+", duration: "+B),n.unshift({unit:I,dts:j,pts:j}),T+=I.byteLength}}else S=!1}for(var U=[],N=0;N<n.length;N++){var R=n[N],F=R.unit,$=R.dts-this._dtsBase,j=$,V=!1,W=null,z=0;if(!($<-.001)){if("mp3"!==this._audioMeta.codec){var G=$;if(this._audioNextDts&&(G=this._audioNextDts),(f=$-G)<=-3*g){o.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+$+" ms ,curRefDts: "+G+" ms)  due to dtsCorrection: "+f+" ms overlap.");continue}if(f>=3*g&&this._fillAudioTimestampGap&&!l.default.safari){V=!0;var q=Math.floor(f/g);o.default.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: "+$+" ms, curRefDts: "+G+" ms, "+("dtsCorrection: "+Math.round(f))+" ms, generate: "+q+" frames"),j=Math.floor(G),z=Math.floor(G+g)-j;var I=c.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);null==I&&(o.default.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),I=F),W=[];for(var H=0;H<q;H++){var K=Math.floor(G+=g),J=Math.floor(G+g)-K,X={dts:K,pts:K,cts:0,unit:I,size:I.byteLength,duration:J,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};W.push(X),T+=X.size}this._audioNextDts=G+g}else j=Math.floor(G),z=Math.floor(G+g)-j,this._audioNextDts=G+g}else{if(j=$-f,N!==n.length-1){var Y=n[N+1].dts-this._dtsBase-f;z=Y-j}else if(null!=O){var Y=O.dts-this._dtsBase-f;z=Y-j}else z=U.length>=1?U[U.length-1].duration:Math.floor(g);this._audioNextDts=j+z}-1===m&&(m=j),U.push({dts:j,pts:j,cts:0,unit:R.unit,size:R.unit.byteLength,duration:z,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),V&&U.push.apply(U,W)}}if(0===U.length){t.samples=[],t.length=0;return}y?w=new Uint8Array(T):((w=new Uint8Array(T))[0]=T>>>24&255,w[1]=T>>>16&255,w[2]=T>>>8&255,w[3]=255&T,w.set(a.default.types.mdat,4));for(var N=0;N<U.length;N++){var F=U[N].unit;w.set(F,E),E+=F.byteLength}var Z=U[U.length-1];_=Z.dts+Z.duration;var Q=new d.MediaSegmentInfo;Q.beginDts=m,Q.endDts=_,Q.beginPts=m,Q.endPts=_,Q.originalBeginDts=U[0].originalDts,Q.originalEndDts=Z.originalDts+Z.duration,Q.firstSample=new d.SampleInfo(U[0].dts,U[0].pts,U[0].duration,U[0].originalDts,!1),Q.lastSample=new d.SampleInfo(Z.dts,Z.pts,Z.duration,Z.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Q),t.samples=U,t.sequenceNumber++;var ee=null;ee=y?new Uint8Array:a.default.moof(t,m),t.samples=[],t.length=0;var et={type:"audio",data:this._mergeBoxes(ee,w).buffer,sampleCount:U.length,info:Q};y&&b&&(et.timestampOffset=m),this._onMediaSegment("audio",et)}}},MP4Remuxer.prototype._remuxVideo=function(t,r){if(null!=this._videoMeta){var n=t.samples,o=void 0,c=-1,l=-1,f=-1,m=-1;if(n&&0!==n.length&&(1!==n.length||r)){var _=8,g=null,y=8+t.length,b=null;if(n.length>1&&(y-=(b=n.pop()).length),null!=this._videoStashedLastSample){var S=this._videoStashedLastSample;this._videoStashedLastSample=null,n.unshift(S),y+=S.length}null!=b&&(this._videoStashedLastSample=b);var E=n[0].dts-this._dtsBase;if(this._videoNextDts)o=E-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())o=0;else{var w=this._videoSegmentInfoList.getLastSampleBefore(E);if(null!=w){var T=E-(w.originalDts+w.duration);T<=3&&(T=0),o=E-(w.dts+w.duration+T)}else o=0}for(var O=new d.MediaSegmentInfo,R=[],x=0;x<n.length;x++){var S=n[x],P=S.dts-this._dtsBase,A=S.isKeyframe,M=P-o,D=S.cts,I=M+D;-1===c&&(c=M,f=I);var j=0;if(x!==n.length-1){var B=n[x+1].dts-this._dtsBase-o;j=B-M}else if(null!=b){var B=b.dts-this._dtsBase-o;j=B-M}else j=R.length>=1?R[R.length-1].duration:Math.floor(this._videoMeta.refSampleDuration);if(A){var U=new d.SampleInfo(M,I,j,S.dts,!0);U.fileposition=S.fileposition,O.appendSyncPoint(U)}R.push({dts:M,pts:I,cts:D,units:S.units,size:S.length,isKeyframe:A,duration:j,originalDts:P,flags:{isLeading:0,dependsOn:A?2:1,isDependedOn:A?1:0,hasRedundancy:0,isNonSync:A?0:1}})}(g=new Uint8Array(y))[0]=y>>>24&255,g[1]=y>>>16&255,g[2]=y>>>8&255,g[3]=255&y,g.set(a.default.types.mdat,4);for(var x=0;x<R.length;x++)for(var N=R[x].units;N.length;){var F=N.shift().data;g.set(F,_),_+=F.byteLength}var $=R[R.length-1];if(l=$.dts+$.duration,m=$.pts+$.duration,this._videoNextDts=l,O.beginDts=c,O.endDts=l,O.beginPts=f,O.endPts=m,O.originalBeginDts=R[0].originalDts,O.originalEndDts=$.originalDts+$.duration,O.firstSample=new d.SampleInfo(R[0].dts,R[0].pts,R[0].duration,R[0].originalDts,R[0].isKeyframe),O.lastSample=new d.SampleInfo($.dts,$.pts,$.duration,$.originalDts,$.isKeyframe),this._isLive||this._videoSegmentInfoList.append(O),t.samples=R,t.sequenceNumber++,this._forceFirstIDR){var V=R[0].flags;V.dependsOn=2,V.isNonSync=0}var W=a.default.moof(t,c);t.samples=[],t.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(W,g).buffer,sampleCount:R.length,info:O})}}},MP4Remuxer.prototype._mergeBoxes=function(t,r){var n=new Uint8Array(t.byteLength+r.byteLength);return n.set(t,0),n.set(r,t.byteLength),n},MP4Remuxer}();r.default=m},"./src/utils/browser.js":function(t,r,n){"use strict";n.r(r);var o={};(function(){var t=self.navigator.userAgent.toLowerCase(),r=/(edge)\/([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(iemobile)[\/]([\w.]+)/.exec(t)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(t)||0>t.indexOf("compatible")&&/(firefox)[ \/]([\w.]+)/.exec(t)||[],n=/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(windows phone)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(android)/.exec(t)||/(windows)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||[],a={browser:r[5]||r[3]||r[1]||"",version:r[2]||r[4]||"0",majorVersion:r[4]||r[2]||"0",platform:n[0]||""},c={};if(a.browser){c[a.browser]=!0;var l=a.majorVersion.split(".");c.version={major:parseInt(a.majorVersion,10),string:a.version},l.length>1&&(c.version.minor=parseInt(l[1],10)),l.length>2&&(c.version.build=parseInt(l[2],10))}if(a.platform&&(c[a.platform]=!0),(c.chrome||c.opr||c.safari)&&(c.webkit=!0),c.rv||c.iemobile){c.rv&&delete c.rv;var d="msie";a.browser=d,c[d]=!0}if(c.edge){delete c.edge;var f="msedge";a.browser=f,c[f]=!0}if(c.opr){var m="opera";a.browser=m,c[m]=!0}if(c.safari&&c.android){var _="android";a.browser=_,c[_]=!0}for(var g in c.name=a.browser,c.platform=a.platform,o)o.hasOwnProperty(g)&&delete o[g];Object.assign(o,c)})(),r.default=o},"./src/utils/exception.js":function(t,r,n){"use strict";n.r(r),n.d(r,{RuntimeException:function(){return c},IllegalStateException:function(){return l},InvalidArgumentException:function(){return d},NotImplementedException:function(){return f}});var o,a=(o=function(t,r){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])})(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Class extends value "+String(r)+" is not a constructor or null");function __(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(__.prototype=r.prototype,new __)}),c=function(){function RuntimeException(t){this._message=t}return Object.defineProperty(RuntimeException.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(RuntimeException.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),RuntimeException.prototype.toString=function(){return this.name+": "+this.message},RuntimeException}(),l=function(t){function IllegalStateException(r){return t.call(this,r)||this}return a(IllegalStateException,t),Object.defineProperty(IllegalStateException.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),IllegalStateException}(c),d=function(t){function InvalidArgumentException(r){return t.call(this,r)||this}return a(InvalidArgumentException,t),Object.defineProperty(InvalidArgumentException.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),InvalidArgumentException}(c),f=function(t){function NotImplementedException(r){return t.call(this,r)||this}return a(NotImplementedException,t),Object.defineProperty(NotImplementedException.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),NotImplementedException}(c)},"./src/utils/logger.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=function(){function Log(){}return Log.e=function(t,r){(!t||Log.FORCE_GLOBAL_TAG)&&(t=Log.GLOBAL_TAG);var n="["+t+"] > "+r;Log.ENABLE_CALLBACK&&Log.emitter.emit("log","error",n),Log.ENABLE_ERROR&&(console.error?console.error(n):console.warn?console.warn(n):console.log(n))},Log.i=function(t,r){(!t||Log.FORCE_GLOBAL_TAG)&&(t=Log.GLOBAL_TAG);var n="["+t+"] > "+r;Log.ENABLE_CALLBACK&&Log.emitter.emit("log","info",n),Log.ENABLE_INFO&&(console.info?console.info(n):console.log(n))},Log.w=function(t,r){(!t||Log.FORCE_GLOBAL_TAG)&&(t=Log.GLOBAL_TAG);var n="["+t+"] > "+r;Log.ENABLE_CALLBACK&&Log.emitter.emit("log","warn",n),Log.ENABLE_WARN&&(console.warn?console.warn(n):console.log(n))},Log.d=function(t,r){(!t||Log.FORCE_GLOBAL_TAG)&&(t=Log.GLOBAL_TAG);var n="["+t+"] > "+r;Log.ENABLE_CALLBACK&&Log.emitter.emit("log","debug",n),Log.ENABLE_DEBUG&&(console.debug?console.debug(n):console.log(n))},Log.v=function(t,r){(!t||Log.FORCE_GLOBAL_TAG)&&(t=Log.GLOBAL_TAG);var n="["+t+"] > "+r;Log.ENABLE_CALLBACK&&Log.emitter.emit("log","verbose",n),Log.ENABLE_VERBOSE&&console.log(n)},Log}();c.GLOBAL_TAG="flv.js",c.FORCE_GLOBAL_TAG=!1,c.ENABLE_ERROR=!0,c.ENABLE_INFO=!0,c.ENABLE_WARN=!0,c.ENABLE_DEBUG=!0,c.ENABLE_VERBOSE=!0,c.ENABLE_CALLBACK=!1,c.emitter=new(a()),r.default=c},"./src/utils/logging-control.js":function(t,r,n){"use strict";n.r(r);var o=n(/*! events */"./node_modules/events/events.js"),a=n.n(o),c=n(/*! ./logger.js */"./src/utils/logger.js"),l=function(){function LoggingControl(){}return Object.defineProperty(LoggingControl,"forceGlobalTag",{get:function(){return c.default.FORCE_GLOBAL_TAG},set:function(t){c.default.FORCE_GLOBAL_TAG=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"globalTag",{get:function(){return c.default.GLOBAL_TAG},set:function(t){c.default.GLOBAL_TAG=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"enableAll",{get:function(){return c.default.ENABLE_VERBOSE&&c.default.ENABLE_DEBUG&&c.default.ENABLE_INFO&&c.default.ENABLE_WARN&&c.default.ENABLE_ERROR},set:function(t){c.default.ENABLE_VERBOSE=t,c.default.ENABLE_DEBUG=t,c.default.ENABLE_INFO=t,c.default.ENABLE_WARN=t,c.default.ENABLE_ERROR=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"enableDebug",{get:function(){return c.default.ENABLE_DEBUG},set:function(t){c.default.ENABLE_DEBUG=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"enableVerbose",{get:function(){return c.default.ENABLE_VERBOSE},set:function(t){c.default.ENABLE_VERBOSE=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"enableInfo",{get:function(){return c.default.ENABLE_INFO},set:function(t){c.default.ENABLE_INFO=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"enableWarn",{get:function(){return c.default.ENABLE_WARN},set:function(t){c.default.ENABLE_WARN=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(LoggingControl,"enableError",{get:function(){return c.default.ENABLE_ERROR},set:function(t){c.default.ENABLE_ERROR=t,LoggingControl._notifyChange()},enumerable:!1,configurable:!0}),LoggingControl.getConfig=function(){return{globalTag:c.default.GLOBAL_TAG,forceGlobalTag:c.default.FORCE_GLOBAL_TAG,enableVerbose:c.default.ENABLE_VERBOSE,enableDebug:c.default.ENABLE_DEBUG,enableInfo:c.default.ENABLE_INFO,enableWarn:c.default.ENABLE_WARN,enableError:c.default.ENABLE_ERROR,enableCallback:c.default.ENABLE_CALLBACK}},LoggingControl.applyConfig=function(t){c.default.GLOBAL_TAG=t.globalTag,c.default.FORCE_GLOBAL_TAG=t.forceGlobalTag,c.default.ENABLE_VERBOSE=t.enableVerbose,c.default.ENABLE_DEBUG=t.enableDebug,c.default.ENABLE_INFO=t.enableInfo,c.default.ENABLE_WARN=t.enableWarn,c.default.ENABLE_ERROR=t.enableError,c.default.ENABLE_CALLBACK=t.enableCallback},LoggingControl._notifyChange=function(){var t=LoggingControl.emitter;if(t.listenerCount("change")>0){var r=LoggingControl.getConfig();t.emit("change",r)}},LoggingControl.registerListener=function(t){LoggingControl.emitter.addListener("change",t)},LoggingControl.removeListener=function(t){LoggingControl.emitter.removeListener("change",t)},LoggingControl.addLogListener=function(t){c.default.emitter.addListener("log",t),c.default.emitter.listenerCount("log")>0&&(c.default.ENABLE_CALLBACK=!0,LoggingControl._notifyChange())},LoggingControl.removeLogListener=function(t){c.default.emitter.removeListener("log",t),0===c.default.emitter.listenerCount("log")&&(c.default.ENABLE_CALLBACK=!1,LoggingControl._notifyChange())},LoggingControl}();l.emitter=new(a()),r.default=l},"./src/utils/polyfill.js":function(t,r,n){"use strict";n.r(r);var o=function(){function Polyfill(){}return Polyfill.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t},Object.assign=Object.assign||function(t){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(var r=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var a in o)o.hasOwnProperty(a)&&(r[a]=o[a])}return r},"function"!=typeof self.Promise&&n(/*! es6-promise */"./node_modules/es6-promise/dist/es6-promise.js").polyfill()},Polyfill}();o.install(),r.default=o},"./src/utils/utf8-conv.js":function(t,r,n){"use strict";function checkContinuation(t,r,n){if(!(r+n<t.length))return!1;for(;n--;)if((192&t[++r])!=128)return!1;return!0}n.r(r),r.default=function(t){for(var r=[],n=0,o=t.length;n<o;){if(t[n]<128){r.push(String.fromCharCode(t[n])),++n;continue}if(t[n]<192);else if(t[n]<224){if(checkContinuation(t,n,1)){var a=(31&t[n])<<6|63&t[n+1];if(a>=128){r.push(String.fromCharCode(65535&a)),n+=2;continue}}}else if(t[n]<240){if(checkContinuation(t,n,2)){var a=(15&t[n])<<12|(63&t[n+1])<<6|63&t[n+2];if(a>=2048&&(63488&a)!=55296){r.push(String.fromCharCode(65535&a)),n+=3;continue}}}else if(t[n]<248&&checkContinuation(t,n,3)){var a=(7&t[n])<<18|(63&t[n+1])<<12|(63&t[n+2])<<6|63&t[n+3];if(a>65536&&a<1114112){a-=65536,r.push(String.fromCharCode(a>>>10|55296)),r.push(String.fromCharCode(1023&a|56320)),n+=4;continue}}r.push(String.fromCharCode(65533)),++n}return r.join("")}}},r={};function __nested_webpack_require_433166__(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return t[n].call(a.exports,a,a.exports,__nested_webpack_require_433166__),a.exports}return __nested_webpack_require_433166__.m=t,__nested_webpack_require_433166__.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return __nested_webpack_require_433166__.d(r,{a:r}),r},__nested_webpack_require_433166__.d=function(t,r){for(var n in r)__nested_webpack_require_433166__.o(r,n)&&!__nested_webpack_require_433166__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},__nested_webpack_require_433166__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__nested_webpack_require_433166__.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},__nested_webpack_require_433166__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__nested_webpack_require_433166__("./src/index.js")}()},36461:t=>{"use strict";t.exports=(t,r=process.argv)=>{let n=t.startsWith("-")?"":1===t.length?"-":"--",o=r.indexOf(n+t),a=r.indexOf("--");return -1!==o&&(-1===a||o<a)}},69842:t=>{function plural(t,r,n,o){return Math.round(t/n)+" "+o+(r>=1.5*n?"s":"")}t.exports=function(t,r){r=r||{};var n,o,a=typeof t;if("string"===a&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(r){var n=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return 864e5*n;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*n;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===a&&isFinite(t))return r.long?(n=Math.abs(t))>=864e5?plural(t,n,864e5,"day"):n>=36e5?plural(t,n,36e5,"hour"):n>=6e4?plural(t,n,6e4,"minute"):n>=1e3?plural(t,n,1e3,"second"):t+" ms":(o=Math.abs(t))>=864e5?Math.round(t/864e5)+"d":o>=36e5?Math.round(t/36e5)+"h":o>=6e4?Math.round(t/6e4)+"m":o>=1e3?Math.round(t/1e3)+"s":t+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},57114:(t,r,n)=>{t.exports=n(82778)},9929:(t,r,n)=>{var o=n(57147),a=n(71017),c=require,l=process.config&&process.config.variables||{},d=!!process.env.PREBUILDS_ONLY,f=process.versions.modules,m=process.versions&&process.versions.electron||process.env.ELECTRON_RUN_AS_NODE||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":"node",_=process.arch,g=process.platform,y=process.env.LIBC||("linux"===g&&o.existsSync("/etc/alpine-release")?"musl":"glibc"),b=process.env.ARM_VERSION||("arm64"===_?"8":l.arm_version)||"",S=(process.versions.uv||"").split(".")[0];function load(t){return c(load.path(t))}function readdirSync(t){try{return o.readdirSync(t)}catch(t){return[]}}function getFirst(t,r){var n=readdirSync(t).filter(r);return n[0]&&a.join(t,n[0])}function matchBuild(t){return/\.node$/.test(t)}function parseTuple(t){var r=t.split("-");if(2===r.length){var n=r[0],o=r[1].split("+");if(n&&o.length&&o.every(Boolean))return{name:t,platform:n,architectures:o}}}function matchTuple(t,r){return function(n){return null!=n&&n.platform===t&&n.architectures.includes(r)}}function compareTuples(t,r){return t.architectures.length-r.architectures.length}function parseTags(t){var r=t.split("."),n=r.pop(),o={file:t,specificity:0};if("node"===n){for(var a=0;a<r.length;a++){var c=r[a];if("node"===c||"electron"===c||"node-webkit"===c)o.runtime=c;else if("napi"===c)o.napi=!0;else if("abi"===c.slice(0,3))o.abi=c.slice(3);else if("uv"===c.slice(0,2))o.uv=c.slice(2);else if("armv"===c.slice(0,4))o.armv=c.slice(4);else{if("glibc"!==c&&"musl"!==c)continue;o.libc=c}o.specificity++}return o}}function matchTags(t,r){return function(n){return null!=n&&(n.runtime===t||!!("node"===n.runtime&&n.napi))&&(n.abi===r||!!n.napi)&&(!n.uv||n.uv===S)&&(!n.armv||n.armv===b)&&(!n.libc||n.libc===y)}}function compareTags(t){return function(r,n){return r.runtime!==n.runtime?r.runtime===t?-1:1:r.abi!==n.abi?r.abi?-1:1:r.specificity!==n.specificity?r.specificity>n.specificity?-1:1:0}}t.exports=load,load.path=function(t){t=a.resolve(t||".");try{var r,o=(r=c(a.join(t,"package.json")).name).toUpperCase().replace(/-/g,"_")+"_PREBUILD";process.env[o]&&(t=process.env[o])}catch(t){}if(!d){var l=getFirst(a.join(t,"build/Release"),matchBuild);if(l)return l;var E=getFirst(a.join(t,"build/Debug"),matchBuild);if(E)return E}var w=resolve(t);if(w)return w;var T=resolve(a.dirname(process.execPath));if(T)return T;var O=("@"==r[0]?"":"@"+r+"/")+r+"-"+g+"-"+_;try{var R=a.dirname(n(98188).createRequire(a.join(t,"package.json")).resolve(O));return resolveFile(R)}catch(t){}throw Error("No native build was found for "+["platform="+g,"arch="+_,"runtime="+m,"abi="+f,"uv="+S,b?"armv="+b:"","libc="+y,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"","webpack=true"].filter(Boolean).join(" ")+"\n    loaded from: "+t+" and package: "+O+"\n");function resolve(t){var r=readdirSync(a.join(t,"prebuilds")).map(parseTuple).filter(matchTuple(g,_)).sort(compareTuples)[0];if(r)return resolveFile(a.join(t,"prebuilds",r.name))}function resolveFile(t){var r=readdirSync(t).map(parseTags).filter(matchTags(m,f)).sort(compareTags(m))[0];if(r)return a.join(t,r.file)}},load.parseTags=parseTags,load.matchTags=matchTags,load.compareTags=compareTags,load.parseTuple=parseTuple,load.matchTuple=matchTuple,load.compareTuples=compareTuples},68507:(t,r,n)=>{"use strict";t=n.nmd(t);var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a={};a.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},a.localCName=a.generateIdentifier(),a.splitLines=function(t){return t.trim().split("\n").map(function(t){return t.trim()})},a.splitSections=function(t){return t.split("\nm=").map(function(t,r){return(r>0?"m="+t:t).trim()+"\r\n"})},a.getDescription=function(t){var r=a.splitSections(t);return r&&r[0]},a.getMediaSections=function(t){var r=a.splitSections(t);return r.shift(),r},a.matchPrefix=function(t,r){return a.splitLines(t).filter(function(t){return 0===t.indexOf(r)})},a.parseCandidate=function(t){for(var r=void 0,n={foundation:(r=0===t.indexOf("a=candidate:")?t.substring(12).split(" "):t.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]},o=8;o<r.length;o+=2)switch(r[o]){case"raddr":n.relatedAddress=r[o+1];break;case"rport":n.relatedPort=parseInt(r[o+1],10);break;case"tcptype":n.tcpType=r[o+1];break;case"ufrag":n.ufrag=r[o+1],n.usernameFragment=r[o+1];break;default:void 0===n[r[o]]&&(n[r[o]]=r[o+1])}return n},a.writeCandidate=function(t){var r=[];r.push(t.foundation);var n=t.component;"rtp"===n?r.push(1):"rtcp"===n?r.push(2):r.push(n),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);var o=t.type;return r.push("typ"),r.push(o),"host"!==o&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&"tcp"===t.protocol.toLowerCase()&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},a.parseIceOptions=function(t){return t.substring(14).split(" ")},a.parseRtpMap=function(t){var r=t.substring(9).split(" "),n={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),n.name=r[0],n.clockRate=parseInt(r[1],10),n.channels=3===r.length?parseInt(r[2],10):1,n.numChannels=n.channels,n},a.writeRtpMap=function(t){var r=t.payloadType;void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType);var n=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(1!==n?"/"+n:"")+"\r\n"},a.parseExtmap=function(t){var r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},a.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&"sendrecv"!==t.direction?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+"\r\n"},a.parseFmtp=function(t){for(var r={},n=void 0,o=t.substring(t.indexOf(" ")+1).split(";"),a=0;a<o.length;a++)r[(n=o[a].trim().split("="))[0].trim()]=n[1];return r},a.writeFmtp=function(t){var r="",n=t.payloadType;if(void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var o=[];Object.keys(t.parameters).forEach(function(r){void 0!==t.parameters[r]?o.push(r+"="+t.parameters[r]):o.push(r)}),r+="a=fmtp:"+n+" "+o.join(";")+"\r\n"}return r},a.parseRtcpFb=function(t){var r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},a.writeRtcpFb=function(t){var r="",n=t.payloadType;return void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(function(t){r+="a=rtcp-fb:"+n+" "+t.type+(t.parameter&&t.parameter.length?" "+t.parameter:"")+"\r\n"}),r},a.parseSsrcMedia=function(t){var r=t.indexOf(" "),n={ssrc:parseInt(t.substring(7,r),10)},o=t.indexOf(":",r);return o>-1?(n.attribute=t.substring(r+1,o),n.value=t.substring(o+1)):n.attribute=t.substring(r+1),n},a.parseSsrcGroup=function(t){var r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(function(t){return parseInt(t,10)})}},a.getMid=function(t){var r=a.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},a.parseFingerprint=function(t){var r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},a.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:a.matchPrefix(t+r,"a=fingerprint:").map(a.parseFingerprint)}},a.writeDtlsParameters=function(t,r){var n="a=setup:"+r+"\r\n";return t.fingerprints.forEach(function(t){n+="a=fingerprint:"+t.algorithm+" "+t.value+"\r\n"}),n},a.parseCryptoLine=function(t){var r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},a.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+("object"===o(t.keyParams)?a.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+"\r\n"},a.parseCryptoKeyParams=function(t){if(0!==t.indexOf("inline:"))return null;var r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},a.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},a.getCryptoParameters=function(t,r){return a.matchPrefix(t+r,"a=crypto:").map(a.parseCryptoLine)},a.getIceParameters=function(t,r){var n=a.matchPrefix(t+r,"a=ice-ufrag:")[0],o=a.matchPrefix(t+r,"a=ice-pwd:")[0];return n&&o?{usernameFragment:n.substring(12),password:o.substring(10)}:null},a.writeIceParameters=function(t){var r="a=ice-ufrag:"+t.usernameFragment+"\r\na=ice-pwd:"+t.password+"\r\n";return t.iceLite&&(r+="a=ice-lite\r\n"),r},a.parseRtpParameters=function(t){var r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=a.splitLines(t)[0].split(" ");r.profile=n[2];for(var o=3;o<n.length;o++){var c=n[o],l=a.matchPrefix(t,"a=rtpmap:"+c+" ")[0];if(l){var d=a.parseRtpMap(l),f=a.matchPrefix(t,"a=fmtp:"+c+" ");switch(d.parameters=f.length?a.parseFmtp(f[0]):{},d.rtcpFeedback=a.matchPrefix(t,"a=rtcp-fb:"+c+" ").map(a.parseRtcpFb),r.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(d.name.toUpperCase())}}}a.matchPrefix(t,"a=extmap:").forEach(function(t){r.headerExtensions.push(a.parseExtmap(t))});var m=a.matchPrefix(t,"a=rtcp-fb:* ").map(a.parseRtcpFb);return r.codecs.forEach(function(t){m.forEach(function(r){t.rtcpFeedback.find(function(t){return t.type===r.type&&t.parameter===r.parameter})||t.rtcpFeedback.push(r)})}),r},a.writeRtpDescription=function(t,r){var n="";n+="m="+t+" "+(r.codecs.length>0?"9":"0")+" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" "+r.codecs.map(function(t){return void 0!==t.preferredPayloadType?t.preferredPayloadType:t.payloadType}).join(" ")+"\r\nc=IN IP4 0.0.0.0\r\na=rtcp:9 IN IP4 0.0.0.0\r\n",r.codecs.forEach(function(t){n+=a.writeRtpMap(t)+a.writeFmtp(t)+a.writeRtcpFb(t)});var o=0;return r.codecs.forEach(function(t){t.maxptime>o&&(o=t.maxptime)}),o>0&&(n+="a=maxptime:"+o+"\r\n"),r.headerExtensions&&r.headerExtensions.forEach(function(t){n+=a.writeExtmap(t)}),n},a.parseRtpEncodingParameters=function(t){var r=[],n=a.parseRtpParameters(t),o=-1!==n.fecMechanisms.indexOf("RED"),c=-1!==n.fecMechanisms.indexOf("ULPFEC"),l=a.matchPrefix(t,"a=ssrc:").map(function(t){return a.parseSsrcMedia(t)}).filter(function(t){return"cname"===t.attribute}),d=l.length>0&&l[0].ssrc,f=void 0,m=a.matchPrefix(t,"a=ssrc-group:FID").map(function(t){return t.substring(17).split(" ").map(function(t){return parseInt(t,10)})});m.length>0&&m[0].length>1&&m[0][0]===d&&(f=m[0][1]),n.codecs.forEach(function(t){if("RTX"===t.name.toUpperCase()&&t.parameters.apt){var n={ssrc:d,codecPayloadType:parseInt(t.parameters.apt,10)};d&&f&&(n.rtx={ssrc:f}),r.push(n),o&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:d,mechanism:c?"red+ulpfec":"red"},r.push(n))}}),0===r.length&&d&&r.push({ssrc:d});var _=a.matchPrefix(t,"b=");return _.length&&(_=0===_[0].indexOf("b=TIAS:")?parseInt(_[0].substring(7),10):0===_[0].indexOf("b=AS:")?950*parseInt(_[0].substring(5),10)-16e3:void 0,r.forEach(function(t){t.maxBitrate=_})),r},a.parseRtcpParameters=function(t){var r={},n=a.matchPrefix(t,"a=ssrc:").map(function(t){return a.parseSsrcMedia(t)}).filter(function(t){return"cname"===t.attribute})[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);var o=a.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=o.length>0,r.compound=0===o.length;var c=a.matchPrefix(t,"a=rtcp-mux");return r.mux=c.length>0,r},a.writeRtcpParameters=function(t){var r="";return t.reducedSize&&(r+="a=rtcp-rsize\r\n"),t.mux&&(r+="a=rtcp-mux\r\n"),void 0!==t.ssrc&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+"\r\n"),r},a.parseMsid=function(t){var r=void 0,n=a.matchPrefix(t,"a=msid:");if(1===n.length)return{stream:(r=n[0].substring(7).split(" "))[0],track:r[1]};var o=a.matchPrefix(t,"a=ssrc:").map(function(t){return a.parseSsrcMedia(t)}).filter(function(t){return"msid"===t.attribute});if(o.length>0)return{stream:(r=o[0].value.split(" "))[0],track:r[1]}},a.parseSctpDescription=function(t){var r=a.parseMLine(t),n=a.matchPrefix(t,"a=max-message-size:"),o=void 0;n.length>0&&(o=parseInt(n[0].substring(19),10)),isNaN(o)&&(o=65536);var c=a.matchPrefix(t,"a=sctp-port:");if(c.length>0)return{port:parseInt(c[0].substring(12),10),protocol:r.fmt,maxMessageSize:o};var l=a.matchPrefix(t,"a=sctpmap:");if(l.length>0){var d=l[0].substring(10).split(" ");return{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:o}}},a.writeSctpDescription=function(t,r){var n=[];return n="DTLS/SCTP"!==t.protocol?["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+r.port+"\r\n"]:["m="+t.kind+" 9 "+t.protocol+" "+r.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+r.port+" "+r.protocol+" 65535\r\n"],void 0!==r.maxMessageSize&&n.push("a=max-message-size:"+r.maxMessageSize+"\r\n"),n.join("")},a.generateSessionId=function(){return Math.random().toString().substr(2,22)},a.writeSessionBoilerplate=function(t,r,n){var o=void 0;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(t||a.generateSessionId())+" "+(void 0!==r?r:2)+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},a.getDirection=function(t,r){for(var n=a.splitLines(t),o=0;o<n.length;o++)switch(n[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[o].substring(2)}return r?a.getDirection(r):"sendrecv"},a.getKind=function(t){return a.splitLines(t)[0].split(" ")[0].substring(2)},a.isRejected=function(t){return"0"===t.split(" ",2)[1]},a.parseMLine=function(t){var r=a.splitLines(t)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},a.parseOLine=function(t){var r=a.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},a.isValidSDP=function(t){if("string"!=typeof t||0===t.length)return!1;for(var r=a.splitLines(t),n=0;n<r.length;n++)if(r[n].length<2||"="!==r[n].charAt(1))return!1;return!0},"object"===o(t)&&(t.exports=a)},35048:(t,r,n)=>{"use strict";let o;let a=n(22037),c=n(76224),l=n(36461),{env:d}=process;function translateLevel(t){return 0!==t&&{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function supportsColor(t,r){if(0===o)return 0;if(l("color=16m")||l("color=full")||l("color=truecolor"))return 3;if(l("color=256"))return 2;if(t&&!r&&void 0===o)return 0;let n=o||0;if("dumb"===d.TERM)return n;if("win32"===process.platform){let t=a.release().split(".");return Number(t[0])>=10&&Number(t[2])>=10586?Number(t[2])>=14931?3:2:1}if("CI"in d)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(t=>t in d)||"codeship"===d.CI_NAME?1:n;if("TEAMCITY_VERSION"in d)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(d.TEAMCITY_VERSION)?1:0;if("truecolor"===d.COLORTERM)return 3;if("TERM_PROGRAM"in d){let t=parseInt((d.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(d.TERM_PROGRAM){case"iTerm.app":return t>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(d.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(d.TERM)||"COLORTERM"in d?1:n}l("no-color")||l("no-colors")||l("color=false")||l("color=never")?o=0:(l("color")||l("colors")||l("color=true")||l("color=always"))&&(o=1),"FORCE_COLOR"in d&&(o="true"===d.FORCE_COLOR?1:"false"===d.FORCE_COLOR?0:0===d.FORCE_COLOR.length?1:Math.min(parseInt(d.FORCE_COLOR,10),3)),t.exports={supportsColor:function(t){let r=supportsColor(t,t&&t.isTTY);return translateLevel(r)},stdout:translateLevel(supportsColor(!0,c.isatty(1))),stderr:translateLevel(supportsColor(!0,c.isatty(2)))}},56677:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(0,n(898).adapterFactory)({window:"undefined"==typeof window?void 0:window});r.default=o},898:(t,r,n)=>{"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},m=o.log,_=o.detectBrowser(r),g={browserDetails:_,commonShim:d,extractVersion:o.extractVersion,disableLog:o.disableLog,disableWarnings:o.disableWarnings,sdp:f};switch(_.browser){case"chrome":if(!a||!a.shimPeerConnection||!n.shimChrome){m("Chrome shim is not included in this adapter release.");break}if(null===_.version){m("Chrome shim can not determine version, not shimming.");break}m("adapter.js shimming chrome."),g.browserShim=a,d.shimAddIceCandidateNullOrEmpty(r,_),d.shimParameterlessSetLocalDescription(r,_),a.shimGetUserMedia(r,_),a.shimMediaStream(r,_),a.shimPeerConnection(r,_),a.shimOnTrack(r,_),a.shimAddTrackRemoveTrack(r,_),a.shimGetSendersWithDtmf(r,_),a.shimGetStats(r,_),a.shimSenderReceiverGetStats(r,_),a.fixNegotiationNeeded(r,_),d.shimRTCIceCandidate(r,_),d.shimRTCIceCandidateRelayProtocol(r,_),d.shimConnectionState(r,_),d.shimMaxMessageSize(r,_),d.shimSendThrowTypeError(r,_),d.removeExtmapAllowMixed(r,_);break;case"firefox":if(!c||!c.shimPeerConnection||!n.shimFirefox){m("Firefox shim is not included in this adapter release.");break}m("adapter.js shimming firefox."),g.browserShim=c,d.shimAddIceCandidateNullOrEmpty(r,_),d.shimParameterlessSetLocalDescription(r,_),c.shimGetUserMedia(r,_),c.shimPeerConnection(r,_),c.shimOnTrack(r,_),c.shimRemoveStream(r,_),c.shimSenderGetStats(r,_),c.shimReceiverGetStats(r,_),c.shimRTCDataChannel(r,_),c.shimAddTransceiver(r,_),c.shimGetParameters(r,_),c.shimCreateOffer(r,_),c.shimCreateAnswer(r,_),d.shimRTCIceCandidate(r,_),d.shimConnectionState(r,_),d.shimMaxMessageSize(r,_),d.shimSendThrowTypeError(r,_);break;case"safari":if(!l||!n.shimSafari){m("Safari shim is not included in this adapter release.");break}m("adapter.js shimming safari."),g.browserShim=l,d.shimAddIceCandidateNullOrEmpty(r,_),d.shimParameterlessSetLocalDescription(r,_),l.shimRTCIceServerUrls(r,_),l.shimCreateOfferLegacy(r,_),l.shimCallbacksAPI(r,_),l.shimLocalStreamsAPI(r,_),l.shimRemoteStreamsAPI(r,_),l.shimTrackEventTransceiver(r,_),l.shimGetUserMedia(r,_),l.shimAudioContext(r,_),d.shimRTCIceCandidate(r,_),d.shimRTCIceCandidateRelayProtocol(r,_),d.shimMaxMessageSize(r,_),d.shimSendThrowTypeError(r,_),d.removeExtmapAllowMixed(r,_);break;default:m("Unsupported browser!")}return g};var o=_interopRequireWildcard(n(17367)),a=_interopRequireWildcard(n(67251)),c=_interopRequireWildcard(n(90989)),l=_interopRequireWildcard(n(36126)),d=_interopRequireWildcard(n(83970)),f=_interopRequireWildcard(n(68507));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}},67251:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fixNegotiationNeeded=function(t,r){o.wrapPeerConnectionEvent(t,"negotiationneeded",function(t){var n=t.target;if(!(r.version<72)&&(!n.getConfiguration||"plan-b"!==n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return t})},r.shimAddTrackRemoveTrack=function(t,r){if(t.RTCPeerConnection){if(t.RTCPeerConnection.prototype.addTrack&&r.version>=65)return shimAddTrackRemoveTrackWithNative(t);var n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,r=n.apply(this);return this._reverseStreams=this._reverseStreams||{},r.map(function(r){return t._reverseStreams[r.id]})};var o=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(r){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.getTracks().forEach(function(t){if(n.getSenders().find(function(r){return r.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[r.id]){var a=new t.MediaStream(r.getTracks());this._streams[r.id]=a,this._reverseStreams[a.id]=r,r=a}o.apply(this,[r])};var a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},a.apply(this,[this._streams[t.id]||t]),delete this._reverseStreams[this._streams[t.id]?this._streams[t.id].id:t.id],delete this._streams[t.id]},t.RTCPeerConnection.prototype.addTrack=function(r,n){var o=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var a=[].slice.call(arguments,1);if(1!==a.length||!a[0].getTracks().find(function(t){return t===r}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(t){return t.track===r}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var c=this._streams[n.id];if(c)c.addTrack(r),Promise.resolve().then(function(){o.dispatchEvent(new Event("negotiationneeded"))});else{var l=new t.MediaStream([r]);this._streams[n.id]=l,this._reverseStreams[l.id]=n,this.addStream(l)}return this.getSenders().find(function(t){return t.track===r})},["createOffer","createAnswer"].forEach(function(r){var n=t.RTCPeerConnection.prototype[r],o=_defineProperty({},r,function(){var t=this,r=arguments,o=arguments.length&&"function"==typeof arguments[0];return o?n.apply(this,[function(n){var o=replaceInternalStreamId(t,n);r[0].apply(null,[o])},function(t){r[1]&&r[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(function(r){return replaceInternalStreamId(t,r)})});t.RTCPeerConnection.prototype[r]=o[r]});var c=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){var t,r,n;return arguments.length&&arguments[0].type&&(arguments[0]=(t=this,r=arguments[0],n=r.sdp,Object.keys(t._reverseStreams||[]).forEach(function(r){var o=t._reverseStreams[r],a=t._streams[o.id];n=n.replace(RegExp(o.id,"g"),a.id)}),new RTCSessionDescription({type:r.type,sdp:n}))),c.apply(this,arguments)};var l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get:function(){var t=l.get.apply(this);return""===t.type?t:replaceInternalStreamId(this,t)}}),t.RTCPeerConnection.prototype.removeTrack=function(t){var r,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(t._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(o){n._streams[o].getTracks().find(function(r){return t.track===r})&&(r=n._streams[o])}),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}}function replaceInternalStreamId(t,r){var n=r.sdp;return Object.keys(t._reverseStreams||[]).forEach(function(r){var o=t._reverseStreams[r],a=t._streams[o.id];n=n.replace(RegExp(a.id,"g"),o.id)}),new RTCSessionDescription({type:r.type,sdp:n})}},r.shimAddTrackRemoveTrackWithNative=shimAddTrackRemoveTrackWithNative,Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}}),r.shimGetSendersWithDtmf=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){var shimSenderWithDtmf=function(t,r){return{track:r,get dtmf(){return void 0===this._dtmf&&("audio"===r.kind?this._dtmf=t.createDTMFSender(r):this._dtmf=null),this._dtmf},_pc:t}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,n){var o=r.apply(this,arguments);return o||(o=shimSenderWithDtmf(this,t),this._senders.push(o)),o};var n=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){n.apply(this,arguments);var r=this._senders.indexOf(t);-1!==r&&this._senders.splice(r,1)}}var o=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._senders=this._senders||[],o.apply(this,[t]),t.getTracks().forEach(function(t){r._senders.push(shimSenderWithDtmf(r,t))})};var a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){var r=this;this._senders=this._senders||[],a.apply(this,[t]),t.getTracks().forEach(function(t){var n=r._senders.find(function(r){return r.track===t});n&&r._senders.splice(r._senders.indexOf(n),1)})}}else if("object"===_typeof(t)&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){var c=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){var t=this,r=c.apply(this,[]);return r.forEach(function(r){return r._pc=t}),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(t){if(t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var t=this,n=Array.prototype.slice.call(arguments),o=n[0],a=n[1],c=n[2];if(arguments.length>0&&"function"==typeof o)return r.apply(this,arguments);if(0===r.length&&(0==arguments.length||"function"!=typeof o))return r.apply(this,[]);var fixChromeStats_=function(t){var r={};return t.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(r){n[r]=t.stat(r)}),r[n.id]=n}),r},makeMapStats=function(t){return new Map(Object.keys(t).map(function(r){return[r,t[r]]}))};return arguments.length>=2?r.apply(this,[function(t){a(makeMapStats(fixChromeStats_(t)))},o]):new Promise(function(n,o){r.apply(t,[function(t){n(makeMapStats(fixChromeStats_(t)))},o])}).then(a,c)}}},Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),r.shimMediaStream=function(t){t.MediaStream=t.MediaStream||t.webkitMediaStream},r.shimOnTrack=function(t){if("object"!==_typeof(t)||!t.RTCPeerConnection||"ontrack"in t.RTCPeerConnection.prototype)o.wrapPeerConnectionEvent(t,"track",function(t){return t.transceiver||Object.defineProperty(t,"transceiver",{value:{receiver:t.receiver}}),t});else{Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(o){a=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(t){return t.track&&t.track.id===o.track.id}):{track:o.track};var a,c=new Event("track");c.track=o.track,c.receiver=a,c.transceiver={receiver:a},c.streams=[r.stream],n.dispatchEvent(c)}),r.stream.getTracks().forEach(function(o){a=t.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(t){return t.track&&t.track.id===o.id}):{track:o};var a,c=new Event("track");c.track=o,c.receiver=a,c.transceiver={receiver:a},c.streams=[r.stream],n.dispatchEvent(c)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}},r.shimPeerConnection=function(t,r){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){var n=t.RTCPeerConnection.prototype[r],o=_defineProperty({},r,function(){return arguments[0]=new("addIceCandidate"===r?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});t.RTCPeerConnection.prototype[r]=o[r]})},r.shimSenderReceiverGetStats=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver){if(!("getStats"in t.RTCRtpSender.prototype)){var r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=r.apply(this,[]);return n.forEach(function(r){return r._pc=t}),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return o.filterStats(r,t.track,!0)})}}if(!("getStats"in t.RTCRtpReceiver.prototype)){var a=t.RTCPeerConnection.prototype.getReceivers;a&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,r=a.apply(this,[]);return r.forEach(function(r){return r._pc=t}),r}),o.wrapPeerConnectionEvent(t,"track",function(t){return t.receiver._pc=t.srcElement,t}),t.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(r){return o.filterStats(r,t.track,!1)})}}if("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype){var c=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){var r,n,o,a=arguments[0];return(this.getSenders().forEach(function(t){t.track===a&&(r?o=!0:r=t)}),this.getReceivers().forEach(function(t){return t.track===a&&(n?o=!0:n=t),t.track===a}),o||r&&n)?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return c.apply(this,arguments)}}}};var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(17367)),a=n(26024),c=n(67772);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _defineProperty(t,r,n){var o;return(o=function(t,r){if("object"!==_typeof(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==_typeof(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(r,"string"),(r="symbol"===_typeof(o)?o:String(o))in t)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function shimAddTrackRemoveTrackWithNative(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(r){return t._shimmedLocalStreams[r][0]})};var r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(t,n){if(!n)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var o=r.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(o)&&this._shimmedLocalStreams[n.id].push(o):this._shimmedLocalStreams[n.id]=[n,o],o};var n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},t.getTracks().forEach(function(t){if(r.getSenders().find(function(r){return r.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var o=this.getSenders();n.apply(this,arguments);var a=this.getSenders().filter(function(t){return -1===o.indexOf(t)});this._shimmedLocalStreams[t.id]=[t].concat(a)};var o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(t){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[t.id],o.apply(this,arguments)};var a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(t){var r=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},t&&Object.keys(this._shimmedLocalStreams).forEach(function(n){var o=r._shimmedLocalStreams[n].indexOf(t);-1!==o&&r._shimmedLocalStreams[n].splice(o,1),1===r._shimmedLocalStreams[n].length&&delete r._shimmedLocalStreams[n]}),a.apply(this,arguments)}}},67772:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(t,r){if((!t.navigator.mediaDevices||!("getDisplayMedia"in t.navigator.mediaDevices))&&t.navigator.mediaDevices){if("function"!=typeof r){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(n){return r(n).then(function(r){var o=n.video&&n.video.width,a=n.video&&n.video.height,c=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxFrameRate:c||3}},o&&(n.video.mandatory.maxWidth=o),a&&(n.video.mandatory.maxHeight=a),t.navigator.mediaDevices.getUserMedia(n)})}}}},26024:(t,r,n)=>{"use strict";function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(t,r){var n=t&&t.navigator;if(n.mediaDevices){var constraintsToChrome_=function(t){if("object"!==_typeof(t)||t.mandatory||t.optional)return t;var r={};return Object.keys(t).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var o="object"===_typeof(t[n])?t[n]:{ideal:t[n]};void 0!==o.exact&&"number"==typeof o.exact&&(o.min=o.max=o.exact);var oldname_=function(t,r){return t?t+r.charAt(0).toUpperCase()+r.slice(1):"deviceId"===r?"sourceId":r};if(void 0!==o.ideal){r.optional=r.optional||[];var a={};"number"==typeof o.ideal?(a[oldname_("min",n)]=o.ideal,r.optional.push(a),(a={})[oldname_("max",n)]=o.ideal):a[oldname_("",n)]=o.ideal,r.optional.push(a)}void 0!==o.exact&&"number"!=typeof o.exact?(r.mandatory=r.mandatory||{},r.mandatory[oldname_("",n)]=o.exact):["min","max"].forEach(function(t){void 0!==o[t]&&(r.mandatory=r.mandatory||{},r.mandatory[oldname_(t,n)]=o[t])})}}),t.advanced&&(r.optional=(r.optional||[]).concat(t.advanced)),r},shimConstraints_=function(t,a){if(r.version>=61)return a(t);if((t=JSON.parse(JSON.stringify(t)))&&"object"===_typeof(t.audio)){var remap=function(t,r,n){r in t&&!(n in t)&&(t[n]=t[r],delete t[r])};remap((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","googAutoGainControl"),remap(t.audio,"noiseSuppression","googNoiseSuppression"),t.audio=constraintsToChrome_(t.audio)}if(t&&"object"===_typeof(t.video)){var c,l=t.video.facingMode;l=l&&("object"===_typeof(l)?l:{ideal:l});var d=r.version<66;if(l&&("user"===l.exact||"environment"===l.exact||"user"===l.ideal||"environment"===l.ideal)&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!d)&&(delete t.video.facingMode,"environment"===l.exact||"environment"===l.ideal?c=["back","rear"]:("user"===l.exact||"user"===l.ideal)&&(c=["front"]),c))return n.mediaDevices.enumerateDevices().then(function(r){var n=(r=r.filter(function(t){return"videoinput"===t.kind})).find(function(t){return c.some(function(r){return t.label.toLowerCase().includes(r)})});return!n&&r.length&&c.includes("back")&&(n=r[r.length-1]),n&&(t.video.deviceId=l.exact?{exact:n.deviceId}:{ideal:n.deviceId}),t.video=constraintsToChrome_(t.video),o("chrome: "+JSON.stringify(t)),a(t)});t.video=constraintsToChrome_(t.video)}return o("chrome: "+JSON.stringify(t)),a(t)},shimError_=function(t){return r.version>=64?t:{name:({PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"})[t.name]||t.name,message:t.message,constraint:t.constraint||t.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=(function(t,r,o){shimConstraints_(t,function(t){n.webkitGetUserMedia(t,r,function(t){o&&o(shimError_(t))})})}).bind(n),n.mediaDevices.getUserMedia){var a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return shimConstraints_(t,function(t){return a(t).then(function(r){if(t.audio&&!r.getAudioTracks().length||t.video&&!r.getVideoTracks().length)throw r.getTracks().forEach(function(t){t.stop()}),new DOMException("","NotFoundError");return r},function(t){return Promise.reject(shimError_(t))})})}}}};var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(17367)).log},83970:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.removeExtmapAllowMixed=function(t,r){if(t.RTCPeerConnection&&("chrome"!==r.browser||!(r.version>=71))&&("safari"!==r.browser||!(r.version>=605))){var n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&-1!==r.sdp.indexOf("\na=extmap-allow-mixed")){var o=r.sdp.split("\n").filter(function(t){return"a=extmap-allow-mixed"!==t.trim()}).join("\n");t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:o}):r.sdp=o}return n.apply(this,arguments)}}},r.shimAddIceCandidateNullOrEmpty=function(t,r){if(t.RTCPeerConnection&&t.RTCPeerConnection.prototype){var n=t.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===r.browser&&r.version<78||"firefox"===r.browser&&r.version<68||"safari"===r.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}},r.shimConnectionState=function(t){if(t.RTCPeerConnection&&!("connectionState"in t.RTCPeerConnection.prototype)){var r=t.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function(){return({completed:"connected",checking:"connecting"})[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(t){var n=r[t];r[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(t){var r=t.target;if(r._lastConnectionState!==r.connectionState){r._lastConnectionState=r.connectionState;var n=new Event("connectionstatechange",t);r.dispatchEvent(n)}return t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}},r.shimMaxMessageSize=function(t,r){if(t.RTCPeerConnection){"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var sctpInDescription=function(t){if(!t||!t.sdp)return!1;var r=o.default.splitSections(t.sdp);return r.shift(),r.some(function(t){var r=o.default.parseMLine(t);return r&&"application"===r.kind&&-1!==r.protocol.indexOf("SCTP")})},getRemoteFirefoxVersion=function(t){var r=t.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===r||r.length<2)return -1;var n=parseInt(r[1],10);return n!=n?-1:n},getCanSendMaxMessageSize=function(t){var n=65536;return"firefox"===r.browser&&(n=r.version<57?-1===t?16384:2147483637:r.version<60?57===r.version?65535:65536:2147483637),n},getMaxMessageSize=function(t,n){var a=65536;"firefox"===r.browser&&57===r.version&&(a=65535);var c=o.default.matchPrefix(t.sdp,"a=max-message-size:");return c.length>0?a=parseInt(c[0].substring(19),10):"firefox"===r.browser&&-1!==n&&(a=2147483637),a},n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===r.browser&&r.version>=76&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),sctpInDescription(arguments[0])){var t,o=getRemoteFirefoxVersion(arguments[0]),a=getCanSendMaxMessageSize(o),c=getMaxMessageSize(arguments[0],o);t=0===a&&0===c?Number.POSITIVE_INFINITY:0===a||0===c?Math.max(a,c):Math.min(a,c);var l={};Object.defineProperty(l,"maxMessageSize",{get:function(){return t}}),this._sctp=l}return n.apply(this,arguments)}}},r.shimParameterlessSetLocalDescription=function(t,r){if(t.RTCPeerConnection&&t.RTCPeerConnection.prototype){var n=t.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(t.RTCPeerConnection.prototype.setLocalDescription=function(){var t=this,r=arguments[0]||{};if("object"!==_typeof(r)||r.type&&r.sdp)return n.apply(this,arguments);if(!(r={type:r.type,sdp:r.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer"}return r.sdp||"offer"!==r.type&&"answer"!==r.type?n.apply(this,[r]):("offer"===r.type?this.createOffer:this.createAnswer).apply(this).then(function(r){return n.apply(t,[r])})})}},r.shimRTCIceCandidate=function(t){if(t.RTCIceCandidate&&(!t.RTCIceCandidate||!("foundation"in t.RTCIceCandidate.prototype))){var r=t.RTCIceCandidate;t.RTCIceCandidate=function(t){if("object"===_typeof(t)&&t.candidate&&0===t.candidate.indexOf("a=")&&((t=JSON.parse(JSON.stringify(t))).candidate=t.candidate.substring(2)),t.candidate&&t.candidate.length){var n=new r(t),a=o.default.parseCandidate(t.candidate);for(var c in a)c in n||Object.defineProperty(n,c,{value:a[c]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new r(t)},t.RTCIceCandidate.prototype=r.prototype,a.wrapPeerConnectionEvent(t,"icecandidate",function(r){return r.candidate&&Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"}),r})}},r.shimRTCIceCandidateRelayProtocol=function(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||a.wrapPeerConnectionEvent(t,"icecandidate",function(t){if(t.candidate){var r=o.default.parseCandidate(t.candidate.candidate);"relay"===r.type&&(t.candidate.relayProtocol=({0:"tls",1:"tcp",2:"udp"})[r.priority>>24])}return t})},r.shimSendThrowTypeError=function(t){if(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype){var r=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){var t=r.apply(this,arguments);return wrapDcSend(t,this),t},a.wrapPeerConnectionEvent(t,"datachannel",function(t){return wrapDcSend(t.channel,t.target),t})}function wrapDcSend(t,r){var n=t.send;t.send=function(){var o=arguments[0],a=o.length||o.size||o.byteLength;if("open"===t.readyState&&r.sctp&&a>r.sctp.maxMessageSize)throw TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return n.apply(t,arguments)}}};var o=function(t){return t&&t.__esModule?t:{default:t}}(n(68507)),a=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(17367));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},90989:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimAddTransceiver=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.addTransceiver;r&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var t,n=arguments[1]&&arguments[1].sendEncodings;void 0===n&&(n=[]);var o=(n=function(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t=n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(t,r)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).length>0;o&&n.forEach(function(t){if("rid"in t&&!/^[a-z0-9]{0,16}$/i.test(t.rid))throw TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in t&&!(parseFloat(t.scaleResolutionDownBy)>=1))throw RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in t&&!(parseFloat(t.maxFramerate)>=0))throw RangeError("max_framerate must be >= 0.0")});var a=r.apply(this,arguments);if(o){var c=a.sender,l=c.getParameters();"encodings"in l&&(1!==l.encodings.length||0!==Object.keys(l.encodings[0]).length)||(l.encodings=n,c.sendEncodings=n,this.setParametersPromises.push(c.setParameters(l).then(function(){delete c.sendEncodings}).catch(function(){delete c.sendEncodings})))}return a})}},r.shimCreateAnswer=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){var t=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return r.apply(n,t)}).finally(function(){n.setParametersPromises=[]}):r.apply(this,arguments)}}},r.shimCreateOffer=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){var t=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return r.apply(n,t)}).finally(function(){n.setParametersPromises=[]}):r.apply(this,arguments)}}},Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}}),r.shimGetParameters=function(t){if("object"===_typeof(t)&&t.RTCRtpSender){var r=t.RTCRtpSender.prototype.getParameters;r&&(t.RTCRtpSender.prototype.getParameters=function(){var t=r.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}},Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),r.shimOnTrack=function(t){"object"===_typeof(t)&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(t,r){if("object"===_typeof(t)&&(t.RTCPeerConnection||t.mozRTCPeerConnection)){!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){var n,o,a,c,l=t.RTCPeerConnection.prototype[r],d=(o={},a=r,c=function(){return arguments[0]=new("addIceCandidate"===r?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)},(n=function(t,r){if("object"!==_typeof(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==_typeof(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(a,"string"),(a="symbol"===_typeof(n)?n:String(n))in o)?Object.defineProperty(o,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[a]=c,o);t.RTCPeerConnection.prototype[r]=d[r]});var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){var t=Array.prototype.slice.call(arguments),a=t[0],c=t[1],l=t[2];return o.apply(this,[a||null]).then(function(t){if(r.version<53&&!c)try{t.forEach(function(t){t.type=n[t.type]||t.type})}catch(r){if("TypeError"!==r.name)throw r;t.forEach(function(r,o){t.set(o,Object.assign({},r,{type:n[r.type]||r.type}))})}return t}).then(c,l)}}},r.shimRTCDataChannel=function(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)},r.shimReceiverGetStats=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpReceiver.prototype))){var r=t.RTCPeerConnection.prototype.getReceivers;r&&(t.RTCPeerConnection.prototype.getReceivers=function(){var t=this,n=r.apply(this,[]);return n.forEach(function(r){return r._pc=t}),n}),o.wrapPeerConnectionEvent(t,"track",function(t){return t.receiver._pc=t.srcElement,t}),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var r=this;o.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&t.getTracks().includes(n.track)&&r.removeTrack(n)})})},r.shimSenderGetStats=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection&&t.RTCRtpSender&&(!t.RTCRtpSender||!("getStats"in t.RTCRtpSender.prototype))){var r=t.RTCPeerConnection.prototype.getSenders;r&&(t.RTCPeerConnection.prototype.getSenders=function(){var t=this,n=r.apply(this,[]);return n.forEach(function(r){return r._pc=t}),n});var n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){var t=n.apply(this,arguments);return t._pc=this,t}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}};var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(17367)),a=n(54640),c=n(94868);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,o=Array(r);n<r;n++)o[n]=t[n];return o}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},94868:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(t,r){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||!t.navigator.mediaDevices||(t.navigator.mediaDevices.getDisplayMedia=function(n){if(!(n&&n.video)){var o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return!0===n.video?n.video={mediaSource:r}:n.video.mediaSource=r,t.navigator.mediaDevices.getUserMedia(n)})}},54640:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(t,r){var n=t&&t.navigator,a=t&&t.MediaStreamTrack;if(n.getUserMedia=function(t,r,a){o.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(t).then(r,a)},!(r.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var remap=function(t,r,n){r in t&&!(n in t)&&(t[n]=t[r],delete t[r])},c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(t){return"object"===_typeof(t)&&"object"===_typeof(t.audio)&&(remap((t=JSON.parse(JSON.stringify(t))).audio,"autoGainControl","mozAutoGainControl"),remap(t.audio,"noiseSuppression","mozNoiseSuppression")),c(t)},a&&a.prototype.getSettings){var l=a.prototype.getSettings;a.prototype.getSettings=function(){var t=l.apply(this,arguments);return remap(t,"mozAutoGainControl","autoGainControl"),remap(t,"mozNoiseSuppression","noiseSuppression"),t}}if(a&&a.prototype.applyConstraints){var d=a.prototype.applyConstraints;a.prototype.applyConstraints=function(t){return"audio"===this.kind&&"object"===_typeof(t)&&(remap(t=JSON.parse(JSON.stringify(t)),"autoGainControl","mozAutoGainControl"),remap(t,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[t])}}}};var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(17367));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}},36126:(t,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimAudioContext=function(t){"object"!==_typeof(t)||t.AudioContext||(t.AudioContext=t.webkitAudioContext)},r.shimCallbacksAPI=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection){var r=t.RTCPeerConnection.prototype,n=r.createOffer,o=r.createAnswer,a=r.setLocalDescription,c=r.setRemoteDescription,l=r.addIceCandidate;r.createOffer=function(t,r){var o=arguments.length>=2?arguments[2]:arguments[0],a=n.apply(this,[o]);return r?(a.then(t,r),Promise.resolve()):a},r.createAnswer=function(t,r){var n=arguments.length>=2?arguments[2]:arguments[0],a=o.apply(this,[n]);return r?(a.then(t,r),Promise.resolve()):a};var withCallback=function(t,r,n){var o=a.apply(this,[t]);return n?(o.then(r,n),Promise.resolve()):o};r.setLocalDescription=withCallback,withCallback=function(t,r,n){var o=c.apply(this,[t]);return n?(o.then(r,n),Promise.resolve()):o},r.setRemoteDescription=withCallback,withCallback=function(t,r,n){var o=l.apply(this,[t]);return n?(o.then(r,n),Promise.resolve()):o},r.addIceCandidate=withCallback}},r.shimConstraints=shimConstraints,r.shimCreateOfferLegacy=function(t){var r=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(t){if(t){void 0!==t.offerToReceiveAudio&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);var n=this.getTransceivers().find(function(t){return"audio"===t.receiver.track.kind});!1===t.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==t.offerToReceiveAudio||n||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==t.offerToReceiveVideo&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);var o=this.getTransceivers().find(function(t){return"video"===t.receiver.track.kind});!1===t.offerToReceiveVideo&&o?"sendrecv"===o.direction?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":"recvonly"===o.direction&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):!0!==t.offerToReceiveVideo||o||this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}},r.shimGetUserMedia=function(t){var r=t&&t.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){var n=r.mediaDevices,o=n.getUserMedia.bind(n);r.mediaDevices.getUserMedia=function(t){return o(shimConstraints(t))}}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function(t,n,o){r.mediaDevices.getUserMedia(t).then(n,o)}).bind(r))},r.shimLocalStreamsAPI=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){var r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(t){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(function(o){return r.call(n,o,t)}),t.getVideoTracks().forEach(function(o){return r.call(n,o,t)})},t.RTCPeerConnection.prototype.addTrack=function(t){for(var n=this,o=arguments.length,a=Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return a&&a.forEach(function(t){n._localStreams?n._localStreams.includes(t)||n._localStreams.push(t):n._localStreams=[t]}),r.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(t){var r=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(t);if(-1!==n){this._localStreams.splice(n,1);var o=t.getTracks();this.getSenders().forEach(function(t){o.includes(t.track)&&r.removeTrack(t)})}})}},r.shimRTCIceServerUrls=function(t){if(t.RTCPeerConnection){var r=t.RTCPeerConnection;t.RTCPeerConnection=function(t,n){if(t&&t.iceServers){for(var a=[],c=0;c<t.iceServers.length;c++){var l=t.iceServers[c];void 0===l.urls&&l.url?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(l=JSON.parse(JSON.stringify(l))).urls=l.url,delete l.url,a.push(l)):a.push(t.iceServers[c])}t.iceServers=a}return new r(t,n)},t.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get:function(){return r.generateCertificate}})}},r.shimRemoteStreamsAPI=function(t){if("object"===_typeof(t)&&t.RTCPeerConnection&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(t){var r=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(r._remoteStreams||(r._remoteStreams=[]),!r._remoteStreams.includes(t)){r._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,r.dispatchEvent(n)}})})}});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(function(r){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(r)>=0)){t._remoteStreams.push(r);var n=new Event("addstream");n.stream=r,t.dispatchEvent(n)}})}),r.apply(t,arguments)}}},r.shimTrackEventTransceiver=function(t){"object"===_typeof(t)&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})};var o=function(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(r);if(n&&n.has(t))return n.get(t);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in t)if("default"!==c&&Object.prototype.hasOwnProperty.call(t,c)){var l=a?Object.getOwnPropertyDescriptor(t,c):null;l&&(l.get||l.set)?Object.defineProperty(o,c,l):o[c]=t[c]}return o.default=t,n&&n.set(t,o),o}(n(17367));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:r})(t)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function shimConstraints(t){return t&&void 0!==t.video?Object.assign({},t,{video:o.compactObject(t.video)}):t}},17367:(t,r)=>{"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.compactObject=function compactObject(t){return isObject(t)?Object.keys(t).reduce(function(r,n){var o,a,c,l=isObject(t[n]),d=l?compactObject(t[n]):t[n],f=l&&!Object.keys(d).length;return void 0===d||f?r:Object.assign(r,(a={},(o=function(t,r){if("object"!==_typeof(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==_typeof(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(c=n,"string"),(c="symbol"===_typeof(o)?o:String(o))in a)?Object.defineProperty(a,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d,a))},{}):t},r.deprecated=function(t,r){o&&console.warn(t+" is deprecated, please use "+r+" instead.")},r.detectBrowser=function(t){var r={browser:null,version:null};if(void 0===t||!t.navigator||!t.navigator.userAgent)return r.browser="Not a browser.",r;var n=t.navigator;return n.mozGetUserMedia?(r.browser="firefox",r.version=extractVersion(n.userAgent,/Firefox\/(\d+)\./,1)):n.webkitGetUserMedia||!1===t.isSecureContext&&t.webkitRTCPeerConnection?(r.browser="chrome",r.version=extractVersion(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./)?(r.browser="safari",r.version=extractVersion(n.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype):r.browser="Not a supported browser.",r},r.disableLog=function(t){return"boolean"!=typeof t?Error("Argument type: "+_typeof(t)+". Please use a boolean."):(n=t,t?"adapter.js logging disabled":"adapter.js logging enabled")},r.disableWarnings=function(t){return"boolean"!=typeof t?Error("Argument type: "+_typeof(t)+". Please use a boolean."):(o=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))},r.extractVersion=extractVersion,r.filterStats=function(t,r,n){var o=n?"outbound-rtp":"inbound-rtp",a=new Map;if(null===r)return a;var c=[];return t.forEach(function(t){"track"===t.type&&t.trackIdentifier===r.id&&c.push(t)}),c.forEach(function(r){t.forEach(function(n){n.type===o&&n.trackId===r.id&&walkStats(t,n,a)})}),a},r.log=function(){("undefined"==typeof window?"undefined":_typeof(window))!=="object"||n||"undefined"==typeof console||"function"!=typeof console.log||console.log.apply(console,arguments)},r.walkStats=walkStats,r.wrapPeerConnectionEvent=function(t,r,n){if(t.RTCPeerConnection){var o=t.RTCPeerConnection.prototype,a=o.addEventListener;o.addEventListener=function(t,o){if(t!==r)return a.apply(this,arguments);var wrappedCallback=function(t){var r=n(t);r&&(o.handleEvent?o.handleEvent(r):o(r))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(o,wrappedCallback),a.apply(this,[t,wrappedCallback])};var c=o.removeEventListener;o.removeEventListener=function(t,n){if(t!==r||!this._eventMap||!this._eventMap[r]||!this._eventMap[r].has(n))return c.apply(this,arguments);var o=this._eventMap[r].get(n);return this._eventMap[r].delete(n),0===this._eventMap[r].size&&delete this._eventMap[r],0===Object.keys(this._eventMap).length&&delete this._eventMap,c.apply(this,[t,o])},Object.defineProperty(o,"on"+r,{get:function(){return this["_on"+r]},set:function(t){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),t&&this.addEventListener(r,this["_on"+r]=t)},enumerable:!0,configurable:!0})}};var n=!0,o=!0;function extractVersion(t,r,n){var o=t.match(r);return o&&o.length>=n&&parseInt(o[n],10)}function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}function walkStats(t,r,n){!r||n.has(r.id)||(n.set(r.id,r),Object.keys(r).forEach(function(o){o.endsWith("Id")?walkStats(t,t.get(r[o]),n):o.endsWith("Ids")&&r[o].forEach(function(r){walkStats(t,t.get(r),n)})}))}},90584:(t,r,n)=>{/**
 * Wrapper for built-in http.js to emulate the browser XMLHttpRequest object.
 *
 * This can be used with JS designed for browsers to improve reuse of code and
 * allow the use of existing libraries.
 *
 * Usage: include("XMLHttpRequest.js") and use XMLHttpRequest per W3C specs.
 *
 * @author Dan DeFelippi <dan@driverdan.com>
 * @contributor David Ellis <d.f.ellis@ieee.org>
 * @license MIT
 */var o=n(57147),a=n(57310),c=n(32081).spawn;function XMLHttpRequest(t){"use strict";t=t||{};var r,l,d=this,f=n(13685),m=n(95687),_={},g=!1,y={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},b=Object.assign({},y),S=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],E=["TRACE","TRACK","CONNECT"],w=!1,T=!1,O=!1,R={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.open=function(t,r,n,o,a){if(this.abort(),T=!1,O=!1,!(t&&-1===E.indexOf(t)))throw Error("SecurityError: Request method not allowed");_={method:t,url:r.toString(),async:"boolean"!=typeof n||n,user:o||null,password:a||null},setState(this.OPENED)},this.setDisableHeaderCheck=function(t){g=t},this.setRequestHeader=function(t,r){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!g&&(!t||-1!==S.indexOf(t.toLowerCase())))return console.warn('Refused to set unsafe header "'+t+'"'),!1;if(w)throw Error("INVALID_STATE_ERR: send flag is true");return b[t]=r,!0},this.getResponseHeader=function(t){return"string"==typeof t&&this.readyState>this.OPENED&&l.headers[t.toLowerCase()]&&!T?l.headers[t.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||T)return"";var t="";for(var r in l.headers)"set-cookie"!==r&&"set-cookie2"!==r&&(t+=r+": "+l.headers[r]+"\r\n");return t.substr(0,t.length-2)},this.getRequestHeader=function(t){return"string"==typeof t&&b[t]?b[t]:""},this.send=function(n){if(this.readyState!=this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(w)throw Error("INVALID_STATE_ERR: send has already been called");var g,y=!1,S=!1,E=a.parse(_.url);switch(E.protocol){case"https:":y=!0;case"http:":g=E.hostname;break;case"file:":S=!0;break;case void 0:case"":g="localhost";break;default:throw Error("Protocol not supported.")}if(S){if("GET"!==_.method)throw Error("XMLHttpRequest: Only GET method is supported");if(_.async)o.readFile(unescape(E.pathname),"utf8",function(t,r){t?d.handleError(t,t.errno||-1):(d.status=200,d.responseText=r,setState(d.DONE))});else try{this.responseText=o.readFileSync(unescape(E.pathname),"utf8"),this.status=200,setState(d.DONE)}catch(t){this.handleError(t,t.errno||-1)}return}var O=E.port||(y?443:80),R=E.pathname+(E.search?E.search:"");if(b.Host=g,y&&443===O||80===O||(b.Host+=":"+E.port),_.user){void 0===_.password&&(_.password="");var x=new Buffer(_.user+":"+_.password);b.Authorization="Basic "+x.toString("base64")}"GET"===_.method||"HEAD"===_.method?n=null:n?(b["Content-Length"]=Buffer.isBuffer(n)?n.length:Buffer.byteLength(n),b["Content-Type"]||(b["Content-Type"]="text/plain;charset=UTF-8")):"POST"===_.method&&(b["Content-Length"]=0);var P=t.agent||!1,A={host:g,port:O,path:R,method:_.method,headers:b,agent:P};if(y&&(A.pfx=t.pfx,A.key=t.key,A.passphrase=t.passphrase,A.cert=t.cert,A.ca=t.ca,A.ciphers=t.ciphers,A.rejectUnauthorized=!1!==t.rejectUnauthorized),T=!1,_.async){var M=y?m.request:f.request;w=!0,d.dispatchEvent("readystatechange");var responseHandler=function(n){if(302===(l=n).statusCode||303===l.statusCode||307===l.statusCode){_.url=l.headers.location;var o=a.parse(_.url);g=o.hostname;var c={hostname:o.hostname,port:o.port,path:o.path,method:303===l.statusCode?"GET":_.method,headers:b};y&&(c.pfx=t.pfx,c.key=t.key,c.passphrase=t.passphrase,c.cert=t.cert,c.ca=t.ca,c.ciphers=t.ciphers,c.rejectUnauthorized=!1!==t.rejectUnauthorized),(r=M(c,responseHandler).on("error",errorHandler)).end();return}l&&l.setEncoding&&l.setEncoding("utf8"),setState(d.HEADERS_RECEIVED),d.status=l.statusCode,l.on("data",function(t){t&&(d.responseText+=t),w&&setState(d.LOADING)}),l.on("end",function(){w&&(w=!1,setState(d.DONE))}),l.on("error",function(t){d.handleError(t)})},errorHandler=function(t){d.handleError(t)};r=M(A,responseHandler).on("error",errorHandler),t.autoUnref&&r.on("socket",t=>{t.unref()}),n&&r.write(n),r.end(),d.dispatchEvent("loadstart")}else{var D=".node-xmlhttprequest-content-"+process.pid,I=".node-xmlhttprequest-sync-"+process.pid;o.writeFileSync(I,"","utf8");for(var j="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(y?"s":"")+".request;var options = "+JSON.stringify(A)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+D+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+I+"');});response.on('error', function(error) {fs.writeFileSync('"+D+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+I+"');});}).on('error', function(error) {fs.writeFileSync('"+D+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+I+"');});"+(n?"req.write('"+JSON.stringify(n).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",B=c(process.argv[0],["-e",j]);o.existsSync(I););if(d.responseText=o.readFileSync(D,"utf8"),B.stdin.end(),o.unlinkSync(D),d.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var U=d.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");d.handleError(U,503)}else d.status=d.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),d.responseText=d.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),setState(d.DONE)}},this.handleError=function(t,r){this.status=r||0,this.statusText=t,this.responseText=t.stack,T=!0,setState(this.DONE)},this.abort=function(){r&&(r.abort(),r=null),b=Object.assign({},y),this.responseText="",this.responseXML="",T=O=!0,this.readyState!==this.UNSENT&&(this.readyState!==this.OPENED||w)&&this.readyState!==this.DONE&&(w=!1,setState(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(t,r){t in R||(R[t]=[]),R[t].push(r)},this.removeEventListener=function(t,r){t in R&&(R[t]=R[t].filter(function(t){return t!==r}))},this.dispatchEvent=function(t){if("function"==typeof d["on"+t]&&(this.readyState===this.DONE?setImmediate(function(){d["on"+t]()}):d["on"+t]()),t in R)for(let r=0,n=R[t].length;r<n;r++)this.readyState===this.DONE?setImmediate(function(){R[t][r].call(d)}):R[t][r].call(d)};var setState=function(t){if(d.readyState!==t&&(d.readyState!==d.UNSENT||!O)&&(d.readyState=t,(_.async||d.readyState<d.OPENED||d.readyState===d.DONE)&&d.dispatchEvent("readystatechange"),d.readyState===d.DONE)){let t;t=O?"abort":T?"error":"load",d.dispatchEvent(t),d.dispatchEvent("loadend")}}}t.exports=XMLHttpRequest,XMLHttpRequest.XMLHttpRequest=XMLHttpRequest},68793:(t,r,n)=>{"use strict";let o,a,c,l,d,f,m,_,g,y,b,S,E,w,T,O,R;var x,P=n(12781);n(98188);try{o=new TextDecoder}catch(t){}let A=0,M=[],D={},I=M,j=0,B={},U=0,N=0,F=[],$=[],V={useRecords:!1,mapsAsObjects:!0},W=!1,z=2;try{Function("")}catch(t){z=1/0}let Decoder=class Decoder{constructor(t){if(t&&((t.keyMap||t._keyMap)&&!t.useRecords&&(t.useRecords=!1,t.mapsAsObjects=!0),!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.getStructures&&(t.getShared=t.getStructures),t.getShared&&!t.structures&&((t.structures=[]).uninitialized=!0),t.keyMap))for(let[r,n]of(this.mapKey=new Map,Object.entries(t.keyMap)))this.mapKey.set(n,r);Object.assign(this,t)}decodeKey(t){return this.keyMap&&this.mapKey.get(t)||t}encodeKey(t){return this.keyMap&&this.keyMap.hasOwnProperty(t)?this.keyMap[t]:t}encodeKeys(t){if(!this._keyMap)return t;let r=new Map;for(let[n,o]of Object.entries(t))r.set(this._keyMap.hasOwnProperty(n)?this._keyMap[n]:n,o);return r}decodeKeys(t){if(!this._keyMap||"Map"!=t.constructor.name)return t;if(!this._mapKey)for(let[t,r]of(this._mapKey=new Map,Object.entries(this._keyMap)))this._mapKey.set(r,t);let r={};return t.forEach((t,n)=>r[safeKey(this._mapKey.has(n)?this._mapKey.get(n):n)]=t),r}mapDecode(t,r){let n=this.decode(t);return this._keyMap&&"Array"===n.constructor.name?n.map(t=>this.decodeKeys(t)):n}decode(t,r){if(a)return saveState(()=>(clearSource(),this?this.decode(t,r):Decoder.prototype.decode.call(V,t,r)));c=r>-1?r:t.length,A=0,j=0,N=0,d=null,I=M,f=null,a=t;try{g=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(r){if(a=null,t instanceof Uint8Array)throw r;throw Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}return this instanceof Decoder?(B=this,_=this.sharedValues&&(this.pack?Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures?l=this.structures:(!l||l.length>0)&&(l=[])):(B=V,(!l||l.length>0)&&(l=[]),_=null),checkedRead()}decodeMultiple(t,r){let n,o=0;try{let a=t.length;W=!0;let c=this?this.decode(t,a):et.decode(t,a);if(r){if(!1===r(c))return;for(;A<a;)if(o=A,!1===r(checkedRead()))return}else{for(n=[c];A<a;)o=A,n.push(checkedRead());return n}}catch(t){throw t.lastPosition=o,t.values=n,t}finally{W=!1,clearSource()}}};function checkedRead(){try{let t=read();if(f){if(A>=f.postBundlePosition){let t=Error("Unexpected bundle position");throw t.incomplete=!0,t}A=f.postBundlePosition,f=null}if(A==c)l=null,a=null,m&&(m=null);else if(A>c){let t=Error("Unexpected end of CBOR data");throw t.incomplete=!0,t}else if(!W)throw Error("Data read, but end of buffer not reached");return t}catch(t){throw clearSource(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function read(){let t=a[A++],r=t>>5;if((t&=31)>23)switch(t){case 24:t=a[A++];break;case 25:if(7==r)return function(){let t=a[A++],r=a[A++],n=(127&t)>>2;if(31===n)return r||3&t?NaN:128&t?-1/0:1/0;if(0===n){let n=((3&t)<<8|r)/16777216;return 128&t?-n:n}return J[3]=128&t|(n>>1)+56,J[2]=(7&t)<<5|r>>3,J[1]=r<<5,J[0]=0,K[0]}();t=g.getUint16(A),A+=2;break;case 26:if(7==r){let t=g.getFloat32(A);if(B.useFloat32>2){let r=ee[(127&a[A])<<1|a[A+1]>>7];return A+=4,(r*t+(t>0?.5:-.5)>>0)/r}return A+=4,t}t=g.getUint32(A),A+=4;break;case 27:if(7==r){let t=g.getFloat64(A);return A+=8,t}if(r>1){if(g.getUint32(A)>0)throw Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=g.getUint32(A+4)}else t=B.int64AsNumber?4294967296*g.getUint32(A)+g.getUint32(A+4):g.getBigUint64(A);A+=8;break;case 31:switch(r){case 2:case 3:throw Error("Indefinite length not supported for byte or text strings");case 4:let n=[],o,m=0;for(;(o=read())!=D;)n[m++]=o;return 4==r?n:3==r?n.join(""):Buffer.concat(n);case 5:let b;if(B.mapsAsObjects){let t={};if(B.keyMap)for(;(b=read())!=D;)t[safeKey(B.decodeKey(b))]=read();else for(;(b=read())!=D;)t[safeKey(b)]=read();return t}{y&&(B.mapsAsObjects=!0,y=!1);let t=new Map;if(B.keyMap)for(;(b=read())!=D;)t.set(B.decodeKey(b),read());else for(;(b=read())!=D;)t.set(b,read());return t}case 7:return D;default:throw Error("Invalid major type for indefinite length "+r)}default:throw Error("Unknown token "+t)}switch(r){case 0:return t;case 1:return~t;case 2:var S;return S=t,B.copyBuffers?Uint8Array.prototype.slice.call(a,A,A+=S):a.subarray(A,A+=S);case 3:if(N>=A)return d.slice(A-U,(A+=t)-U);if(0==N&&c<140&&t<32){let r=t<16?shortStringInJS(t):function(t){let r=A,n=Array(t);for(let o=0;o<t;o++){let t=a[A++];if((128&t)>0){A=r;return}n[o]=t}return H.apply(String,n)}(t);if(null!=r)return r}return q(t);case 4:let E=Array(t);for(let r=0;r<t;r++)E[r]=read();return E;case 5:if(B.mapsAsObjects){let r={};if(B.keyMap)for(let n=0;n<t;n++)r[safeKey(B.decodeKey(read()))]=read();else for(let n=0;n<t;n++)r[safeKey(read())]=read();return r}{y&&(B.mapsAsObjects=!0,y=!1);let r=new Map;if(B.keyMap)for(let n=0;n<t;n++)r.set(B.decodeKey(read()),read());else for(let n=0;n<t;n++)r.set(read(),read());return r}case 6:if(t>=57337){let r=l[8191&t];if(r)return r.read||(r.read=createStructureReader(r)),r.read();if(t<65536){if(57343==t){let t=readJustLength(),r=read(),n=read();recordDefinition(r,n);let o={};if(B.keyMap)for(let r=2;r<t;r++)o[safeKey(B.decodeKey(n[r-2]))]=read();else for(let r=2;r<t;r++)o[safeKey(n[r-2])]=read();return o}if(57342==t){let t=readJustLength(),r=read();for(let n=2;n<t;n++)recordDefinition(r++,read());return read()}if(57337==t)return function(){let t=readJustLength(),r=A+read();for(let r=2;r<t;r++){let t=readJustLength();A+=t}let n=A;return A=r,(f=[readStringJS(readJustLength()),readStringJS(readJustLength())]).position0=0,f.position1=0,f.postBundlePosition=A,A=n,read()}();if(B.getShared&&(loadShared(),r=l[8191&t]))return r.read||(r.read=createStructureReader(r)),r.read()}}let w=F[t];if(w){if(w.handlesRead)return w(read);return w(read())}{let r=read();for(let n=0;n<$.length;n++){let o=$[n](t,r);if(void 0!==o)return o}return new Tag(r,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;default:let T=(_||getPackedValues())[t];if(void 0!==T)return T;throw Error("Unknown token "+t)}default:if(isNaN(t)){let t=Error("Unexpected end of CBOR data");throw t.incomplete=!0,t}throw Error("Unknown CBOR token "+t)}}let G=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function createStructureReader(t){return t.slowReads=0,function(){let t=a[A++];if((t&=31)>23)switch(t){case 24:t=a[A++];break;case 25:t=g.getUint16(A),A+=2;break;case 26:t=g.getUint32(A),A+=4;break;default:throw Error("Expected array header, but got "+a[A-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===t)return r(read);r=r.next}if(this.slowReads++>=z){let n=this.length==t?this:this.slice(0,t);return r=B.keyMap?Function("r","return {"+n.map(t=>B.decodeKey(t)).map(t=>G.test(t)?safeKey(t)+":r()":"["+JSON.stringify(t)+"]:r()").join(",")+"}"):Function("r","return {"+n.map(t=>G.test(t)?safeKey(t)+":r()":"["+JSON.stringify(t)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=t,this.compiledReader=r,r(read)}let n={};if(B.keyMap)for(let r=0;r<t;r++)n[safeKey(B.decodeKey(this[r]))]=read();else for(let r=0;r<t;r++)n[safeKey(this[r])]=read();return n}}function safeKey(t){return"__proto__"===t?"__proto_":t}let q=readStringJS;function readStringJS(t){let r;if(t<16&&(r=shortStringInJS(t)))return r;if(t>64&&o)return o.decode(a.subarray(A,A+=t));let n=A+t,c=[];for(r="";A<n;){let t=a[A++];if((128&t)==0)c.push(t);else if((224&t)==192){let r=63&a[A++];c.push((31&t)<<6|r)}else if((240&t)==224){let r=63&a[A++],n=63&a[A++];c.push((31&t)<<12|r<<6|n)}else if((248&t)==240){let r=63&a[A++],n=63&a[A++],o=63&a[A++],l=(7&t)<<18|r<<12|n<<6|o;l>65535&&(l-=65536,c.push(l>>>10&1023|55296),l=56320|1023&l),c.push(l)}else c.push(t);c.length>=4096&&(r+=H.apply(String,c),c.length=0)}return c.length>0&&(r+=H.apply(String,c)),r}r.isNativeAccelerationEnabled=!1;let H=String.fromCharCode;function shortStringInJS(t){if(t<4){if(t<2){if(0===t)return"";{let t=a[A++];if((128&t)>1){A-=1;return}return H(t)}}{let r=a[A++],n=a[A++];if((128&r)>0||(128&n)>0){A-=2;return}if(t<3)return H(r,n);let o=a[A++];if((128&o)>0){A-=3;return}return H(r,n,o)}}{let r=a[A++],n=a[A++],o=a[A++],c=a[A++];if((128&r)>0||(128&n)>0||(128&o)>0||(128&c)>0){A-=4;return}if(t<6){if(4===t)return H(r,n,o,c);{let t=a[A++];if((128&t)>0){A-=5;return}return H(r,n,o,c,t)}}if(t<8){let l=a[A++],d=a[A++];if((128&l)>0||(128&d)>0){A-=6;return}if(t<7)return H(r,n,o,c,l,d);let f=a[A++];if((128&f)>0){A-=7;return}return H(r,n,o,c,l,d,f)}{let l=a[A++],d=a[A++],f=a[A++],m=a[A++];if((128&l)>0||(128&d)>0||(128&f)>0||(128&m)>0){A-=8;return}if(t<10){if(8===t)return H(r,n,o,c,l,d,f,m);{let t=a[A++];if((128&t)>0){A-=9;return}return H(r,n,o,c,l,d,f,m,t)}}if(t<12){let _=a[A++],g=a[A++];if((128&_)>0||(128&g)>0){A-=10;return}if(t<11)return H(r,n,o,c,l,d,f,m,_,g);let y=a[A++];if((128&y)>0){A-=11;return}return H(r,n,o,c,l,d,f,m,_,g,y)}{let _=a[A++],g=a[A++],y=a[A++],b=a[A++];if((128&_)>0||(128&g)>0||(128&y)>0||(128&b)>0){A-=12;return}if(t<14){if(12===t)return H(r,n,o,c,l,d,f,m,_,g,y,b);{let t=a[A++];if((128&t)>0){A-=13;return}return H(r,n,o,c,l,d,f,m,_,g,y,b,t)}}{let S=a[A++],E=a[A++];if((128&S)>0||(128&E)>0){A-=14;return}if(t<15)return H(r,n,o,c,l,d,f,m,_,g,y,b,S,E);let w=a[A++];if((128&w)>0){A-=15;return}return H(r,n,o,c,l,d,f,m,_,g,y,b,S,E,w)}}}}}let K=new Float32Array(1),J=new Uint8Array(K.buffer,0,4);let Tag=class Tag{constructor(t,r){this.value=t,this.tag=r}};F[0]=t=>new Date(t),F[1]=t=>new Date(Math.round(1e3*t)),F[2]=t=>{let r=BigInt(0);for(let n=0,o=t.byteLength;n<o;n++)r=BigInt(t[n])+r<<BigInt(8);return r},F[3]=t=>BigInt(-1)-F[2](t),F[4]=t=>+(t[1]+"e"+t[0]),F[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));let recordDefinition=(t,r)=>{let n=l[t-=57344];n&&n.isShared&&((l.restoreStructures||(l.restoreStructures=[]))[t]=n),l[t]=r,r.read=createStructureReader(r)};F[105]=t=>{let r=t.length,n=t[1];recordDefinition(t[0],n);let o={};for(let a=2;a<r;a++)o[safeKey(n[a-2])]=t[a];return o},F[14]=t=>f?f[0].slice(f.position0,f.position0+=t):new Tag(t,14),F[15]=t=>f?f[1].slice(f.position1,f.position1+=t):new Tag(t,15);let X={Error,RegExp};F[27]=t=>(X[t[0]]||Error)(t[1],t[2]);let packedTable=t=>{if(132!=a[A++])throw Error("Packed values structure must be followed by a 4 element array");let r=t();return(_=_?r.concat(_.slice(r.length)):r).prefixes=t(),_.suffixes=t(),t()};function combine(t,r){return"string"==typeof t?t+r:t instanceof Array?t.concat(r):Object.assign({},t,r)}function getPackedValues(){if(!_){if(B.getShared)loadShared();else throw Error("No packed values available")}return _}packedTable.handlesRead=!0,F[51]=packedTable,F[6]=t=>{if(!_){if(!B.getShared)return new Tag(t,6);loadShared()}if("number"==typeof t)return _[16+(t>=0?2*t:-2*t-1)];throw Error("No support for non-integer packed references yet")},F[28]=t=>{let r;m||((m=new Map).id=0);let n=m.id++,o={target:r=a[A]>>5==4?[]:{}};m.set(n,o);let c=t();return o.used?Object.assign(r,c):(o.target=c,c)},F[28].handlesRead=!0,F[29]=t=>{let r=m.get(t);return r.used=!0,r.target},F[258]=t=>new Set(t),(F[259]=t=>(B.mapsAsObjects&&(B.mapsAsObjects=!1,y=!0),t())).handlesRead=!0,$.push((t,r)=>t>=225&&t<=255?combine(getPackedValues().prefixes[t-224],r):t>=28704&&t<=32767?combine(getPackedValues().prefixes[t-28672],r):t>=1879052288&&t<=2147483647?combine(getPackedValues().prefixes[t-1879048192],r):t>=216&&t<=223?combine(r,getPackedValues().suffixes[t-216]):t>=27647&&t<=28671?combine(r,getPackedValues().suffixes[t-27639]):t>=1811940352&&t<=1879048191?combine(r,getPackedValues().suffixes[t-1811939328]):1399353956==t?{packedValues:_,structures:l.slice(0),version:r}:55799==t?r:void 0);let Y=1==new Uint8Array(new Uint16Array([1]).buffer)[0],Z=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,"undefined"==typeof BigUint64Array?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,"undefined"==typeof BigInt64Array?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],Q=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<Z.length;t++)(function(t,r){let n,o="get"+t.name.slice(0,-5);"function"==typeof t?n=t.BYTES_PER_ELEMENT:t=null;for(let a=0;a<2;a++){if(!a&&1==n)continue;let c=2==n?1:4==n?2:3;F[a?r:r-4]=1==n||a==Y?n=>{if(!t)throw Error("Could not find typed array for code "+r);return new t(Uint8Array.prototype.slice.call(n,0).buffer)}:n=>{if(!t)throw Error("Could not find typed array for code "+r);let l=new DataView(n.buffer,n.byteOffset,n.byteLength),d=n.length>>c,f=new t(d),m=l[o];for(let t=0;t<d;t++)f[t]=m.call(l,t<<c,a);return f}}})(Z[t],Q[t]);function readJustLength(){let t=31&a[A++];if(t>23)switch(t){case 24:t=a[A++];break;case 25:t=g.getUint16(A),A+=2;break;case 26:t=g.getUint32(A),A+=4}return t}function loadShared(){if(B.getShared){let t=saveState(()=>(a=null,B.getShared()))||{},r=t.structures||[];B.sharedVersion=t.version,_=B.sharedValues=t.packedValues,!0===l?B.structures=l=r:l.splice.apply(l,[0,r.length].concat(r))}}function saveState(t){let r=c,n=A,o=j,_=U,y=N,b=d,S=I,E=m,w=f,T=new Uint8Array(a.slice(0,c)),O=l,R=B,x=W,P=t();return c=r,A=n,j=o,U=_,N=y,d=b,I=S,m=E,f=w,a=T,W=x,l=O,B=R,g=new DataView(a.buffer,a.byteOffset,a.byteLength),P}function clearSource(){a=null,m=null,l=null}let ee=Array(147);for(let t=0;t<256;t++)ee[t]=+("1e"+Math.floor(45.15-.30103*t));let et=new Decoder({useRecords:!1}),er=et.decode,en=et.decodeMultiple,ei={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};try{b=new TextEncoder}catch(t){}let eo="object"==typeof globalThis&&globalThis.Buffer,es=void 0!==eo,ea=es?eo.allocUnsafeSlow:Uint8Array,ec=es?eo:Uint8Array,el=es?4294967296:2144337920,eu=0,ed=null,eh=/[\u0080-\uFFFF]/,ef=Symbol("record-id");let Encoder=class Encoder extends Decoder{constructor(t){let r,n,o,a,c,l;super(t),this.offset=0,t=t||{};let d=ec.prototype.utf8Write?function(t,r,n){return T.utf8Write(t,r,n)}:!!b&&!!b.encodeInto&&function(t,r){return b.encodeInto(t,T.subarray(r)).written},f=this,m=t.structures||t.saveStructures,_=t.maxSharedStructures;if(null==_&&(_=m?128:0),_>8190)throw Error("Maximum maxSharedStructure is 8190");let g=t.sequential;g&&(_=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let y,x,P=t.sharedValues;if(P){l=Object.create(null);for(let t=0,r=P.length;t<r;t++)l[P[t]]=t}let A=[],M=0,D=0;this.mapEncode=function(t,r){return this._keyMap&&!this._mapped&&"Array"===t.constructor.name&&(t=t.map(t=>this.encodeKeys(t))),this.encode(t,r)},this.encode=function(d,m){if(T||(T=new ea(8192),O=new DataView(T.buffer,0,8192),eu=0),(R=T.length-10)-eu<2048?(T=new ea(T.length),O=new DataView(T.buffer,0,T.length),R=T.length-10,eu=0):m===ew&&(eu=eu+7&2147483640),r=eu,f.useSelfDescribedHeader&&(O.setUint32(eu,3654940416),eu+=3),c=f.structuredClone?new Map:null,f.bundleStrings&&"string"!=typeof d?(ed=[]).size=1/0:ed=null,n=f.structures){if(n.uninitialized){let t=f.getShared()||{};f.structures=n=t.structures||[],f.sharedVersion=t.version;let r=f.sharedValues=t.packedValues;if(r){l={};for(let t=0,n=r.length;t<n;t++)l[r[t]]=t}}let t=n.length;if(t>_&&!g&&(t=_),!n.transitions){n.transitions=Object.create(null);for(let r=0;r<t;r++){let t=n[r];if(!t)continue;let o,a=n.transitions;for(let n=0,c=t.length;n<c;n++){void 0===a[ef]&&(a[ef]=r);let c=t[n];(o=a[c])||(o=a[c]=Object.create(null)),a=o}a[ef]=1048576|r}}g||(n.nextId=t)}if(o&&(o=!1),a=n||[],x=l,t.pack){let r=new Map;if(r.values=[],r.encoder=f,r.maxValues=t.maxPrivatePackedValues||(l?16:1/0),r.objectMap=l||!1,r.samplingPackedValues=y,function findRepetitiveStrings(t,r){switch(typeof t){case"string":if(t.length>3){if(r.objectMap[t]>-1||r.values.length>=r.maxValues)return;let n=r.get(t);if(n)2==++n.count&&r.values.push(t);else if(r.set(t,{count:1}),r.samplingPackedValues){let n=r.samplingPackedValues.get(t);n?n.count++:r.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t){if(t instanceof Array)for(let n=0,o=t.length;n<o;n++)findRepetitiveStrings(t[n],r);else{let o=!r.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(o&&findRepetitiveStrings(n,r),findRepetitiveStrings(t[n],r))}}break;case"function":console.log(t)}}(d,r),r.values.length>0){T[eu++]=216,T[eu++]=51,writeArrayHeader(4);let t=r.values;encode(t),writeArrayHeader(0),writeArrayHeader(0),x=Object.create(l||null);for(let r=0,n=t.length;r<n;r++)x[t[r]]=r}}w=m&eT;try{if(w)return;if(encode(d),ed&&writeBundles(r,encode),f.offset=eu,c&&c.idsToInsert){(eu+=2*c.idsToInsert.length)>R&&makeRoom(eu),f.offset=eu;let t=function(t,r){let n;let o=2*r.length,a=t.length-o;r.sort((t,r)=>t.offset>r.offset?1:-1);for(let n=0;n<r.length;n++){let o=r[n];for(let r of(o.id=n,o.references))t[r++]=n>>8,t[r]=255&n}for(;n=r.pop();){let r=n.offset;t.copyWithin(r+o,r,a);let c=r+(o-=2);t[c++]=216,t[c++]=28,a=r}return t}(T.subarray(r,eu),c.idsToInsert);return c=null,t}if(m&ew)return T.start=r,T.end=eu,T;return T.subarray(r,eu)}finally{if(n){if(D<10&&D++,n.length>_&&(n.length=_),M>1e4)n.transitions=null,D=0,M=0,A.length>0&&(A=[]);else if(A.length>0&&!g){for(let t=0,r=A.length;t<r;t++)A[t][ef]=void 0;A=[]}}if(o&&f.saveShared){f.structures.length>_&&(f.structures=f.structures.slice(0,_));let t=T.subarray(r,eu);if(!1===f.updateSharedData())return f.encode(d);return t}m&ek&&(eu=r)}},this.findCommonStringsToPack=()=>(y=new Map,l||(l=Object.create(null)),t=>{let r=t&&t.threshold||4,n=this.pack?t.maxPrivatePackedValues||16:0;for(let[t,a]of(P||(P=this.sharedValues=[]),y))a.count>r&&(l[t]=n++,P.push(t),o=!0);for(;this.saveShared&&!1===this.updateSharedData(););y=null});let encode=n=>{eu>R&&(T=makeRoom(eu));var o,a=typeof n;if("string"===a){let a;if(x){let r=x[n];if(r>=0){r<16?T[eu++]=r+224:(T[eu++]=198,1&r?encode(15-r>>1):encode(r-16>>1));return}if(y&&!t.pack){let t=y.get(n);t?t.count++:y.set(n,{count:1})}}let c=n.length;if(ed&&c>=4&&c<1024){if((ed.size+=c)>61440){let t;let n=(ed[0]?3*ed[0].length+ed[1].length:0)+10;eu+n>R&&(T=makeRoom(eu+n)),T[eu++]=217,T[eu++]=223,T[eu++]=249,T[eu++]=ed.position?132:130,T[eu++]=26,t=eu-r,eu+=4,ed.position&&writeBundles(r,encode),(ed=["",""]).size=0,ed.position=t}let t=eh.test(n);ed[t?0:1]+=n,T[eu++]=t?206:207,encode(c);return}a=c<32?1:c<256?2:c<65536?3:5;let l=3*c;if(eu+l>R&&(T=makeRoom(eu+l)),c<64||!d){let t,r,l,d=eu+a;for(t=0;t<c;t++)(r=n.charCodeAt(t))<128?T[d++]=r:(r<2048?T[d++]=r>>6|192:((64512&r)==55296&&(64512&(l=n.charCodeAt(t+1)))==56320?(r=65536+((1023&r)<<10)+(1023&l),t++,T[d++]=r>>18|240,T[d++]=r>>12&63|128):T[d++]=r>>12|224,T[d++]=r>>6&63|128),T[d++]=63&r|128);o=d-eu-a}else o=d(n,eu+a,l);o<24?T[eu++]=96|o:o<256?(a<2&&T.copyWithin(eu+2,eu+1,eu+1+o),T[eu++]=120,T[eu++]=o):o<65536?(a<3&&T.copyWithin(eu+3,eu+2,eu+2+o),T[eu++]=121,T[eu++]=o>>8,T[eu++]=255&o):(a<5&&T.copyWithin(eu+5,eu+3,eu+3+o),T[eu++]=122,O.setUint32(eu,o),eu+=4),eu+=o}else if("number"===a){if(this.alwaysUseFloat||n>>>0!==n){if(this.alwaysUseFloat||n>>0!==n){let t;if((t=this.useFloat32)>0&&n<4294967296&&n>=-2147483648){let r;if(T[eu++]=250,O.setFloat32(eu,n),t<4||(r=n*ee[(127&T[eu])<<1|T[eu+1]>>7])>>0===r){eu+=4;return}eu--}T[eu++]=251,O.setFloat64(eu,n),eu+=8}else n>=-24?T[eu++]=31-n:n>=-256?(T[eu++]=56,T[eu++]=~n):n>=-65536?(T[eu++]=57,O.setUint16(eu,~n),eu+=2):(T[eu++]=58,O.setUint32(eu,~n),eu+=4)}else n<24?T[eu++]=n:n<256?(T[eu++]=24,T[eu++]=n):n<65536?(T[eu++]=25,T[eu++]=n>>8,T[eu++]=255&n):(T[eu++]=26,O.setUint32(eu,n),eu+=4)}else if("object"===a){if(n){if(c){let t=c.get(n);if(t){if(T[eu++]=216,T[eu++]=29,T[eu++]=25,!t.references){let r=c.idsToInsert||(c.idsToInsert=[]);t.references=[],r.push(t)}t.references.push(eu-r),eu+=2;return}c.set(n,{offset:eu-r})}let t=n.constructor;if(t===Object)I(n,!0);else if(t===Array){(o=n.length)<24?T[eu++]=128|o:writeArrayHeader(o);for(let t=0;t<o;t++)encode(n[t])}else if(t===Map){if((this.mapsAsObjects?!1!==this.useTag259ForMaps:this.useTag259ForMaps)&&(T[eu++]=217,T[eu++]=1,T[eu++]=3),(o=n.size)<24?T[eu++]=160|o:o<256?(T[eu++]=184,T[eu++]=o):o<65536?(T[eu++]=185,T[eu++]=o>>8,T[eu++]=255&o):(T[eu++]=186,O.setUint32(eu,o),eu+=4),f.keyMap)for(let[t,r]of n)encode(f.encodeKey(t)),encode(r);else for(let[t,r]of n)encode(t),encode(r)}else{for(let t=0,r=S.length;t<r;t++)if(n instanceof E[t]){let r=S[t],o=r.tag;void 0==o&&(o=r.getTag&&r.getTag.call(this,n)),o<24?T[eu++]=192|o:o<256?(T[eu++]=216,T[eu++]=o):o<65536?(T[eu++]=217,T[eu++]=o>>8,T[eu++]=255&o):o>-1&&(T[eu++]=218,O.setUint32(eu,o),eu+=4),r.encode.call(this,n,encode,makeRoom);return}if(n[Symbol.iterator]){if(w){let t=Error("Iterable should be serialized as iterator");throw t.iteratorNotHandled=!0,t}for(let t of(T[eu++]=159,n))encode(t);T[eu++]=255;return}if(n[Symbol.asyncIterator]||isBlob(n)){let t=Error("Iterable/blob should be serialized as iterator");throw t.iteratorNotHandled=!0,t}if(this.useToJSON&&n.toJSON){let t=n.toJSON();if(t!==n)return encode(t)}I(n,!n.hasOwnProperty)}}else T[eu++]=246}else if("boolean"===a)T[eu++]=n?245:244;else if("bigint"===a){if(n<BigInt(1)<<BigInt(64)&&n>=0)T[eu++]=27,O.setBigUint64(eu,n);else if(n>-(BigInt(1)<<BigInt(64))&&n<0)T[eu++]=59,O.setBigUint64(eu,-n-BigInt(1));else if(this.largeBigIntToFloat)T[eu++]=251,O.setFloat64(eu,Number(n));else throw RangeError(n+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");eu+=8}else if("undefined"===a)T[eu++]=247;else throw Error("Unknown type: "+a)},I=!1===this.useRecords?this.variableMapSize?t=>{let r=Object.keys(t),n=Object.values(t),o=r.length;if(o<24?T[eu++]=160|o:o<256?(T[eu++]=184,T[eu++]=o):o<65536?(T[eu++]=185,T[eu++]=o>>8,T[eu++]=255&o):(T[eu++]=186,O.setUint32(eu,o),eu+=4),f.keyMap)for(let t=0;t<o;t++)encode(f.encodeKey(r[t])),encode(n[t]);else for(let t=0;t<o;t++)encode(r[t]),encode(n[t])}:(t,n)=>{T[eu++]=185;let o=eu-r;eu+=2;let a=0;if(f.keyMap)for(let r in t)(n||t.hasOwnProperty(r))&&(encode(f.encodeKey(r)),encode(t[r]),a++);else for(let r in t)(n||t.hasOwnProperty(r))&&(encode(r),encode(t[r]),a++);T[o+++r]=a>>8,T[o+r]=255&a}:(t,r)=>{let n,c,l,d=a.transitions||(a.transitions=Object.create(null)),f=0,m=0;if(this.keyMap){m=(c=Object.keys(t).map(t=>this.encodeKey(t))).length;for(let t=0;t<m;t++){let r=c[t];!(l=d[r])&&(l=d[r]=Object.create(null),f++),d=l}}else for(let o in t)(r||t.hasOwnProperty(o))&&(!(l=d[o])&&(1048576&d[ef]&&(n=65535&d[ef]),l=d[o]=Object.create(null),f++),d=l,m++);let g=d[ef];if(void 0!==g)g&=65535,T[eu++]=217,T[eu++]=g>>8|224,T[eu++]=255&g;else if(c||(c=d.__keys__||(d.__keys__=Object.keys(t))),void 0===n?((g=a.nextId++)||(g=0,a.nextId=1),g>=256&&(a.nextId=(g=_)+1)):g=n,a[g]=c,g<_){T[eu++]=217,T[eu++]=g>>8|224,T[eu++]=255&g,d=a.transitions;for(let t=0;t<m;t++)(void 0===d[ef]||1048576&d[ef])&&(d[ef]=g),d=d[c[t]];d[ef]=1048576|g,o=!0}else{if(d[ef]=g,O.setUint32(eu,3655335680),eu+=3,f&&(M+=D*f),A.length>=256-_&&(A.shift()[ef]=void 0),A.push(d),writeArrayHeader(m+2),encode(57344+g),encode(c),null===r)return;for(let n in t)(r||t.hasOwnProperty(n))&&encode(t[n]);return}if(m<24?T[eu++]=128|m:writeArrayHeader(m),null!==r)for(let n in t)(r||t.hasOwnProperty(n))&&encode(t[n])},makeRoom=t=>{let n;if(t>16777216){if(t-r>el)throw Error("Encoded buffer would be larger than maximum buffer size");n=Math.min(el,4096*Math.round(Math.max((t-r)*(t>67108864?1.25:2),4194304)/4096))}else n=(Math.max(t-r<<2,T.length-1)>>12)+1<<12;let o=new ea(n);return O=new DataView(o.buffer,0,n),T.copy?T.copy(o,0,r,t):o.set(T.slice(r,t)),eu-=r,r=0,R=o.length-10,T=o},j=100,B=1e3;function*encodeObjectAsIterable(t,n,o){let a=t.constructor;if(a===Object){let r=!1!==f.useRecords;for(let o in r?I(t,null):writeEntityLength(Object.keys(t).length,160),t){let a=t[o];r||encode(o),a&&"object"==typeof a?n[o]?yield*encodeObjectAsIterable(a,n[o]):yield*tryEncode(a,n,o):encode(a)}}else if(a===Array){let o=t.length;writeArrayHeader(o);for(let a=0;a<o;a++){let o=t[a];o&&("object"==typeof o||eu-r>j)?n.element?yield*encodeObjectAsIterable(o,n.element):yield*tryEncode(o,n,"element"):encode(o)}}else if(t[Symbol.iterator]){for(let o of(T[eu++]=159,t))o&&("object"==typeof o||eu-r>j)?n.element?yield*encodeObjectAsIterable(o,n.element):yield*tryEncode(o,n,"element"):encode(o);T[eu++]=255}else isBlob(t)?(writeEntityLength(t.size,64),yield T.subarray(r,eu),yield t,restartEncoding()):t[Symbol.asyncIterator]?(T[eu++]=159,yield T.subarray(r,eu),yield t,restartEncoding(),T[eu++]=255):encode(t);o&&eu>r?yield T.subarray(r,eu):eu-r>j&&(yield T.subarray(r,eu),restartEncoding())}function*tryEncode(t,n,o){let a=eu-r;try{encode(t),eu-r>j&&(yield T.subarray(r,eu),restartEncoding())}catch(c){if(c.iteratorNotHandled)n[o]={},eu=r+a,yield*encodeObjectAsIterable.call(this,t,n[o]);else throw c}}function restartEncoding(){j=B,f.encode(null,eT)}function startEncoding(t,r,n){return(j=r&&r.chunkThreshold?B=r.chunkThreshold:100,t&&"object"==typeof t)?(f.encode(null,eT),n(t,f.iterateProperties||(f.iterateProperties={}),!0)):[f.encode(t)]}async function*encodeObjectAsAsyncIterable(t,r){for(let n of encodeObjectAsIterable(t,r,!0)){let t=n.constructor;if(t===ec||t===Uint8Array)yield n;else if(isBlob(n)){let t,r=n.stream().getReader();for(;!(t=await r.read()).done;)yield t.value}else if(n[Symbol.asyncIterator])for await(let t of n)restartEncoding(),t?yield*encodeObjectAsAsyncIterable(t,r.async||(r.async={})):yield f.encode(t);else yield n}}this.encodeAsIterable=function(t,r){return startEncoding(t,r,encodeObjectAsIterable)},this.encodeAsAsyncIterable=function(t,r){return startEncoding(t,r,encodeObjectAsAsyncIterable)}}useBuffer(t){T=t,O=new DataView(T.buffer,T.byteOffset,T.byteLength),eu=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let t=this.sharedVersion||0;this.sharedVersion=t+1;let r=this.structures.slice(0),n=new SharedData(r,this.sharedValues,this.sharedVersion),o=this.saveShared(n,r=>(r&&r.version||0)==t);return!1===o?(n=this.getShared()||{},this.structures=n.structures||[],this.sharedValues=n.packedValues,this.sharedVersion=n.version,this.structures.nextId=this.structures.length):r.forEach((t,r)=>this.structures[r]=t),o}};function writeEntityLength(t,r){t<24?T[eu++]=r|t:t<256?(T[eu++]=24|r,T[eu++]=t):t<65536?(T[eu++]=25|r,T[eu++]=t>>8,T[eu++]=255&t):(T[eu++]=26|r,O.setUint32(eu,t),eu+=4)}let SharedData=class SharedData{constructor(t,r,n){this.structures=t,this.packedValues=r,this.version=n}};function writeArrayHeader(t){t<24?T[eu++]=128|t:t<256?(T[eu++]=152,T[eu++]=t):t<65536?(T[eu++]=153,T[eu++]=t>>8,T[eu++]=255&t):(T[eu++]=154,O.setUint32(eu,t),eu+=4)}let ep="undefined"==typeof Blob?function(){}:Blob;function isBlob(t){if(t instanceof ep)return!0;let r=t[Symbol.toStringTag];return"Blob"===r||"File"===r}let em=1==new Uint8Array(new Uint16Array([1]).buffer)[0];function typedArrayEncoder(t,r){return!em&&r>1&&(t-=4),{tag:t,encode:function(t,r){let n=t.byteLength,o=t.byteOffset||0,a=t.buffer||t;r(es?eo.from(a,o,n):new Uint8Array(a,o,n))}}}function writeBuffer(t,r){let n=t.byteLength;n<24?T[eu++]=64+n:n<256?(T[eu++]=88,T[eu++]=n):n<65536?(T[eu++]=89,T[eu++]=n>>8,T[eu++]=255&n):(T[eu++]=90,O.setUint32(eu,n),eu+=4),eu+n>=T.length&&r(eu+n),T.set(t.buffer?t:new Uint8Array(t),eu),eu+=n}function writeBundles(t,r){O.setUint32(ed.position+t,eu-ed.position-t+1);let n=ed;ed=null,r(n[0]),r(n[1])}E=[Date,Set,Error,RegExp,Tag,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,"undefined"==typeof BigUint64Array?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,"undefined"==typeof BigInt64Array?function(){}:BigInt64Array,Float32Array,Float64Array,SharedData],S=[{tag:1,encode(t,r){let n=t.getTime()/1e3;(this.useTimestamp32||0===t.getMilliseconds())&&n>=0&&n<4294967296?(T[eu++]=26,O.setUint32(eu,n),eu+=4):(T[eu++]=251,O.setFloat64(eu,n),eu+=8)}},{tag:258,encode(t,r){r(Array.from(t))}},{tag:27,encode(t,r){r([t.name,t.message])}},{tag:27,encode(t,r){r(["RegExp",t.source,t.flags])}},{getTag:t=>t.tag,encode(t,r){r(t.value)}},{encode(t,r,n){writeBuffer(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||es&&!1!==this.tagUint8Array))return 64},encode(t,r,n){writeBuffer(t,n)}},typedArrayEncoder(68,1),typedArrayEncoder(69,2),typedArrayEncoder(70,4),typedArrayEncoder(71,8),typedArrayEncoder(72,1),typedArrayEncoder(77,2),typedArrayEncoder(78,4),typedArrayEncoder(79,8),typedArrayEncoder(85,4),typedArrayEncoder(86,8),{encode(t,r){let n=t.packedValues||[],o=t.structures||[];if(n.values.length>0){T[eu++]=216,T[eu++]=51,writeArrayHeader(4);let t=n.values;r(t),writeArrayHeader(0),writeArrayHeader(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let r=0,n=t.length;r<n;r++)packedObjectMap[t[r]]=r}if(o){O.setUint32(eu,3655335424),eu+=3;let n=o.slice(0);n.unshift(57344),n.push(new Tag(t.version,1399353956)),r(n)}else r(new Tag(t.version,1399353956))}}];let e_=new Encoder({useRecords:!1}),eg=e_.encode,ey=e_.encodeAsIterable,eb=e_.encodeAsAsyncIterable,{NEVER:ev,ALWAYS:eS,DECIMAL_ROUND:eE,DECIMAL_FIT:eC}=ei,ew=512,ek=1024,eT=2048;let EncoderStream=class EncoderStream extends P.Transform{constructor(t){t||(t={}),t.writableObjectMode=!0,super(t),t.sequential=!0,this.encoder=t.encoder||new Encoder(t)}async _transform(t,r,n){for await(let r of this.encoder.encodeAsAsyncIterable(t))this.push(r);n()}};let DecoderStream=class DecoderStream extends P.Transform{constructor(t){t||(t={}),t.objectMode=!0,super(t),t.structures=[],this.decoder=t.decoder||new Decoder(t)}_transform(t,r,n){let o;this.incompleteBuffer&&(t=Buffer.concat([this.incompleteBuffer,t]),this.incompleteBuffer=null);try{o=this.decoder.decodeMultiple(t)}catch(r){if(r.incomplete)this.incompleteBuffer=t.slice(r.lastPosition),o=r.values;else throw r}finally{for(let t of o||[])null===t&&(t=this.getNullValue()),this.push(t)}n&&n()}getNullValue(){return Symbol.for(null)}};async function*encodeIterAsync(t,r){let n=new Encoder(r);for await(let r of t)yield n.encode(r)}let eO=void 0!==process.env.CBOR_NATIVE_ACCELERATION_DISABLED&&"true"===process.env.CBOR_NATIVE_ACCELERATION_DISABLED.toLowerCase();if(!eO){let t;try{(t=n(29108))&&(x=t.extractStrings,r.isNativeAccelerationEnabled=!0,q=function(t){let r=I[j++];if(null==r){if(f)return readStringJS(t);let n=x(A,c,t,a);if("string"==typeof n)r=n,I=M;else if(j=1,N=1,void 0===(r=(I=n)[0]))throw Error("Unexpected end of buffer")}let n=r.length;return n<=t?(A+=t,r):(d=r,U=A,N=A+n,A+=t,r.slice(0,t))})}catch(t){}}r.ALWAYS=eS,r.DECIMAL_FIT=eC,r.DECIMAL_ROUND=eE,r.Decoder=Decoder,r.DecoderStream=DecoderStream,r.Encoder=Encoder,r.EncoderStream=EncoderStream,r.FLOAT32_OPTIONS=ei,r.NEVER=ev,r.REUSE_BUFFER_MODE=ew,r.Tag=Tag,r.addExtension=function(t){if(t.Class){if(!t.encode)throw Error("Extension has no encode function");E.unshift(t.Class),S.unshift(t)}F[t.tag]=t.decode},r.clearSource=clearSource,r.decode=er,r.decodeIter=function(t,r={}){let n;if(!t||"object"!=typeof t)throw Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");let o=new Decoder(r),parser=t=>{let r;n&&(t=Buffer.concat([n,t]),n=void 0);try{r=o.decodeMultiple(t)}catch(o){if(o.incomplete)n=t.slice(o.lastPosition),r=o.values;else throw o}return r};return"function"==typeof t[Symbol.iterator]?function*(){for(let r of t)yield*parser(r)}():"function"==typeof t[Symbol.asyncIterator]?async function*(){for await(let r of t)yield*parser(r)}():void 0},r.decodeMultiple=en,r.encode=eg,r.encodeAsAsyncIterable=eb,r.encodeAsIterable=ey,r.encodeIter=function(t,r={}){if(t&&"object"==typeof t){if("function"==typeof t[Symbol.iterator])return function*(t,r){let n=new Encoder(r);for(let r of t)yield n.encode(r)}(t,r);if("function"==typeof t.then||"function"==typeof t[Symbol.asyncIterator])return encodeIterAsync(t,r);throw Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")},r.mapsAsObjects=!0,r.roundFloat32=function(t){K[0]=t;let r=ee[(127&J[3])<<1|J[2]>>7];return(r*t+(t>0?.5:-.5)>>0)/r},r.useRecords=!1},80937:t=>{function $parcel$export(t,r,n,o){Object.defineProperty(t,r,{get:n,set:o,enumerable:!0,configurable:!0})}$parcel$export(t.exports,"unpack",()=>$305e16fc3067229c$export$417857010dc9287f),$parcel$export(t.exports,"pack",()=>$305e16fc3067229c$export$2a703dbb0cb35339),$parcel$export(t.exports,"Packer",()=>$305e16fc3067229c$export$b9ec4b114aa40074);let $df5e3223d81bc678$export$93654d4f2d6cd524=class $df5e3223d81bc678$export$93654d4f2d6cd524{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(t){this.flush(),this._parts.push(t)}append(t){this._pieces.push(t)}flush(){if(this._pieces.length>0){let t=new Uint8Array(this._pieces);this._parts.push(t),this._pieces=[]}}toArrayBuffer(){let t=[];for(let r of this._parts)t.push(r);return function(t){let r=0;for(let n of t)r+=n.byteLength;let n=new Uint8Array(r),o=0;for(let r of t){let t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);n.set(t,o),o+=r.byteLength}return n}(t).buffer}};function $305e16fc3067229c$export$417857010dc9287f(t){let r=new $305e16fc3067229c$var$Unpacker(t);return r.unpack()}function $305e16fc3067229c$export$2a703dbb0cb35339(t){let r=new $305e16fc3067229c$export$b9ec4b114aa40074;return r.pack(t),r.getBuffer()}let $305e16fc3067229c$var$Unpacker=class $305e16fc3067229c$var$Unpacker{constructor(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){let t;let r=this.unpack_uint8();if(r<128)return r;if((224^r)<32)return(224^r)-32;if((t=160^r)<=15)return this.unpack_raw(t);if((t=176^r)<=15)return this.unpack_string(t);if((t=144^r)<=15)return this.unpack_array(t);if((t=128^r)<=15)return this.unpack_map(t);switch(r){case 192:return null;case 193:case 212:case 213:case 214:case 215:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){let t=255&this.dataView[this.index];return this.index++,t}unpack_uint16(){let t=this.read(2),r=(255&t[0])*256+(255&t[1]);return this.index+=2,r}unpack_uint32(){let t=this.read(4),r=((256*t[0]+t[1])*256+t[2])*256+t[3];return this.index+=4,r}unpack_uint64(){let t=this.read(8),r=((((((256*t[0]+t[1])*256+t[2])*256+t[3])*256+t[4])*256+t[5])*256+t[6])*256+t[7];return this.index+=8,r}unpack_int8(){let t=this.unpack_uint8();return t<128?t:t-256}unpack_int16(){let t=this.unpack_uint16();return t<32768?t:t-65536}unpack_int32(){let t=this.unpack_uint32();return t<2147483648?t:t-4294967296}unpack_int64(){let t=this.unpack_uint64();return t<0x7fffffffffffffff?t:t-18446744073709552e3}unpack_raw(t){if(this.length<this.index+t)throw Error(`BinaryPackFailure: index is out of range ${this.index} ${t} ${this.length}`);let r=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,r}unpack_string(t){let r,n;let o=this.read(t),a=0,c="";for(;a<t;)(r=o[a])<160?(n=r,a++):(192^r)<32?(n=(31&r)<<6|63&o[a+1],a+=2):(224^r)<16?(n=(15&r)<<12|(63&o[a+1])<<6|63&o[a+2],a+=3):(n=(7&r)<<18|(63&o[a+1])<<12|(63&o[a+2])<<6|63&o[a+3],a+=4),c+=String.fromCodePoint(n);return this.index+=t,c}unpack_array(t){let r=Array(t);for(let n=0;n<t;n++)r[n]=this.unpack();return r}unpack_map(t){let r={};for(let n=0;n<t;n++){let t=this.unpack();r[t]=this.unpack()}return r}unpack_float(){let t=this.unpack_uint32();return(0==t>>31?1:-1)*(8388607&t|8388608)*2**((t>>23&255)-127-23)}unpack_double(){let t=this.unpack_uint32(),r=this.unpack_uint32(),n=(t>>20&2047)-1023;return(0==t>>31?1:-1)*((1048575&t|1048576)*2**(n-20)+r*2**(n-52))}read(t){let r=this.index;if(r+t<=this.length)return this.dataView.subarray(r,r+t);throw Error("BinaryPackFailure: read index out of range")}};let $305e16fc3067229c$export$b9ec4b114aa40074=class $305e16fc3067229c$export$b9ec4b114aa40074{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(t){if("string"==typeof t)this.pack_string(t);else if("number"==typeof t)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"==typeof t)!0===t?this._bufferBuilder.append(195):!1===t&&this._bufferBuilder.append(194);else if(void 0===t)this._bufferBuilder.append(192);else if("object"==typeof t){if(null===t)this._bufferBuilder.append(192);else{let r=t.constructor;if(t instanceof Array)this.pack_array(t);else if(t instanceof ArrayBuffer)this.pack_bin(new Uint8Array(t));else if("BYTES_PER_ELEMENT"in t)this.pack_bin(new Uint8Array(t.buffer,t.byteOffset,t.byteLength));else if(t instanceof Date)this.pack_string(t.toString());else if(r==Object||r.toString().startsWith("class"))this.pack_object(t);else throw Error(`Type "${r.toString()}" not yet supported`)}}else throw Error(`Type "${typeof t}" not yet supported`);this._bufferBuilder.flush()}pack_bin(t){let r=t.length;if(r<=15)this.pack_uint8(160+r);else if(r<=65535)this._bufferBuilder.append(218),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(r);else throw Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_string(t){let r=this._textEncoder.encode(t),n=r.length;if(n<=15)this.pack_uint8(176+n);else if(n<=65535)this._bufferBuilder.append(216),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(n);else throw Error("Invalid length");this._bufferBuilder.append_buffer(r)}pack_array(t){let r=t.length;if(r<=15)this.pack_uint8(144+r);else if(r<=65535)this._bufferBuilder.append(220),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(r);else throw Error("Invalid length");for(let n=0;n<r;n++)this.pack(t[n])}pack_integer(t){if(t>=-32&&t<=127)this._bufferBuilder.append(255&t);else if(t>=0&&t<=255)this._bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&t<=127)this._bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&t<=65535)this._bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&t<=32767)this._bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&t<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&t<=2147483647)this._bufferBuilder.append(210),this.pack_int32(t);else if(t>=-0x8000000000000000&&t<=0x7fffffffffffffff)this._bufferBuilder.append(211),this.pack_int64(t);else if(t>=0&&t<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(t);else throw Error("Invalid integer")}pack_double(t){let r=0;t<0&&(r=1,t=-t);let n=Math.floor(Math.log(t)/Math.LN2),o=t/2**n-1,a=Math.floor(4503599627370496*o),c=r<<31|n+1023<<20|a/4294967296&1048575;this._bufferBuilder.append(203),this.pack_int32(c),this.pack_int32(a%4294967296)}pack_object(t){let r=Object.keys(t),n=r.length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this._bufferBuilder.append(222),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(n);else throw Error("Invalid length");for(let r in t)t.hasOwnProperty(r)&&(this.pack(r),this.pack(t[r]))}pack_uint8(t){this._bufferBuilder.append(t)}pack_uint16(t){this._bufferBuilder.append(t>>8),this._bufferBuilder.append(255&t)}pack_uint32(t){let r=4294967295&t;this._bufferBuilder.append((4278190080&r)>>>24),this._bufferBuilder.append((16711680&r)>>>16),this._bufferBuilder.append((65280&r)>>>8),this._bufferBuilder.append(255&r)}pack_uint64(t){let r=t/4294967296,n=t%4294967296;this._bufferBuilder.append((4278190080&r)>>>24),this._bufferBuilder.append((16711680&r)>>>16),this._bufferBuilder.append((65280&r)>>>8),this._bufferBuilder.append(255&r),this._bufferBuilder.append((4278190080&n)>>>24),this._bufferBuilder.append((16711680&n)>>>16),this._bufferBuilder.append((65280&n)>>>8),this._bufferBuilder.append(255&n)}pack_int8(t){this._bufferBuilder.append(255&t)}pack_int16(t){this._bufferBuilder.append((65280&t)>>8),this._bufferBuilder.append(255&t)}pack_int32(t){this._bufferBuilder.append(t>>>24&255),this._bufferBuilder.append((16711680&t)>>>16),this._bufferBuilder.append((65280&t)>>>8),this._bufferBuilder.append(255&t)}pack_int64(t){let r=Math.floor(t/4294967296),n=t%4294967296;this._bufferBuilder.append((4278190080&r)>>>24),this._bufferBuilder.append((16711680&r)>>>16),this._bufferBuilder.append((65280&r)>>>8),this._bufferBuilder.append(255&r),this._bufferBuilder.append((4278190080&n)>>>24),this._bufferBuilder.append((16711680&n)>>>16),this._bufferBuilder.append((65280&n)>>>8),this._bufferBuilder.append(255&n)}constructor(){this._bufferBuilder=new $df5e3223d81bc678$export$93654d4f2d6cd524,this._textEncoder=new TextEncoder}}},24551:(t,r,n)=>{var o,a,c,l,d,f,m,_,g=n(80937),y=n(56677),b=n(48419),S=n(68793),E=n(2493);function $parcel$export(t,r,n,o){Object.defineProperty(t,r,{get:n,set:o,enumerable:!0,configurable:!0})}function $parcel$interopDefault(t){return t&&t.__esModule?t.default:t}Object.defineProperty(t.exports,"__esModule",{value:!0,configurable:!0}),$parcel$export(t.exports,"default",()=>D),$parcel$export(t.exports,"util",()=>R),$parcel$export(t.exports,"BufferedConnection",()=>$8d5124d0cf36ebe0$export$ff7c9d4c11d94e8b),$parcel$export(t.exports,"StreamConnection",()=>$544799118fa637e6$export$72aa44612e2200cd),$parcel$export(t.exports,"Cbor",()=>$0cb783f200ef4d91$export$7e9583c3c8a0a2cc),$parcel$export(t.exports,"MsgPack",()=>$7e477efb76e02214$export$80f5de1a66c4d624),$parcel$export(t.exports,"Peer",()=>$2ddecb16305b5a82$export$ecd1fc136c422448),$parcel$export(t.exports,"MsgPackPeer",()=>$8c8805059443e9b3$export$d72c7bf8eef50853),$parcel$export(t.exports,"CborPeer",()=>$1fc1476c05a53911$export$f6a74c7ffa2903e6),$parcel$export(t.exports,"PeerError",()=>$cf62563e7a9fbce5$export$98871882f492de82);let $7ce5389b504cc06c$export$f1c5f4c9cb95390b=class $7ce5389b504cc06c$export$f1c5f4c9cb95390b{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=t=>{let r=[],n=t.byteLength,o=Math.ceil(n/this.chunkedMTU),a=0,c=0;for(;c<n;){let l=Math.min(n,c+this.chunkedMTU),d=t.slice(c,l),f={__peerData:this._dataCount,n:a,data:d,total:o};r.push(f),c=l,a++}return this._dataCount++,r}}};let w=$parcel$interopDefault(y).default||$parcel$interopDefault(y),T=new class{isWebRTCSupported(){return"undefined"!=typeof RTCPeerConnection}isBrowserSupported(){let t=this.getBrowser(),r=this.getVersion(),n=this.supportedBrowsers.includes(t);return!!n&&("chrome"===t?r>=this.minChromeVersion:"firefox"===t?r>=this.minFirefoxVersion:"safari"===t&&!this.isIOS&&r>=this.minSafariVersion)}getBrowser(){return w.browserDetails.browser}getVersion(){return w.browserDetails.version||0}isUnifiedPlanSupported(){let t;let r=this.getBrowser(),n=w.browserDetails.version||0;if("chrome"===r&&n<this.minChromeVersion)return!1;if("firefox"===r&&n>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let o=!1;try{(t=new RTCPeerConnection).addTransceiver("audio"),o=!0}catch(t){}finally{t&&t.close()}return o}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},$706cd7d90eca90d6$export$f35f128fd59ea256=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),$6a375544f634961e$export$4e61f672936bec77=()=>Math.random().toString(36).slice(2),O={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"},R=new class extends $7ce5389b504cc06c$export$f1c5f4c9cb95390b{noop(){}blobToArrayBuffer(t,r){let n=new FileReader;return n.onload=function(t){t.target&&r(t.target.result)},n.readAsArrayBuffer(t),n}binaryStringToArrayBuffer(t){let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=255&t.charCodeAt(n);return r.buffer}isSecure(){return"https:"===location.protocol}constructor(...t){super(...t),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=O,this.browser=T.getBrowser(),this.browserVersion=T.getVersion(),this.pack=g.pack,this.unpack=g.unpack,this.supports=function(){let t;let r={browser:T.isBrowserSupported(),webRTC:T.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!r.webRTC)return r;try{let n;t=new RTCPeerConnection(O),r.audioVideo=!0;try{n=t.createDataChannel("_PEERJSTEST",{ordered:!0}),r.data=!0,r.reliable=!!n.ordered;try{n.binaryType="blob",r.binaryBlob=!T.isIOS}catch(t){}}catch(t){}finally{n&&n.close()}}catch(t){}finally{t&&t.close()}return r}(),this.validateId=$706cd7d90eca90d6$export$f35f128fd59ea256,this.randomToken=$6a375544f634961e$export$4e61f672936bec77}};!function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"}(o||(o={}));var x=new class{get logLevel(){return this._logLevel}set logLevel(t){this._logLevel=t}log(...t){this._logLevel>=o.All&&this._print(o.All,...t)}warn(...t){this._logLevel>=o.Warnings&&this._print(o.Warnings,...t)}error(...t){this._logLevel>=o.Errors&&this._print(o.Errors,...t)}setLogFunction(t){this._print=t}_print(t,...r){let n=["PeerJS: ",...r];for(let t in n)n[t]instanceof Error&&(n[t]="("+n[t].name+") "+n[t].message);t>=o.All?console.log(...n):t>=o.Warnings?console.warn("WARNING",...n):t>=o.Errors&&console.error("ERROR",...n)}constructor(){this._logLevel=o.Disabled}},P={};$parcel$export(P,"ConnectionType",()=>a),$parcel$export(P,"PeerErrorType",()=>c),$parcel$export(P,"BaseConnectionErrorType",()=>l),$parcel$export(P,"DataConnectionErrorType",()=>d),$parcel$export(P,"SerializationType",()=>f),$parcel$export(P,"SocketEventType",()=>m),$parcel$export(P,"ServerMessageType",()=>_),function(t){t.Data="data",t.Media="media"}(a||(a={})),function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"}(c||(c={})),function(t){t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed"}(l||(l={})),function(t){t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big"}(d||(d={})),function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw"}(f||(f={})),function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"}(m||(m={})),function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"}(_||(_={}));var A={};A=JSON.parse('{"name":"peerjs","version":"1.5.1","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz St\xfcckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-cbor":"dist/serializer.cbor.mjs","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-cbor":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/Cbor.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","cbor-x":"^1.5.3","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.0.0","webrtc-adapter":"^8.0.0"},"alias":{"process":false,"buffer":false}}');let $e5e868bf3ea73e5b$export$4798917dbf149b79=class $e5e868bf3ea73e5b$export$4798917dbf149b79 extends b.EventEmitter{constructor(t,r,n,o,a,c=5e3){super(),this.pingInterval=c,this._disconnected=!0,this._messagesQueue=[],this._baseUrl=(t?"wss://":"ws://")+r+":"+n+o+"peerjs?key="+a}start(t,r){this._id=t;let n=`${this._baseUrl}&id=${t}&token=${r}`;!this._socket&&this._disconnected&&(this._socket=new WebSocket(n+"&version="+A.version),this._disconnected=!1,this._socket.onmessage=t=>{let r;try{r=JSON.parse(t.data),x.log("Server message received:",r)}catch(r){x.log("Invalid server message",t.data);return}this.emit(m.Message,r)},this._socket.onclose=t=>{this._disconnected||(x.log("Socket closed.",t),this._cleanup(),this._disconnected=!0,this.emit(m.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),x.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){x.log("Cannot send heartbeat, because socket closed");return}let t=JSON.stringify({type:_.Heartbeat});this._socket.send(t),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&1===this._socket.readyState}_sendQueuedMessages(){let t=[...this._messagesQueue];for(let r of(this._messagesQueue=[],t))this.send(r)}send(t){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(t);return}if(!t.type){this.emit(m.Error,"Invalid message");return}if(!this._wsOpen())return;let r=JSON.stringify(t);this._socket.send(r)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}};let $a8347a6741c5df8a$export$89e6bb5ad64bf4a=class $a8347a6741c5df8a$export$89e6bb5ad64bf4a{constructor(t){this.connection=t}startConnection(t){let r=this._startPeerConnection();if(this.connection.peerConnection=r,this.connection.type===a.Media&&t._stream&&this._addTracksToConnection(t._stream,r),t.originator){let n=this.connection,o={ordered:!!t.reliable},a=r.createDataChannel(n.label,o);n._initializeDataChannel(a),this._makeOffer()}else this.handleSDP("OFFER",t.sdp)}_startPeerConnection(){x.log("Creating RTCPeerConnection.");let t=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(t),t}_setupListeners(t){let r=this.connection.peer,n=this.connection.connectionId,o=this.connection.type,c=this.connection.provider;x.log("Listening for ICE candidates."),t.onicecandidate=t=>{t.candidate&&t.candidate.candidate&&(x.log(`Received ICE candidates for ${r}:`,t.candidate),c.socket.send({type:_.Candidate,payload:{candidate:t.candidate,type:o,connectionId:n},dst:r}))},t.oniceconnectionstatechange=()=>{switch(t.iceConnectionState){case"failed":x.log("iceConnectionState is failed, closing connections to "+r),this.connection.emitError(l.NegotiationFailed,"Negotiation of connection to "+r+" failed."),this.connection.close();break;case"closed":x.log("iceConnectionState is closed, closing connections to "+r),this.connection.emitError(l.ConnectionClosed,"Connection to "+r+" closed."),this.connection.close();break;case"disconnected":x.log("iceConnectionState changed to disconnected on the connection with "+r);break;case"completed":t.onicecandidate=()=>{}}this.connection.emit("iceStateChanged",t.iceConnectionState)},x.log("Listening for data channel"),t.ondatachannel=t=>{x.log("Received data channel");let o=t.channel,a=c.getConnection(r,n);a._initializeDataChannel(o)},x.log("Listening for remote stream"),t.ontrack=t=>{x.log("Received remote stream");let o=t.streams[0],l=c.getConnection(r,n);l.type===a.Media&&this._addStreamToMediaConnection(o,l)}}cleanup(){x.log("Cleaning up PeerConnection to "+this.connection.peer);let t=this.connection.peerConnection;if(!t)return;this.connection.peerConnection=null,t.onicecandidate=t.oniceconnectionstatechange=t.ondatachannel=t.ontrack=()=>{};let r="closed"!==t.signalingState,n=!1,o=this.connection.dataChannel;o&&(n=!!o.readyState&&"closed"!==o.readyState),(r||n)&&t.close()}async _makeOffer(){let t=this.connection.peerConnection,r=this.connection.provider;try{let n=await t.createOffer(this.connection.options.constraints);x.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await t.setLocalDescription(n),x.log("Set localDescription:",n,`for:${this.connection.peer}`);let o={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===a.Data){let t=this.connection;o={...o,label:t.label,reliable:t.reliable,serialization:t.serialization}}r.socket.send({type:_.Offer,payload:o,dst:this.connection.peer})}catch(t){"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=t&&(r.emitError(c.WebRTC,t),x.log("Failed to setLocalDescription, ",t))}}catch(t){r.emitError(c.WebRTC,t),x.log("Failed to createOffer, ",t)}}async _makeAnswer(){let t=this.connection.peerConnection,r=this.connection.provider;try{let n=await t.createAnswer();x.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp);try{await t.setLocalDescription(n),x.log("Set localDescription:",n,`for:${this.connection.peer}`),r.socket.send({type:_.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(t){r.emitError(c.WebRTC,t),x.log("Failed to setLocalDescription, ",t)}}catch(t){r.emitError(c.WebRTC,t),x.log("Failed to create answer, ",t)}}async handleSDP(t,r){r=new RTCSessionDescription(r);let n=this.connection.peerConnection,o=this.connection.provider;x.log("Setting remote description",r);try{await n.setRemoteDescription(r),x.log(`Set remoteDescription:${t} for:${this.connection.peer}`),"OFFER"===t&&await this._makeAnswer()}catch(t){o.emitError(c.WebRTC,t),x.log("Failed to setRemoteDescription, ",t)}}async handleCandidate(t){x.log("handleCandidate:",t);try{await this.connection.peerConnection.addIceCandidate(t),x.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(c.WebRTC,t),x.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(t,r){if(x.log(`add tracks from stream ${t.id} to peer connection`),!r.addTrack)return x.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");t.getTracks().forEach(n=>{r.addTrack(n,t)})}_addStreamToMediaConnection(t,r){x.log(`add stream ${t.id} to media connection ${r.connectionId}`),r.addStream(t)}};let $cf62563e7a9fbce5$export$6a678e589c8a4542=class $cf62563e7a9fbce5$export$6a678e589c8a4542 extends b.EventEmitter{emitError(t,r){x.error("Error:",r),this.emit("error",new $cf62563e7a9fbce5$export$98871882f492de82(`${t}`,r))}};let $cf62563e7a9fbce5$export$98871882f492de82=class $cf62563e7a9fbce5$export$98871882f492de82 extends Error{constructor(t,r){"string"==typeof r?super(r):(super(),Object.assign(this,r)),this.type=t}};let $cb834ab0363d9153$export$23a2a68283c24d80=class $cb834ab0363d9153$export$23a2a68283c24d80 extends $cf62563e7a9fbce5$export$6a678e589c8a4542{get open(){return this._open}constructor(t,r,n){super(),this.peer=t,this.provider=r,this.options=n,this._open=!1,this.metadata=n.metadata}};let $f3a554d4328c6b5f$export$4a84e95a2324ac29=class $f3a554d4328c6b5f$export$4a84e95a2324ac29 extends $cb834ab0363d9153$export$23a2a68283c24d80{static #e=(()=>{this.ID_PREFIX="mc_"})();get type(){return a.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(t,r,n){super(t,r,n),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||$f3a554d4328c6b5f$export$4a84e95a2324ac29.ID_PREFIX+R.randomToken(),this._negotiator=new $a8347a6741c5df8a$export$89e6bb5ad64bf4a(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(t){this.dataChannel=t,this.dataChannel.onopen=()=>{x.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{x.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(t){x.log("Receiving stream",t),this._remoteStream=t,super.emit("stream",t)}handleMessage(t){let r=t.type,n=t.payload;switch(t.type){case _.Answer:this._negotiator.handleSDP(r,n.sdp),this._open=!0;break;case _.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:x.warn(`Unrecognized message type:${r} from peer:${this.peer}`)}}answer(t,r={}){if(this._localStream){x.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=t,r&&r.sdpTransform&&(this.options.sdpTransform=r.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:t});let n=this.provider._getMessages(this.connectionId);for(let t of n)this.handleMessage(t);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};let $684fc411629b137b$export$2c4e825dc9120f87=class $684fc411629b137b$export$2c4e825dc9120f87{constructor(t){this._options=t}_buildRequest(t){let r=this._options.secure?"https":"http",{host:n,port:o,path:a,key:c}=this._options,l=new URL(`${r}://${n}:${o}${a}${c}/${t}`);return l.searchParams.set("ts",`${Date.now()}${Math.random()}`),l.searchParams.set("version",A.version),fetch(l.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{let t=await this._buildRequest("id");if(200!==t.status)throw Error(`Error. Status:${t.status}`);return t.text()}catch(r){x.error("Error retrieving ID",r);let t="";throw"/"===this._options.path&&this._options.host!==R.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{let t=await this._buildRequest("peers");if(200!==t.status){if(401===t.status){let t="";throw t=this._options.host===R.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",Error("It doesn't look like you have permission to list peers IDs. "+t)}throw Error(`Error. Status:${t.status}`)}return t.json()}catch(t){throw x.error("Error retrieving list peers",t),Error("Could not get list peers from the server."+t)}}};let $f188f8cb0f63b180$export$d365f7ad9d7df9c9=class $f188f8cb0f63b180$export$d365f7ad9d7df9c9 extends $cb834ab0363d9153$export$23a2a68283c24d80{static #e=(()=>{this.ID_PREFIX="dc_"})();static #t=(()=>{this.MAX_BUFFERED_AMOUNT=8388608})();get type(){return a.Data}constructor(t,r,n){super(t,r,n),this.connectionId=this.options.connectionId||$f188f8cb0f63b180$export$d365f7ad9d7df9c9.ID_PREFIX+$6a375544f634961e$export$4e61f672936bec77(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new $a8347a6741c5df8a$export$89e6bb5ad64bf4a(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(t){this.dataChannel=t,this.dataChannel.onopen=()=>{x.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{x.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{x.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(t){if(t?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(t,r=!1){if(!this.open){this.emitError(d.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(t,r)}async handleMessage(t){let r=t.payload;switch(t.type){case _.Answer:await this._negotiator.handleSDP(t.type,r.sdp);break;case _.Candidate:await this._negotiator.handleCandidate(r.candidate);break;default:x.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}}};let $8d5124d0cf36ebe0$export$ff7c9d4c11d94e8b=class $8d5124d0cf36ebe0$export$ff7c9d4c11d94e8b extends $f188f8cb0f63b180$export$d365f7ad9d7df9c9{get bufferSize(){return this._bufferSize}_initializeDataChannel(t){super._initializeDataChannel(t),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(t){(this._buffering||!this._trySend(t))&&(this._buffer.push(t),this._bufferSize=this._buffer.length)}_trySend(t){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>$f188f8cb0f63b180$export$d365f7ad9d7df9c9.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(t)}catch(t){return x.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||0===this._buffer.length)return;let t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(t){if(t?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...t){super(...t),this._buffer=[],this._bufferSize=0,this._buffering=!1}};let $9cfea3ad93e740b9$export$f0a5a64d5bb37108=class $9cfea3ad93e740b9$export$f0a5a64d5bb37108 extends $8d5124d0cf36ebe0$export$ff7c9d4c11d94e8b{close(t){super.close(t),this._chunkedData={}}constructor(t,r,n){super(t,r,n),this.chunker=new $7ce5389b504cc06c$export$f1c5f4c9cb95390b,this.serialization=f.Binary,this._chunkedData={}}_handleDataMessage({data:t}){let r=(0,g.unpack)(t),n=r.__peerData;if(n){if("close"===n.type){this.close();return}this._handleChunk(r);return}this.emit("data",r)}_handleChunk(t){let r=t.__peerData,n=this._chunkedData[r]||{data:[],count:0,total:t.total};if(n.data[t.n]=new Uint8Array(t.data),n.count++,this._chunkedData[r]=n,n.total===n.count){delete this._chunkedData[r];let t=function(t){let r=0;for(let n of t)r+=n.byteLength;let n=new Uint8Array(r),o=0;for(let r of t)n.set(r,o),o+=r.byteLength;return n}(n.data);this._handleDataMessage({data:t})}}_send(t,r){if(t instanceof Blob)return t.arrayBuffer().then(t=>{this._send(t,r)});let n=(0,g.pack)(t);if(!r&&n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(t){let r=this.chunker.chunk(t);for(let t of(x.log(`DC#${this.connectionId} Try to send ${r.length} chunks...`),r))this.send(t,!0)}};let $c1c7a35edd5f55d2$export$6f88fe47d32c9c94=class $c1c7a35edd5f55d2$export$6f88fe47d32c9c94 extends $8d5124d0cf36ebe0$export$ff7c9d4c11d94e8b{_handleDataMessage({data:t}){super.emit("data",t)}_send(t,r){this._bufferedSend(t)}constructor(...t){super(...t),this.serialization=f.None}};let $f3415bb65bf67923$export$48880ac635f47186=class $f3415bb65bf67923$export$48880ac635f47186 extends $8d5124d0cf36ebe0$export$ff7c9d4c11d94e8b{_handleDataMessage({data:t}){let r=this.parse(this.decoder.decode(t)),n=r.__peerData;if(n&&"close"===n.type){this.close();return}this.emit("data",r)}_send(t,r){let n=this.encoder.encode(this.stringify(t));if(n.byteLength>=R.chunkedMTU){this.emitError(d.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(n)}constructor(...t){super(...t),this.serialization=f.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}};let $2ddecb16305b5a82$export$ecd1fc136c422448=class $2ddecb16305b5a82$export$ecd1fc136c422448 extends $cf62563e7a9fbce5$export$6a678e589c8a4542{static #e=(()=>{this.DEFAULT_KEY="peerjs"})();get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){let t=Object.create(null);for(let[r,n]of this._connections)t[r]=n;return t}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(t,r){let n;if(super(),this._serializers={raw:$c1c7a35edd5f55d2$export$6f88fe47d32c9c94,json:$f3415bb65bf67923$export$48880ac635f47186,binary:$9cfea3ad93e740b9$export$f0a5a64d5bb37108,"binary-utf8":$9cfea3ad93e740b9$export$f0a5a64d5bb37108,default:$9cfea3ad93e740b9$export$f0a5a64d5bb37108},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map,t&&t.constructor==Object?r=t:t&&(n=t.toString()),r={debug:0,host:R.CLOUD_HOST,port:R.CLOUD_PORT,path:"/",key:$2ddecb16305b5a82$export$ecd1fc136c422448.DEFAULT_KEY,token:R.randomToken(),config:R.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...r},this._options=r,this._serializers={...this._serializers,...this.options.serializers},"/"===this._options.host&&(this._options.host=window.location.hostname),this._options.path&&("/"!==this._options.path[0]&&(this._options.path="/"+this._options.path),"/"!==this._options.path[this._options.path.length-1]&&(this._options.path+="/")),void 0===this._options.secure&&this._options.host!==R.CLOUD_HOST?this._options.secure=R.isSecure():this._options.host==R.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&x.setLogFunction(this._options.logFunction),x.logLevel=this._options.debug||0,this._api=new $684fc411629b137b$export$2c4e825dc9120f87(r),this._socket=this._createServerConnection(),!R.supports.audioVideo&&!R.supports.data){this._delayedAbort(c.BrowserIncompatible,"The current browser does not support WebRTC");return}if(n&&!R.validateId(n)){this._delayedAbort(c.InvalidID,`ID "${n}" is invalid`);return}n?this._initialize(n):this._api.retrieveId().then(t=>this._initialize(t)).catch(t=>this._abort(c.ServerError,t))}_createServerConnection(){let t=new $e5e868bf3ea73e5b$export$4798917dbf149b79(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(m.Message,t=>{this._handleMessage(t)}),t.on(m.Error,t=>{this._abort(c.SocketError,t)}),t.on(m.Disconnected,()=>{this.disconnected||(this.emitError(c.Network,"Lost connection to server."),this.disconnect())}),t.on(m.Close,()=>{this.disconnected||this._abort(c.SocketClosed,"Underlying socket is already closed.")}),t}_initialize(t){this._id=t,this.socket.start(t,this._options.token)}_handleMessage(t){let r=t.type,n=t.payload,o=t.src;switch(r){case _.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case _.Error:this._abort(c.ServerError,n.msg);break;case _.IdTaken:this._abort(c.UnavailableID,`ID "${this.id}" is taken`);break;case _.InvalidKey:this._abort(c.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case _.Leave:x.log(`Received leave message from ${o}`),this._cleanupPeer(o),this._connections.delete(o);break;case _.Expire:this.emitError(c.PeerUnavailable,`Could not connect to peer ${o}`);break;case _.Offer:{let t=n.connectionId,r=this.getConnection(o,t);if(r&&(r.close(),x.warn(`Offer received for existing Connection ID:${t}`)),n.type===a.Media){let a=new $f3a554d4328c6b5f$export$4a84e95a2324ac29(o,this,{connectionId:t,_payload:n,metadata:n.metadata});r=a,this._addConnection(o,r),this.emit("call",a)}else if(n.type===a.Data){let a=new this._serializers[n.serialization](o,this,{connectionId:t,_payload:n,metadata:n.metadata,label:n.label,serialization:n.serialization,reliable:n.reliable});r=a,this._addConnection(o,r),this.emit("connection",a)}else{x.warn(`Received malformed connection type:${n.type}`);return}let c=this._getMessages(t);for(let t of c)r.handleMessage(t);break}default:{if(!n){x.warn(`You received a malformed message from ${o} of type ${r}`);return}let a=n.connectionId,c=this.getConnection(o,a);c&&c.peerConnection?c.handleMessage(t):a?this._storeMessage(a,t):x.warn("You received an unrecognized message:",t)}}}_storeMessage(t,r){this._lostMessages.has(t)||this._lostMessages.set(t,[]),this._lostMessages.get(t).push(r)}_getMessages(t){let r=this._lostMessages.get(t);return r?(this._lostMessages.delete(t),r):[]}connect(t,r={}){if(r={serialization:"default",...r},this.disconnected){x.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(c.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}let n=new this._serializers[r.serialization](t,this,r);return this._addConnection(t,n),n}call(t,r,n={}){if(this.disconnected){x.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(c.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!r){x.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}let o=new $f3a554d4328c6b5f$export$4a84e95a2324ac29(t,this,{...n,_stream:r});return this._addConnection(t,o),o}_addConnection(t,r){x.log(`add connection ${r.type}:${r.connectionId} to peerId:${t}`),this._connections.has(t)||this._connections.set(t,[]),this._connections.get(t).push(r)}_removeConnection(t){let r=this._connections.get(t.peer);if(r){let n=r.indexOf(t);-1!==n&&r.splice(n,1)}this._lostMessages.delete(t.connectionId)}getConnection(t,r){let n=this._connections.get(t);if(!n)return null;for(let t of n)if(t.connectionId===r)return t;return null}_delayedAbort(t,r){setTimeout(()=>{this._abort(t,r)},0)}_abort(t,r){x.error("Aborting!"),this.emitError(t,r),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(x.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(let t of this._connections.keys())this._cleanupPeer(t),this._connections.delete(t);this.socket.removeAllListeners()}_cleanupPeer(t){let r=this._connections.get(t);if(r)for(let t of r)t.close()}disconnect(){if(this.disconnected)return;let t=this.id;x.log(`Disconnect peer with ID:${t}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=t,this._id=null,this.emit("disconnected",t)}reconnect(){if(this.disconnected&&!this.destroyed)x.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else if(this.destroyed)throw Error("This peer cannot reconnect to the server. It has already been destroyed.");else if(this.disconnected||this.open)throw Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`);else x.error("In a hurry? We're still trying to make the initial connection!")}listAllPeers(t=t=>{}){this._api.listAllPeers().then(r=>t(r)).catch(t=>this._abort(c.ServerError,t))}};let $544799118fa637e6$export$72aa44612e2200cd=class $544799118fa637e6$export$72aa44612e2200cd extends $f188f8cb0f63b180$export$d365f7ad9d7df9c9{constructor(t,r,n){super(t,r,{...n,reliable:!0}),this._CHUNK_SIZE=32768,this._splitStream=new TransformStream({transform:(t,r)=>{for(let n=0;n<t.length;n+=this._CHUNK_SIZE)r.enqueue(t.subarray(n,n+this._CHUNK_SIZE))}}),this._rawSendStream=new WritableStream({write:async(t,r)=>{let n=new Promise(t=>this.dataChannel.addEventListener("bufferedamountlow",t,{once:!0}));await (this.dataChannel.bufferedAmount<=$f188f8cb0f63b180$export$d365f7ad9d7df9c9.MAX_BUFFERED_AMOUNT-t.byteLength||n);try{this.dataChannel.send(t)}catch(t){x.error(`DC#:${this.connectionId} Error when sending:`,t),r.error(t),this.close()}}}),this.writer=this._splitStream.writable.getWriter(),this._rawReadStream=new ReadableStream({start:t=>{this.once("open",()=>{this.dataChannel.addEventListener("message",r=>{t.enqueue(r.data)})})}}),this._splitStream.readable.pipeTo(this._rawSendStream)}_initializeDataChannel(t){super._initializeDataChannel(t),this.dataChannel.binaryType="arraybuffer",this.dataChannel.bufferedAmountLowThreshold=$f188f8cb0f63b180$export$d365f7ad9d7df9c9.MAX_BUFFERED_AMOUNT/2}};let M=Symbol.for(null),$0cb783f200ef4d91$var$iterateOver=async function*(t){let r=t.getReader();try{for(;;){let{done:t,value:n}=await r.read();if(t)return;yield n}}finally{r.releaseLock()}};let $0cb783f200ef4d91$export$7e9583c3c8a0a2cc=class $0cb783f200ef4d91$export$7e9583c3c8a0a2cc extends $544799118fa637e6$export$72aa44612e2200cd{constructor(t,r,n){super(t,r,{...n,reliable:!0}),this.serialization="Cbor",this._encoder=new S.Encoder,this._decoder=new S.Decoder,this._decoderStream=new TransformStream({transform:(t,r)=>{let n,o=new Uint8Array(t);this._inc&&(o=function(t,r){let n=new Uint8Array(t.byteLength+r.byteLength);return n.set(t,0),n.set(r,t.byteLength),new Uint8Array(n.buffer)}(this._inc,o),this._inc=null);try{n=this._decoder.decodeMultiple(o)}catch(t){if(t.incomplete)this._inc=o.subarray(t.lastPosition),n=t.values;else throw t}finally{for(let t of n||[])null===t&&(t=M),r.enqueue(t)}}}),this._rawReadStream.pipeTo(this._decoderStream.writable),(async()=>{for await(let t of $0cb783f200ef4d91$var$iterateOver(this._decoderStream.readable)){if(t.__peerData?.type==="close"){this.close();return}this.emit("data",t)}})()}_send(t){return this.writer.write(this._encoder.encode(t))}};let $1fc1476c05a53911$export$f6a74c7ffa2903e6=class $1fc1476c05a53911$export$f6a74c7ffa2903e6 extends $2ddecb16305b5a82$export$ecd1fc136c422448{constructor(...t){super(...t),this._serializers={Cbor:$0cb783f200ef4d91$export$7e9583c3c8a0a2cc,default:$0cb783f200ef4d91$export$7e9583c3c8a0a2cc}}};let $7e477efb76e02214$export$80f5de1a66c4d624=class $7e477efb76e02214$export$80f5de1a66c4d624 extends $544799118fa637e6$export$72aa44612e2200cd{constructor(t,r,n){super(t,r,n),this.serialization="MsgPack",this._encoder=new E.Encoder,(async()=>{for await(let t of(0,E.decodeMultiStream)(this._rawReadStream)){if(t.__peerData?.type==="close"){this.close();return}this.emit("data",t)}})()}_send(t){return this.writer.write(this._encoder.encode(t))}};let $8c8805059443e9b3$export$d72c7bf8eef50853=class $8c8805059443e9b3$export$d72c7bf8eef50853 extends $2ddecb16305b5a82$export$ecd1fc136c422448{constructor(...t){super(...t),this._serializers={MsgPack:$7e477efb76e02214$export$80f5de1a66c4d624,default:$7e477efb76e02214$export$80f5de1a66c4d624}}};var D=$2ddecb16305b5a82$export$ecd1fc136c422448;!function(t,r){Object.keys(r).forEach(function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return r[n]}})})}(t.exports,P)},1808:(t,r,n)=>{"use strict";n.d(r,{g:()=>y});var o,a=n(9885),c={exports:{}},l={};function k(t){throw Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}l._=l._interop_require_default=function(t){return t&&t.__esModule?t:{default:t}};var d,f={},m={};!function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var n in r)Object.defineProperty(t,n,{enumerable:!0,get:r[n]})}(r,{noSSR:function(){return v},default:function(){return L}});let n=l._(a),c=l._((o||(o=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return _}});let r=l._(a),n=(d||(d=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return r}});let r=l._(a).default.createContext(null)}(m)),m),o=[],c=[],f=!1;function v(t){let r=t(),n={loading:!0,loaded:null,error:null};return n.promise=r.then(t=>(n.loading=!1,n.loaded=t,t)).catch(t=>{throw n.loading=!1,n.error=t,t}),n}let u=class u{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:t,_opts:r}=this;t.loading&&("number"==typeof r.delay&&(0===r.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},r.delay)),"number"==typeof r.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},r.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(t=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(t){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...t},this._callbacks.forEach(t=>t())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(t){return this._callbacks.add(t),()=>{this._callbacks.delete(t)}}constructor(t,r){this._loadFn=t,this._opts=r,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}};function i(t){return function(t,a){let l=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},a),d=null;function p(){if(!d){let r=new u(t,l);d={getCurrentValue:r.getCurrentValue.bind(r),subscribe:r.subscribe.bind(r),retry:r.retry.bind(r),promise:r.promise.bind(r)}}return d.promise()}if(typeof window>"u"&&o.push(p),!f&&"u">typeof window){let t=l.webpack&&"function"==typeof k.resolveWeak?l.webpack():l.modules;t&&c.push(r=>{for(let n of t)if(-1!==r.indexOf(n))return p()})}function C(t,o){(function(){p();let t=r.default.useContext(n.LoadableContext);t&&Array.isArray(l.modules)&&l.modules.forEach(r=>{t(r)})})();let a=r.default.useSyncExternalStore(d.subscribe,d.getCurrentValue,d.getCurrentValue);return r.default.useImperativeHandle(o,()=>({retry:d.retry}),[]),r.default.useMemo(()=>{var n;return a.loading||a.error?r.default.createElement(l.loading,{isLoading:a.loading,pastDelay:a.pastDelay,timedOut:a.timedOut,error:a.error,retry:d.retry}):a.loaded?r.default.createElement((n=a.loaded)&&n.default?n.default:n,t):null},[t,a])}return C.preload=()=>p(),C.displayName="LoadableComponent",r.default.forwardRef(C)}(v,t)}function s(t,r){let n=[];for(;t.length;){let o=t.pop();n.push(o(r))}return Promise.all(n).then(()=>{if(t.length)return s(t,r)})}i.preloadAll=()=>new Promise((t,r)=>{s(o).then(t,r)}),i.preloadReady=t=>(void 0===t&&(t=[]),new Promise(r=>{let e=()=>(f=!0,r());s(c,t).then(e,e)})),"u">typeof window&&(window.__NEXT_PRELOADREADY=i.preloadReady);let _=i}(f)),f)),_=typeof window>"u";function h(t){return{default:(null==t?void 0:t.default)||t}}function v(t,r){if(delete r.webpack,delete r.modules,!_)return t(r);let o=r.loading;return()=>n.default.createElement(o,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1})}function L(t,r){let n=c.default,o={loading:t=>{let{error:r,isLoading:n,pastDelay:o}=t;return null}};t instanceof Promise?o.loader=()=>t:"function"==typeof t?o.loader=t:"object"==typeof t&&(o={...o,...t}),o={...o,...r};let a=o.loader;return o.loadableGenerated&&(o={...o,...o.loadableGenerated},delete o.loadableGenerated),"boolean"!=typeof o.ssr||o.ssr?n({...o,loader:()=>null!=a?a().then(h):Promise.resolve(h(()=>null))}):(delete o.webpack,delete o.modules,v(n,o))}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&typeof r.default.__esModule>"u"&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)}(c,c.exports);var _=c.exports;let g=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(_),y=g(async()=>(await n.e(20).then(n.bind(n,20020))).ReactP5Wrapper,{ssr:!1})},83423:(t,r,n)=>{"use strict";let o,a;n.d(r,{ZP:()=>lookup});var c,l={};n.r(l),n.d(l,{Decoder:()=>Decoder,Encoder:()=>Encoder,PacketType:()=>c,protocol:()=>Z});let d=Object.create(null);d.open="0",d.close="1",d.ping="2",d.pong="3",d.message="4",d.upgrade="5",d.noop="6";let f=Object.create(null);Object.keys(d).forEach(t=>{f[d[t]]=t});let m={type:"error",data:"parser error"},encodePacket=({type:t,data:r},n,o)=>o(r instanceof ArrayBuffer||ArrayBuffer.isView(r)?n?r:"b"+toBuffer(r,!0).toString("base64"):d[t]+(r||"")),toBuffer=(t,r)=>Buffer.isBuffer(t)||t instanceof Uint8Array&&!r?t:t instanceof ArrayBuffer?Buffer.from(t):Buffer.from(t.buffer,t.byteOffset,t.byteLength),decodePacket=(t,r)=>{if("string"!=typeof t)return{type:"message",data:mapBinary(t,r)};let n=t.charAt(0);if("b"===n){let n=Buffer.from(t.substring(1),"base64");return{type:"message",data:mapBinary(n,r)}}return f[n]?t.length>1?{type:f[n],data:t.substring(1)}:{type:f[n]}:m},mapBinary=(t,r)=>"arraybuffer"===r?t instanceof ArrayBuffer?t:Buffer.isBuffer(t)?t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength):t.buffer:Buffer.isBuffer(t)?t:Buffer.from(t),encodePayload=(t,r)=>{let n=t.length,o=Array(n),a=0;t.forEach((t,c)=>{encodePacket(t,!1,t=>{o[c]=t,++a===n&&r(o.join("\x1e"))})})},decodePayload=(t,r)=>{let n=t.split("\x1e"),o=[];for(let t=0;t<n.length;t++){let a=decodePacket(n[t],r);if(o.push(a),"error"===a.type)break}return o};function totalLength(t){return t.reduce((t,r)=>t+r.length,0)}function concatChunks(t,r){if(t[0].length===r)return t.shift();let n=new Uint8Array(r),o=0;for(let a=0;a<r;a++)n[a]=t[0][o++],o===t[0].length&&(t.shift(),o=0);return t.length&&o<t[0].length&&(t[0]=t[0].slice(o)),n}var _=n(36735);let g=global;function pick(t,...r){return r.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}let y=g.setTimeout,b=g.clearTimeout;function installTimerFunctions(t,r){r.useNativeTimers?(t.setTimeoutFn=y.bind(g),t.clearTimeoutFn=b.bind(g)):(t.setTimeoutFn=g.setTimeout.bind(g),t.clearTimeoutFn=g.clearTimeout.bind(g))}var S=n(17783);let E=S("engine.io-client:transport");let TransportError=class TransportError extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}};let Transport=class Transport extends _.Q{constructor(t){super(),this.writable=!1,installTimerFunctions(this,t),this.opts=t,this.query=t.query,this.socket=t.socket}onError(t,r,n){return super.emitReserved("error",new TransportError(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState?this.write(t):E("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let r=decodePacket(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){let t=this.opts.hostname;return -1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){let r=function(t){let r="";for(let n in t)t.hasOwnProperty(n)&&(r.length&&(r+="&"),r+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return r}(t);return r.length?"?"+r:""}};let w="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),T={},O=0,R=0,x;function yeast_encode(t){let r="";do r=w[t%64]+r,t=Math.floor(t/64);while(t>0);return r}function yeast(){let t=yeast_encode(+new Date);return t!==x?(O=0,x=t):t+"."+yeast_encode(O++)}for(;R<64;R++)T[w[R]]=R;var P=n(90584),A=n.t(P,2);let M=P||A;let CookieJar=class CookieJar{constructor(){this.cookies=new Map}parseCookies(t){let r=t.getResponseHeader("set-cookie");r&&r.forEach(t=>{let r=function(t){let r=t.split("; "),n=r[0].indexOf("=");if(-1===n)return;let o=r[0].substring(0,n).trim();if(!o.length)return;let a=r[0].substring(n+1).trim();34===a.charCodeAt(0)&&(a=a.slice(1,-1));let c={name:o,value:a};for(let t=1;t<r.length;t++){let n=r[t].split("=");if(2!==n.length)continue;let o=n[0].trim(),a=n[1].trim();switch(o){case"Expires":c.expires=new Date(a);break;case"Max-Age":let l=new Date;l.setUTCSeconds(l.getUTCSeconds()+parseInt(a,10)),c.expires=l}}return c}(t);r&&this.cookies.set(r.name,r)})}addCookies(t){let r=[];this.cookies.forEach((t,n)=>{var o;(null===(o=t.expires)||void 0===o?void 0:o.getTime())<Date.now()?this.cookies.delete(n):r.push(`${n}=${t.value}`)}),r.length&&(t.setDisableHeaderCheck(!0),t.setRequestHeader("cookie",r.join("; ")))}};let D=S("engine.io-client:polling");function empty(){}let I=function(){let t=new M({xdomain:!1});return null!=t.responseType}();let Request=class Request extends _.Q{constructor(t,r){super(),installTimerFunctions(this,r),this.opts=r,this.method=r.method||"GET",this.uri=t,this.data=void 0!==r.data?r.data:null,this.create()}create(){var t;let r=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;let n=this.xhr=new M(r);try{D("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(let t in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&n.setRequestHeader(t,this.opts.extraHeaders[t])}catch(t){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{n.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this.opts.cookieJar)||void 0===t||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var t;3===n.readyState&&(null===(t=this.opts.cookieJar)||void 0===t||t.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof n.status?n.status:0)},0))},D("xhr data %s",this.data),n.send(this.data)}catch(t){this.setTimeoutFn(()=>{this.onError(t)},0);return}"undefined"!=typeof document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=empty,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Request.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};if(Request.requestsCount=0,Request.requests={},"undefined"!=typeof document){if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){let t="onpagehide"in g?"pagehide":"unload";addEventListener(t,unloadHandler,!1)}}function unloadHandler(){for(let t in Request.requests)Request.requests.hasOwnProperty(t)&&Request.requests[t].abort()}n(86304),n(56961),n(25616);var j=n(59921);n(21311);let B=process.nextTick,U=S("engine.io-client:websocket"),N="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),F=S("engine.io-client:webtransport"),$={websocket:class extends Transport{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let t=this.uri(),r=this.opts.protocols,n=N?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=new j(t,r,n)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){let n=t[r],o=r===t.length-1;encodePacket(n,this.supportsBinary,t=>{let r={};if(n.options&&(r.compress=n.options.compress),this.opts.perMessageDeflate){let n="string"==typeof t?Buffer.byteLength(t):t.length;n<this.opts.perMessageDeflate.threshold&&(r.compress=!1)}try{this.ws.send(t,r)}catch(t){U("websocket closed before onclose event")}o&&B(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=yeast()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}check(){return!!j}},webtransport:class extends Transport{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{F("transport closed gracefully"),this.onClose()}).catch(t=>{F("transport closed due to %s",t),this.onError("webtransport error",t)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(t=>{let r=function(t,r){a||(a=new TextDecoder);let n=[],o=0,c=-1,l=!1;return new TransformStream({transform(d,f){for(n.push(d);;){if(0===o){if(1>totalLength(n))break;let t=concatChunks(n,1);l=(128&t[0])==128,o=(c=127&t[0])<126?3:126===c?1:2}else if(1===o){if(2>totalLength(n))break;let t=concatChunks(n,2);c=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),o=3}else if(2===o){if(8>totalLength(n))break;let t=concatChunks(n,8),r=new DataView(t.buffer,t.byteOffset,t.length),a=r.getUint32(0);if(a>2097151){f.enqueue(m);break}c=4294967296*a+r.getUint32(4),o=3}else{if(totalLength(n)<c)break;let t=concatChunks(n,c);f.enqueue(decodePacket(l?t:a.decode(t),r)),o=0}if(0===c||c>t){f.enqueue(m);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),c=new TransformStream({transform(t,r){!function(t,r){if(t.data instanceof ArrayBuffer||ArrayBuffer.isView(t.data))return r(toBuffer(t.data,!1));encodePacket(t,!0,t=>{o||(o=new TextEncoder),r(o.encode(t))})}(t,n=>{let o;let a=n.length;if(a<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,a);else if(a<65536){o=new Uint8Array(3);let t=new DataView(o.buffer);t.setUint8(0,126),t.setUint16(1,a)}else{o=new Uint8Array(9);let t=new DataView(o.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(a))}t.data&&"string"!=typeof t.data&&(o[0]|=128),r.enqueue(o),r.enqueue(n)})}});c.readable.pipeTo(t.writable),this.writer=c.writable.getWriter();let read=()=>{n.read().then(({done:t,value:r})=>{if(t){F("session is closed");return}F("received chunk: %o",r),this.onPacket(r),read()}).catch(t=>{F("an error occurred while reading: %s",t)})};read();let l={type:"open"};this.query.sid&&(l.data=`{"sid":"${this.query.sid}"}`),this.writer.write(l).then(()=>this.onOpen())})}))}write(t){this.writable=!1;for(let r=0;r<t.length;r++){let n=t[r],o=r===t.length-1;this.writer.write(n).then(()=>{o&&B(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;null===(t=this.transport)||void 0===t||t.close()}},polling:class extends Transport{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){let r="https:"===location.protocol,n=location.port;n||(n=r?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port}let r=t&&t.forceBase64;this.supportsBinary=I&&!r,this.opts.withCredentials&&(this.cookieJar=new CookieJar)}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";let pause=()=>{D("paused"),this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(D("we are currently polling - waiting to pause"),t++,this.once("pollComplete",function(){D("pre-pause polling complete"),--t||pause()})),this.writable||(D("we are currently writing - waiting to pause"),t++,this.once("drain",function(){D("pre-pause writing complete"),--t||pause()}))}else pause()}poll(){D("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){D("polling got data %s",t),decodePayload(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState?this.poll():D('ignoring poll - transport state "%s"',this.readyState))}doClose(){let close=()=>{D("writing close packet"),this.write([{type:"close"}])};"open"===this.readyState?(D("transport open - closing"),close()):(D("transport not open - deferring close"),this.once("open",close))}write(t){this.writable=!1,encodePayload(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.opts.secure?"https":"http",r=this.query||{};return!1!==this.opts.timestampRequests&&(r[this.opts.timestampParam]=yeast()),this.supportsBinary||r.sid||(r.b64=1),this.createUri(t,r)}request(t={}){return Object.assign(t,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Request(this.uri(),t)}doWrite(t,r){let n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(t,r)=>{this.onError("xhr post error",t,r)})}doPoll(){D("xhr poll");let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=t}}},V=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,W=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parseuri_parse(t){let r=t,n=t.indexOf("["),o=t.indexOf("]");-1!=n&&-1!=o&&(t=t.substring(0,n)+t.substring(n,o).replace(/:/g,";")+t.substring(o,t.length));let a=V.exec(t||""),c={},l=14;for(;l--;)c[W[l]]=a[l]||"";return -1!=n&&-1!=o&&(c.source=r,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=function(t,r){let n=r.replace(/\/{2,9}/g,"/").split("/");return("/"==r.slice(0,1)||0===r.length)&&n.splice(0,1),"/"==r.slice(-1)&&n.splice(n.length-1,1),n}(0,c.path),c.queryKey=function(t,r){let n={};return r.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,r,o){r&&(n[r]=o)}),n}(0,c.query),c}let z=S("engine.io-client:socket");let Socket=class Socket extends _.Q{constructor(t,r={}){super(),this.binaryType="nodebuffer",this.writeBuffer=[],t&&"object"==typeof t&&(r=t,t=null),t?(t=parseuri_parse(t),r.hostname=t.host,r.secure="https"===t.protocol||"wss"===t.protocol,r.port=t.port,t.query&&(r.query=t.query)):r.host&&(r.hostname=parseuri_parse(r.host).host),installTimerFunctions(this,r),this.secure=null!=r.secure?r.secure:"undefined"!=typeof location&&"https:"===location.protocol,r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=r.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let r={},n=t.split("&");for(let t=0,o=n.length;t<o;t++){let o=n[t].split("=");r[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return r}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){z('creating transport "%s"',t);let r=Object.assign({},this.opts.query);r.EIO=4,r.transport=t,this.id&&(r.sid=this.id);let n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return z("options: %j",n),new $[t](n)}open(){let t;if(this.opts.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else if(0===this.transports.length){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch(t){z("error while creating transport: %s",t),this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){z("setting transport %s",t.name),this.transport&&(z("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(t){z('probing transport "%s"',t);let r=this.createTransport(t),n=!1;Socket.priorWebsocketSuccess=!1;let onTransportOpen=()=>{n||(z('probe transport "%s" opened',t),r.send([{type:"ping",data:"probe"}]),r.once("packet",o=>{if(!n){if("pong"===o.type&&"probe"===o.data)z('probe transport "%s" pong',t),this.upgrading=!0,this.emitReserved("upgrading",r),r&&(Socket.priorWebsocketSuccess="websocket"===r.name,z('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{n||"closed"===this.readyState||(z("changing transport and sending upgrade packet"),cleanup(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())}));else{z('probe transport "%s" failed',t);let n=Error("probe error");n.transport=r.name,this.emitReserved("upgradeError",n)}}}))};function freezeTransport(){n||(n=!0,cleanup(),r.close(),r=null)}let onerror=n=>{let o=Error("probe error: "+n);o.transport=r.name,freezeTransport(),z('probe transport "%s" failed because of error: %s',t,n),this.emitReserved("upgradeError",o)};function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(t){r&&t.name!==r.name&&(z('"%s" works - aborting "%s"',t.name,r.name),freezeTransport())}let cleanup=()=>{r.removeListener("open",onTransportOpen),r.removeListener("error",onerror),r.removeListener("close",onTransportClose),this.off("close",onclose),this.off("upgrading",onupgrade)};r.once("open",onTransportOpen),r.once("error",onerror),r.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onOpen(){if(z("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){z("starting upgrade probes");let t=0,r=this.upgrades.length;for(;t<r;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(z('socket receive: type "%s", data "%s"',t.type,t.data),this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=Error("server error");r.code=t.data,this.onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}else z('packet received with socket readyState "%s"',this.readyState)}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();z("flushing %d packets in socket",t.length),this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){let t=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!t)return this.writeBuffer;let r=1;for(let t=0;t<this.writeBuffer.length;t++){let n=this.writeBuffer[t].data;if(n&&(r+="string"==typeof n?function(t){let r=0,n=0;for(let o=0,a=t.length;o<a;o++)(r=t.charCodeAt(o))<128?n+=1:r<2048?n+=2:r<55296||r>=57344?n+=3:(o++,n+=4);return n}(n):Math.ceil(1.33*(n.byteLength||n.size))),t>0&&r>this.maxPayload)return z("only send %d out of %d packets",t,this.writeBuffer.length),this.writeBuffer.slice(0,t);r+=2}return z("payload size is %d (max: %d)",r,this.maxPayload),this.writeBuffer}write(t,r,n){return this.sendPacket("message",t,r,n),this}send(t,r,n){return this.sendPacket("message",t,r,n),this}sendPacket(t,r,n,o){if("function"==typeof r&&(o=r,r=void 0),"function"==typeof n&&(o=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;let a={type:t,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),o&&this.once("flush",o),this.flush()}close(){let close=()=>{this.onClose("forced close"),z("socket closing - telling transport to close"),this.transport.close()},cleanupAndClose=()=>{this.off("upgrade",cleanupAndClose),this.off("upgradeError",cleanupAndClose),close()},waitForUpgrade=()=>{this.once("upgrade",cleanupAndClose),this.once("upgradeError",cleanupAndClose)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()),this}onError(t){z("socket error %j",t),Socket.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,r){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(z('socket close with reason: "%s"',t),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let r=[],n=0,o=t.length;for(;n<o;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}};Socket.protocol=4,Socket.protocol;let G=S("socket.io-client:url"),q="function"==typeof ArrayBuffer,isView=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,H=Object.prototype.toString,K="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===H.call(Blob),J="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===H.call(File);function isBinary(t){return q&&(t instanceof ArrayBuffer||isView(t))||K&&t instanceof Blob||J&&t instanceof File}let X=S("socket.io-parser"),Y=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Z=5;!function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(c||(c={}));let Encoder=class Encoder{constructor(t){this.replacer=t}encode(t){return(X("encoding packet %j",t),(t.type===c.EVENT||t.type===c.ACK)&&function hasBinary(t,r){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(hasBinary(t[r]))return!0;return!1}if(isBinary(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return hasBinary(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&hasBinary(t[r]))return!0;return!1}(t))?this.encodeAsBinary({type:t.type===c.EVENT?c.BINARY_EVENT:c.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===c.BINARY_EVENT||t.type===c.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(r+=t.nsp+","),null!=t.id&&(r+=t.id),null!=t.data&&(r+=JSON.stringify(t.data,this.replacer)),X("encoded %j as %s",t,r),r}encodeAsBinary(t){let r=function(t){let r=[],n=t.data;return t.data=function _deconstructPacket(t,r){if(!t)return t;if(isBinary(t)){let n={_placeholder:!0,num:r.length};return r.push(t),n}if(Array.isArray(t)){let n=Array(t.length);for(let o=0;o<t.length;o++)n[o]=_deconstructPacket(t[o],r);return n}if("object"==typeof t&&!(t instanceof Date)){let n={};for(let o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=_deconstructPacket(t[o],r));return n}return t}(n,r),t.attachments=r.length,{packet:t,buffers:r}}(t),n=this.encodeAsString(r.packet),o=r.buffers;return o.unshift(n),o}};function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}let Decoder=class Decoder extends _.Q{constructor(t){super(),this.reviver=t}add(t){let r;if("string"==typeof t){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);let n=r.type===c.BINARY_EVENT;n||r.type===c.BINARY_ACK?(r.type=n?c.EVENT:c.ACK,this.reconstructor=new BinaryReconstructor(r),0===r.attachments&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(isBinary(t)||t.base64){if(this.reconstructor)(r=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+t)}decodeString(t){let r=0,n={type:Number(t.charAt(0))};if(void 0===c[n.type])throw Error("unknown packet type "+n.type);if(n.type===c.BINARY_EVENT||n.type===c.BINARY_ACK){let o=r+1;for(;"-"!==t.charAt(++r)&&r!=t.length;);let a=t.substring(o,r);if(a!=Number(a)||"-"!==t.charAt(r))throw Error("Illegal attachments");n.attachments=Number(a)}if("/"===t.charAt(r+1)){let o=r+1;for(;++r;){let n=t.charAt(r);if(","===n||r===t.length)break}n.nsp=t.substring(o,r)}else n.nsp="/";let o=t.charAt(r+1);if(""!==o&&Number(o)==o){let o=r+1;for(;++r;){let n=t.charAt(r);if(null==n||Number(n)!=n){--r;break}if(r===t.length)break}n.id=Number(t.substring(o,r+1))}if(t.charAt(++r)){let o=this.tryParse(t.substr(r));if(Decoder.isPayloadValid(n.type,o))n.data=o;else throw Error("invalid payload")}return X("decoded %s as %j",t,n),n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,r){switch(t){case c.CONNECT:return isObject(r);case c.DISCONNECT:return void 0===r;case c.CONNECT_ERROR:return"string"==typeof r||isObject(r);case c.EVENT:case c.BINARY_EVENT:return Array.isArray(r)&&("number"==typeof r[0]||"string"==typeof r[0]&&-1===Y.indexOf(r[0]));case c.ACK:case c.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};let BinaryReconstructor=class BinaryReconstructor{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var r,n;let t=(r=this.reconPack,n=this.buffers,r.data=function _reconstructPacket(t,r){if(!t)return t;if(t&&!0===t._placeholder){let n="number"==typeof t.num&&t.num>=0&&t.num<r.length;if(n)return r[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=_reconstructPacket(t[n],r);else if("object"==typeof t)for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=_reconstructPacket(t[n],r));return t}(r.data,n),delete r.attachments,r);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function on(t,r,n){return t.on(r,n),function(){t.off(r,n)}}let Q=S("socket.io-client:socket"),ee=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let socket_Socket=class socket_Socket extends _.Q{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[on(t,"open",this.onopen.bind(this)),on(t,"packet",this.onpacket.bind(this)),on(t,"error",this.onerror.bind(this)),on(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){if(ee.hasOwnProperty(t))throw Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;let n={type:c.EVENT,data:r};if(n.options={},n.options.compress=!1!==this.flags.compress,"function"==typeof r[r.length-1]){let t=this.ids++;Q("emitting packet with ack id %d",t);let o=r.pop();this._registerAckCallback(t,o),n.id=t}let o=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,a=this.flags.volatile&&(!o||!this.connected);return a?Q("discard packet as the transport is not currently writable"):this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n),this.flags={},this}_registerAckCallback(t,r){var n;let o=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===o){this.acks[t]=r;return}let a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let r=0;r<this.sendBuffer.length;r++)this.sendBuffer[r].id===t&&(Q("removing packet with ack id %d from the buffer",t),this.sendBuffer.splice(r,1));Q("event with ack id %d has timed out after %d ms",t,o),r.call(this,Error("operation has timed out"))},o);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(a),r.apply(this,[null,...t])}}emitWithAck(t,...r){let n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((o,a)=>{r.push((t,r)=>n?t?a(t):o(r):o(t)),this.emit(t,...r)})}_addToQueue(t){let r;"function"==typeof t[t.length-1]&&(r=t.pop());let n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((t,...o)=>{if(n!==this._queue[0])return;let a=null!==t;return a?n.tryCount>this._opts.retries&&(Q("packet [%d] is discarded after %d tries",n.id,n.tryCount),this._queue.shift(),r&&r(t)):(Q("packet [%d] was successfully sent",n.id),this._queue.shift(),r&&r(null,...o)),n.pending=!1,this._drainQueue()}),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(Q("draining queue"),!this.connected||0===this._queue.length)return;let r=this._queue[0];if(r.pending&&!t){Q("packet [%d] has already been sent and is waiting for an ack",r.id);return}r.pending=!0,r.tryCount++,Q("sending packet [%d] (try n\xb0%d)",r.id,r.tryCount),this.flags=r.flags,this.emit.apply(this,r.args)}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){Q("transport is open - connecting"),"function"==typeof this.auth?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:c.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){Q("close (%s)",t),this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r)}onpacket(t){let r=t.nsp===this.nsp;if(r)switch(t.type){case c.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case c.EVENT:case c.BINARY_EVENT:this.onevent(t);break;case c.ACK:case c.BINARY_ACK:this.onack(t);break;case c.DISCONNECT:this.ondisconnect();break;case c.CONNECT_ERROR:this.destroy();let n=Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n)}}onevent(t){let r=t.data||[];Q("emitting event %j",r),null!=t.id&&(Q("attaching ack callback to event"),r.push(this.ack(t.id))),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){let r=this,n=!1;return function(...o){n||(n=!0,Q("sending ack %j",o),r.packet({type:c.ACK,id:t,data:o}))}}onack(t){let r=this.acks[t.id];"function"==typeof r?(Q("calling ack %s with %j",t.id,t.data),r.apply(this,t.data),delete this.acks[t.id]):Q("bad ack %s",t.id)}onconnect(t,r){Q("socket connected with id %s",t),this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){Q("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(Q("performing disconnect (%s)",this.nsp),this.packet({type:c.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n]){r.splice(n,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n]){r.splice(n,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let r=this._anyOutgoingListeners.slice();for(let n of r)n.apply(this,t.data)}}};function Backoff(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var r=Math.random(),n=Math.floor(r*this.jitter*t);t=(1&Math.floor(10*r))==0?t-n:t+n}return 0|Math.min(t,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(t){this.ms=t},Backoff.prototype.setMax=function(t){this.max=t},Backoff.prototype.setJitter=function(t){this.jitter=t};let et=S("socket.io-client:manager");let Manager=class Manager extends _.Q{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(r=t,t=void 0),(r=r||{}).path=r.path||"/socket.io",this.opts=r,installTimerFunctions(this,r),this.reconnection(!1!==r.reconnection),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=r.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==r.timeout?2e4:r.timeout),this._readyState="closed",this.uri=t;let o=r.parser||l;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=!1!==r.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(r=this.backoff)||void 0===r||r.setMin(t),this)}randomizationFactor(t){var r;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(r=this.backoff)||void 0===r||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(r=this.backoff)||void 0===r||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(et("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;et("opening %s",this.uri),this.engine=new Socket(this.uri,this.opts);let r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let o=on(r,"open",function(){n.onopen(),t&&t()}),onError=r=>{et("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",r),t?t(r):this.maybeReconnectOnOpen()},a=on(r,"error",onError);if(!1!==this._timeout){let t=this._timeout;et("connect attempt will timeout after %d",t);let n=this.setTimeoutFn(()=>{et("connect attempt timed out after %d",t),o(),onError(Error("timeout")),r.close()},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(o),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){et("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(on(t,"ping",this.onping.bind(this)),on(t,"data",this.ondata.bind(this)),on(t,"error",this.onerror.bind(this)),on(t,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){B(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){et("error",t),this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new socket_Socket(this,t,r),this.nsps[t]=n),n}_destroy(t){let r=Object.keys(this.nsps);for(let t of r){let r=this.nsps[t];if(r.active){et("socket %s is still active, skipping close",t);return}}this._close()}_packet(t){et("writing packet %j",t);let r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){et("cleanup"),this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){et("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,r){et("closed due to %s",t),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)et("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();et("will wait %dms before reconnect attempt",r),this._reconnecting=!0;let n=this.setTimeoutFn(()=>{!t.skipReconnect&&(et("attempting reconnect"),this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(r=>{r?(et("reconnect attempt error"),t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):(et("reconnect success"),t.onreconnect())}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};let er=S("socket.io-client"),en={};function lookup(t,r){let n;"object"==typeof t&&(r=t,t=void 0),r=r||{};let o=function(t,r="",n){let o=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(G("protocol-less url %s",t),t=void 0!==n?n.protocol+"//"+t:"https://"+t),G("parse %s",t),o=parseuri_parse(t)),!o.port&&(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";let a=-1!==o.host.indexOf(":"),c=a?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+c+":"+o.port+r,o.href=o.protocol+"://"+c+(n&&n.port===o.port?"":":"+o.port),o}(t,r.path||"/socket.io"),a=o.source,c=o.id,l=o.path,d=en[c]&&l in en[c].nsps,f=r.forceNew||r["force new connection"]||!1===r.multiplex||d;return f?(er("ignoring socket cache for %s",a),n=new Manager(a,r)):(en[c]||(er("new io instance for %s",a),en[c]=new Manager(a,r)),n=en[c]),o.query&&!r.query&&(r.query=o.queryKey),n.socket(o.path,r)}Object.assign(lookup,{Manager:Manager,Socket:socket_Socket,io:lookup,connect:lookup})}};